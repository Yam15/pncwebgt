import{a as oo,b as ao,c as yf,d as _f,e as wf,f as uo}from"./chunk-FXESD3HN.js";import{a as vf}from"./chunk-JMSNVUBY.js";import{K as mf,N as ff,O as pf,U as gf,V as lo}from"./chunk-HMBRCSHA.js";import{H as Tf,J as If,a as uf,b as so,c as Er,d as hf,e as Ef}from"./chunk-BBT4LFHG.js";import{a as Zm,b as ef,d as ro,e as io,f as tn,g as nn,h as sf,i as of,j as af,k as lf,l as Ve,m as Et}from"./chunk-BGD4DQXQ.js";import{Ea as cf,Xa as wt,Ya as st,b as Jm,c as Ym,d as Xm,mb as ot,nb as df,ob as ze}from"./chunk-LWOW4LH6.js";import{$ as Ws,$a as te,$b as Bl,$c as eo,A as Tm,Aa as Dm,B as Ft,Bb as Ll,Bc as jl,Cb as ee,Cc as $m,Dc as Wm,Ea as vr,Eb as Lm,Fa as Vm,Fc as Gl,G as Im,Gb as qm,Ha as Nm,K as bm,Lb as g,M as Sm,Mb as y,Nb as V,Ob as Js,P as zs,Pb as Ys,Q as Ks,R as Ml,Rb as Mn,T as $s,Tb as Fe,Tc as Qm,U as Dn,Ub as vt,V as Fl,Wa as Qs,X as Am,Xb as Bm,Y as xm,Yb as Um,_ as en,_b as ql,_c as wr,ab as Pe,ac as Ul,ad as to,ba as Me,bb as Mm,c as pr,da as re,db as Fm,dc as Xs,ea as Ol,eb as Om,ec as b,f as wm,fa as Cm,fc as Fn,gd as Hm,h as Gs,ha as Rm,i as Em,ia as Pm,id as Ge,l as kn,ld as no,m as gr,mc as Zs,n as Xt,na as Vn,nb as X,nc as jm,o as Zt,oa as Nn,ob as Hs,pa as yr,pc as Gm,qa as _r,qd as tf,rd as nf,s as He,td as zl,ua as km,ub as _t,ud as Kl,vd as rf,xa as yt,xc as zm,zc as Km}from"./chunk-KHGVWTCF.js";import{a as bf,b as $l,c as Sf,d as Di,e as Wl,f as co,g as Af,h as xf,i as Ql,j as ge,k as On,l as Tt,m as ho,n as Vi,o as Cf,p as Rf,q as rn,r as nt}from"./chunk-CSCPH5F6.js";import"./chunk-Q62ZNB66.js";import{a as Yt,b as Pn,e as Nl,f as D}from"./chunk-KT3CPUTC.js";var hy="@",dy=(()=>{class r{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=Ol(km,{optional:!0});loadingSchedulerFn=Ol(my,{optional:!0});_engine;constructor(t,n,i,s,a){this.doc=t,this.delegate=n,this.zone=i,this.animationType=s,this.moduleImpl=a}ngOnDestroy(){this._engine?.flush()}loadImpl(){let t=()=>this.moduleImpl??import("./chunk-FUGJPWY7.js").then(i=>i),n;return this.loadingSchedulerFn?n=this.loadingSchedulerFn(t):n=t(),n.catch(i=>{throw new xm(5300,!1)}).then(({\u0275createEngine:i,\u0275AnimationRendererFactory:s})=>{this._engine=i(this.animationType,this.doc);let a=new s(this.delegate,this._engine,this.zone);return this.delegate=a,a})}createRenderer(t,n){let i=this.delegate.createRenderer(t,n);if(i.\u0275type===0)return i;typeof i.throwOnSyntheticProps=="boolean"&&(i.throwOnSyntheticProps=!1);let s=new Hl(i);return n?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(a=>{let l=a.createRenderer(t,n);s.use(l),this.scheduler?.notify(11)}).catch(a=>{s.use(i)}),s}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static \u0275fac=function(n){Mm()};static \u0275prov=en({token:r,factory:r.\u0275fac})}return r})(),Hl=class{delegate;replay=[];\u0275type=1;constructor(e){this.delegate=e}use(e){if(this.delegate=e,this.replay!==null){for(let t of this.replay)t(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,t){this.delegate.appendChild(e,t)}insertBefore(e,t,n,i){this.delegate.insertBefore(e,t,n,i)}removeChild(e,t,n){this.delegate.removeChild(e,t,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,i){this.delegate.setAttribute(e,t,n,i)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,i){this.delegate.setStyle(e,t,n,i)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){this.shouldReplay(t)&&this.replay.push(i=>i.setProperty(e,t,n)),this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.shouldReplay(t)&&this.replay.push(i=>i.listen(e,t,n)),this.delegate.listen(e,t,n)}shouldReplay(e){return this.replay!==null&&e.startsWith(hy)}},my=new Me("");function Pf(r="animations"){return Nm("NgAsyncAnimations"),Rm([{provide:Fm,useFactory:(e,t,n)=>new dy(e,t,n,r),deps:[Qm,Zm,yt]},{provide:Vm,useValue:r==="noop"?"NoopAnimations":"BrowserAnimations"}])}var py=(r,e)=>({"pi ":!0,"pi-moon":r,"pi-sun":e}),Ni=class r{constructor(e){this.layoutService=e}items;toggleDarkMode(){this.layoutService.layoutConfig.update(e=>Pn(Yt({},e),{darkTheme:!e.darkTheme}))}static \u0275fac=function(t){return new(t||r)(Pe(Et))};static \u0275cmp=X({type:r,selectors:[["app-topbar"]],decls:33,vars:6,consts:[[1,"layout-topbar"],[1,"layout-topbar-logo-container"],[1,"layout-menu-button","layout-topbar-action",3,"click"],[1,"pi","pi-bars"],["routerLink","/",1,"layout-topbar-logo"],["src","https://i0.wp.com/pnc.gob.gt/wp-content/uploads/2023/08/Logo-PNC.png?ssl=1","alt","LOGO",1,"layout-login-logo"],[1,"layout-topbar-actions"],[1,"layout-config-menu"],["type","button",1,"layout-topbar-action",3,"click"],[3,"ngClass"],[1,"relative"],["pStyleClass","@next","enterFromClass","hidden","enterActiveClass","animate-scalein","leaveToClass","hidden","leaveActiveClass","animate-fadeout",1,"layout-topbar-action","layout-topbar-action-highlight",3,"hideOnOutsideClick"],[1,"pi","pi-palette"],["pStyleClass","@next","enterFromClass","hidden","enterActiveClass","animate-scalein","leaveToClass","hidden","leaveActiveClass","animate-fadeout",1,"layout-topbar-menu-button","layout-topbar-action",3,"hideOnOutsideClick"],[1,"pi","pi-ellipsis-v"],[1,"layout-topbar-menu","hidden","lg:block"],[1,"layout-topbar-menu-content"],["type","button",1,"layout-topbar-action"],[1,"pi","pi-calendar"],[1,"pi","pi-inbox"],[1,"pi","pi-user"]],template:function(t,n){t&1&&(g(0,"div",0)(1,"div",1)(2,"button",2),Fe("click",function(){return n.layoutService.onMenuToggle()}),V(3,"i",3),y(),g(4,"a",4),V(5,"a")(6,"img",5),g(7,"span"),b(8,"PNCWEB"),y()()(),g(9,"div",6)(10,"div",7)(11,"button",8),Fe("click",function(){return n.toggleDarkMode()}),V(12,"i",9),y(),g(13,"div",10)(14,"button",11),V(15,"i",12),y(),V(16,"app-configurator"),y()(),g(17,"button",13),V(18,"i",14),y(),g(19,"div",15)(20,"div",16)(21,"button",17),V(22,"i",18),g(23,"span"),b(24,"Calendar"),y()(),g(25,"button",17),V(26,"i",19),g(27,"span"),b(28,"Messages"),y()(),g(29,"button",17),V(30,"i",20),g(31,"span"),b(32,"Profile"),y()()()()()()),t&2&&(te(12),ee("ngClass",Gm(3,py,n.layoutService.isDarkTheme(),!n.layoutService.isDarkTheme())),te(2),ee("hideOnOutsideClick",!0),te(3),ee("hideOnOutsideClick",!0))},dependencies:[Ve,nn,Ge,wr,Er,so,hf],encapsulation:2})};var gy=["app-menuitem",""],yy=()=>({paths:"exact",queryParams:"ignored",matrixParams:"ignored",fragment:"ignored"});function _y(r,e){if(r&1&&(g(0,"div",4),b(1),y()),r&2){let t=vt();te(),Fn(t.item.label)}}function vy(r,e){r&1&&V(0,"i",9)}function wy(r,e){if(r&1){let t=Mn();g(0,"a",5),Fe("click",function(i){Vn(t);let s=vt();return Nn(s.itemClick(i))}),V(1,"i",6),g(2,"span",7),b(3),y(),_t(4,vy,1,0,"i",8),y()}if(r&2){let t=vt();ee("ngClass",t.item.styleClass),Ll("href",t.item.url,Qs)("target",t.item.target),te(),ee("ngClass",t.item.icon),te(2),Fn(t.item.label),te(),ee("ngIf",t.item.items)}}function Ey(r,e){r&1&&V(0,"i",9)}function Ty(r,e){if(r&1){let t=Mn();g(0,"a",10),Fe("click",function(i){Vn(t);let s=vt();return Nn(s.itemClick(i))}),V(1,"i",6),g(2,"span",7),b(3),y(),_t(4,Ey,1,0,"i",8),y()}if(r&2){let t=vt();ee("ngClass",t.item.styleClass)("routerLink",t.item.routerLink)("routerLinkActiveOptions",t.item.routerLinkActiveOptions||jm(14,yy))("fragment",t.item.fragment)("queryParamsHandling",t.item.queryParamsHandling)("preserveFragment",t.item.preserveFragment)("skipLocationChange",t.item.skipLocationChange)("replaceUrl",t.item.replaceUrl)("state",t.item.state)("queryParams",t.item.queryParams),Ll("target",t.item.target),te(),ee("ngClass",t.item.icon),te(2),Fn(t.item.label),te(),ee("ngIf",t.item.items)}}function Iy(r,e){if(r&1&&V(0,"li",12),r&2){let t=e.$implicit,n=e.index,i=vt(2);qm(t.badgeClass),ee("item",t)("index",n)("parentKey",i.key)}}function by(r,e){if(r&1&&(g(0,"ul"),_t(1,Iy,1,5,"ng-template",11),y()),r&2){let t=vt();ee("@children",t.submenuAnimation),te(),ee("ngForOf",t.item.items)}}var fo=class r{constructor(e,t){this.router=e;this.layoutService=t;this.menuSourceSubscription=this.layoutService.menuSource$.subscribe(n=>{Promise.resolve(null).then(()=>{n.routeEvent?this.active=!!(n.key===this.key||n.key.startsWith(this.key+"-")):n.key!==this.key&&!n.key.startsWith(this.key+"-")&&(this.active=!1)})}),this.menuResetSubscription=this.layoutService.resetSource$.subscribe(()=>{this.active=!1}),this.router.events.pipe(Ft(n=>n instanceof ro)).subscribe(n=>{this.item.routerLink&&this.updateActiveStateFromRoute()})}item;index;root;parentKey;active=!1;menuSourceSubscription;menuResetSubscription;key="";ngOnInit(){this.key=this.parentKey?this.parentKey+"-"+this.index:String(this.index),this.item.routerLink&&this.updateActiveStateFromRoute()}updateActiveStateFromRoute(){this.router.isActive(this.item.routerLink[0],{paths:"exact",queryParams:"ignored",matrixParams:"ignored",fragment:"ignored"})&&this.layoutService.onMenuStateChange({key:this.key,routeEvent:!0})}itemClick(e){if(this.item.disabled){e.preventDefault();return}this.item.command&&this.item.command({originalEvent:e,item:this.item}),this.item.items&&(this.active=!this.active),this.layoutService.onMenuStateChange({key:this.key})}get submenuAnimation(){return this.root||this.active?"expanded":"collapsed"}get activeClass(){return this.active&&!this.root}ngOnDestroy(){this.menuSourceSubscription&&this.menuSourceSubscription.unsubscribe(),this.menuResetSubscription&&this.menuResetSubscription.unsubscribe()}static \u0275fac=function(t){return new(t||r)(Pe(tn),Pe(Et))};static \u0275cmp=X({type:r,selectors:[["","app-menuitem",""]],hostVars:4,hostBindings:function(t,n){t&2&&Lm("layout-root-menuitem",n.root)("active-menuitem",n.activeClass)},inputs:{item:"item",index:"index",root:"root",parentKey:"parentKey"},features:[Zs([Et])],attrs:gy,decls:5,vars:4,consts:[["class","layout-menuitem-root-text",4,"ngIf"],["tabindex","0","pRipple","",3,"ngClass","click",4,"ngIf"],["routerLinkActive","active-route","tabindex","0","pRipple","",3,"ngClass","routerLink","routerLinkActiveOptions","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state","queryParams","click",4,"ngIf"],[4,"ngIf"],[1,"layout-menuitem-root-text"],["tabindex","0","pRipple","",3,"click","ngClass"],[1,"layout-menuitem-icon",3,"ngClass"],[1,"layout-menuitem-text"],["class","pi pi-fw pi-angle-down layout-submenu-toggler",4,"ngIf"],[1,"pi","pi-fw","pi-angle-down","layout-submenu-toggler"],["routerLinkActive","active-route","tabindex","0","pRipple","",3,"click","ngClass","routerLink","routerLinkActiveOptions","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state","queryParams"],["ngFor","",3,"ngForOf"],["app-menuitem","",3,"item","index","parentKey"]],template:function(t,n){t&1&&(Js(0),_t(1,_y,2,1,"div",0)(2,wy,5,6,"a",1)(3,Ty,5,15,"a",2)(4,by,2,2,"ul",3),Ys()),t&2&&(te(),ee("ngIf",n.root&&n.item.visible!==!1),te(),ee("ngIf",(!n.item.routerLink||n.item.items)&&n.item.visible!==!1),te(),ee("ngIf",n.item.routerLink&&!n.item.items&&n.item.visible!==!1),te(),ee("ngIf",n.item.items&&n.item.visible!==!1))},dependencies:[r,Ge,wr,eo,to,Ve,nn,sf,st,wt],encapsulation:2,data:{animation:[tf("children",[Kl("collapsed",zl({height:"0"})),Kl("expanded",zl({height:"*"})),rf("collapsed <=> expanded",nf("400ms cubic-bezier(0.86, 0, 0.07, 1)"))])]}})};function Sy(r,e){if(r&1&&V(0,"li",7),r&2){let t=vt(),n=t.$implicit,i=t.index;ee("item",n)("index",i)("root",!0)}}function Ay(r,e){r&1&&V(0,"li",8)}function xy(r,e){if(r&1&&(Js(0),_t(1,Sy,1,3,"li",5)(2,Ay,1,0,"li",6),Ys()),r&2){let t=e.$implicit;te(),ee("ngIf",!t.separator),te(),ee("ngIf",t.separator)}}var go=class r{usuario1="";usuario={email:"",password:""};model=[];ngOnInit(){this.model=[{label:"Inicio",items:[{label:"Pagina Principal",icon:"pi pi-fw pi-home",routerLink:["/"]}]},{label:"Bienvenido",items:[{label:"Base Legal",icon:"pi pi-fw pi-id-card",routerLink:["/uikit/formlayout"]}]},{label:"Pages",icon:"pi pi-fw pi-briefcase",routerLink:["/pages"],items:[{label:"Auth",icon:"pi pi-fw pi-user",items:[{label:"Login",icon:"pi pi-fw pi-sign-in",routerLink:["/auth/login"]}]},{label:"Empty",icon:"pi pi-fw pi-circle-off",routerLink:["/pages/empty"]}]},{label:"Get Started",items:[{label:"Documentation",icon:"pi pi-fw pi-question",routerLink:["/"]},{label:"View Source",icon:"pi pi-fw pi-search",routerLink:["/"],target:"_blank"}]}]}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=X({type:r,selectors:[["app-menu"]],decls:10,vars:1,consts:[[1,"layout-menu"],[4,"ngFor","ngForOf"],["href","https://www.primefaces.org/primeblocks-ng/#/"],["src","/Imagen1.gif","alt","Prime Blocks",1,"w-full","mt-3"],[1,"alinearlo"],["app-menuitem","",3,"item","index","root",4,"ngIf"],["class","menu-separator",4,"ngIf"],["app-menuitem","",3,"item","index","root"],[1,"menu-separator"]],template:function(t,n){t&1&&(g(0,"ul",0),_t(1,xy,3,2,"ng-container",1),y(),g(2,"a",2),V(3,"img",3),y(),g(4,"a",4),b(5,"Todos los derechos reservados "),V(6,"br"),b(7," Desarrollado por el Agente de PNC "),V(8,"br"),b(9," Carlos Guerra"),y()),t&2&&(te(),ee("ngForOf",n.model))},dependencies:[Ge,eo,to,fo,Ve],encapsulation:2})};var Mi=class r{constructor(e){this.el=e}static \u0275fac=function(t){return new(t||r)(Pe(Dm))};static \u0275cmp=X({type:r,selectors:[["app-sidebar"]],decls:2,vars:0,consts:[[1,"layout-sidebar"]],template:function(t,n){t&1&&(g(0,"div",0),V(1,"app-menu"),y())},dependencies:[go],encapsulation:2})};var yo=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=X({type:r,selectors:[["app-footer"]],decls:4,vars:0,consts:[[1,"layout-footer"],["href","https://primeng.org","target","_blank","rel","noopener noreferrer",1,"text-primary","font-bold","hover:underline"]],template:function(t,n){t&1&&(g(0,"div",0),b(1," by "),g(2,"a",1),b(3,"PNCWEB"),y()())},encapsulation:2})};var _o=class r{constructor(e,t,n){this.layoutService=e;this.renderer=t;this.router=n;this.overlayMenuOpenSubscription=this.layoutService.overlayOpen$.subscribe(()=>{this.menuOutsideClickListener||(this.menuOutsideClickListener=this.renderer.listen("document","click",i=>{this.isOutsideClicked(i)&&this.hideMenu()})),this.layoutService.layoutState().staticMenuMobileActive&&this.blockBodyScroll()}),this.router.events.pipe(Ft(i=>i instanceof ro)).subscribe(()=>{this.hideMenu()})}overlayMenuOpenSubscription;menuOutsideClickListener;appSidebar;appTopBar;isOutsideClicked(e){let t=document.querySelector(".layout-sidebar"),n=document.querySelector(".layout-menu-button"),i=e.target;return!(t?.isSameNode(i)||t?.contains(i)||n?.isSameNode(i)||n?.contains(i))}hideMenu(){this.layoutService.layoutState.update(e=>Pn(Yt({},e),{overlayMenuActive:!1,staticMenuMobileActive:!1,menuHoverActive:!1})),this.menuOutsideClickListener&&(this.menuOutsideClickListener(),this.menuOutsideClickListener=null),this.unblockBodyScroll()}blockBodyScroll(){document.body.classList?document.body.classList.add("blocked-scroll"):document.body.className+=" blocked-scroll"}unblockBodyScroll(){document.body.classList?document.body.classList.remove("blocked-scroll"):document.body.className=document.body.className.replace(new RegExp("(^|\\b)"+"blocked-scroll".split(" ").join("|")+"(\\b|$)","gi")," ")}get containerClass(){return{"layout-overlay":this.layoutService.layoutConfig().menuMode==="overlay","layout-static":this.layoutService.layoutConfig().menuMode==="static","layout-static-inactive":this.layoutService.layoutState().staticMenuDesktopInactive&&this.layoutService.layoutConfig().menuMode==="static","layout-overlay-active":this.layoutService.layoutState().overlayMenuActive,"layout-mobile-active":this.layoutService.layoutState().staticMenuMobileActive}}ngOnDestroy(){this.overlayMenuOpenSubscription&&this.overlayMenuOpenSubscription.unsubscribe(),this.menuOutsideClickListener&&this.menuOutsideClickListener()}static \u0275fac=function(t){return new(t||r)(Pe(Et),Pe(Om),Pe(tn))};static \u0275cmp=X({type:r,selectors:[["app-layout"]],viewQuery:function(t,n){if(t&1&&(ql(Mi,5),ql(Ni,5)),t&2){let i;Bl(i=Ul())&&(n.appSidebar=i.first),Bl(i=Ul())&&(n.appTopBar=i.first)}},decls:8,vars:1,consts:[[1,"layout-wrapper",3,"ngClass"],[1,"layout-main-container"],[1,"layout-main"],[1,"layout-mask","animate-fadein"]],template:function(t,n){t&1&&(g(0,"div",0),V(1,"app-topbar")(2,"app-sidebar"),g(3,"div",1)(4,"div",2),V(5,"router-outlet"),y(),V(6,"app-footer"),y(),V(7,"div",3),y()),t&2&&ee("ngClass",n.containerClass)},dependencies:[Ge,wr,Ni,Mi,Ve,io,yo],encapsulation:2})};var vo=class r{items=[{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-trash"}];static \u0275fac=function(t){return new(t||r)};static \u0275cmp=X({type:r,selectors:[["app-notifications-widget"]],decls:65,vars:2,consts:[["menu",""],[1,"card"],[1,"flex","items-center","justify-between","mb-6"],[1,"font-semibold","text-xl"],["pButton","","type","button","icon","pi pi-ellipsis-v",1,"p-button-rounded","p-button-text","p-button-plain",3,"click"],[3,"popup","model"],[1,"block","text-muted-color","font-medium","mb-4"],[1,"p-0","mx-0","mt-0","mb-6","list-none"],[1,"flex","items-center","py-2","border-b","border-surface"],[1,"w-12","h-12","flex","items-center","justify-center","bg-blue-100","dark:bg-blue-400/10","rounded-full","mr-4","shrink-0"],[1,"pi","pi-dollar","!text-xl","text-blue-500"],[1,"text-surface-900","dark:text-surface-0","leading-normal"],[1,"text-surface-700","dark:text-surface-100"],[1,"text-primary","font-bold"],[1,"flex","items-center","py-2"],[1,"w-12","h-12","flex","items-center","justify-center","bg-orange-100","dark:bg-orange-400/10","rounded-full","mr-4","shrink-0"],[1,"pi","pi-download","!text-xl","text-orange-500"],[1,"text-surface-700","dark:text-surface-100","leading-normal"],[1,"p-0","m-0","list-none","mb-6"],[1,"w-12","h-12","flex","items-center","justify-center","bg-pink-100","dark:bg-pink-400/10","rounded-full","mr-4","shrink-0"],[1,"pi","pi-question","!text-xl","text-pink-500"],[1,"p-0","m-0","list-none"],[1,"w-12","h-12","flex","items-center","justify-center","bg-green-100","dark:bg-green-400/10","rounded-full","mr-4","shrink-0"],[1,"pi","pi-arrow-up","!text-xl","text-green-500"],[1,"w-12","h-12","flex","items-center","justify-center","bg-purple-100","dark:bg-purple-400/10","rounded-full","mr-4","shrink-0"],[1,"pi","pi-heart","!text-xl","text-purple-500"]],template:function(t,n){if(t&1){let i=Mn();g(0,"div",1)(1,"div",2)(2,"div",3),b(3,"Notifications"),y(),g(4,"div")(5,"button",4),Fe("click",function(a){Vn(i);let l=Xs(7);return Nn(l.toggle(a))}),y(),V(6,"p-menu",5,0),y()(),g(8,"span",6),b(9,"TODAY"),y(),g(10,"ul",7)(11,"li",8)(12,"div",9),V(13,"i",10),y(),g(14,"span",11),b(15,"Richard Jones "),g(16,"span",12),b(17,"has purchased a blue t-shirt for "),g(18,"span",13),b(19,"$79.00"),y()()()(),g(20,"li",14)(21,"div",15),V(22,"i",16),y(),g(23,"span",17),b(24,"Your request for withdrawal of "),g(25,"span",13),b(26,"$2500.00"),y(),b(27," has been initiated."),y()()(),g(28,"span",6),b(29,"YESTERDAY"),y(),g(30,"ul",18)(31,"li",8)(32,"div",9),V(33,"i",10),y(),g(34,"span",11),b(35,"Keyser Wick "),g(36,"span",12),b(37,"has purchased a black jacket for "),g(38,"span",13),b(39,"$59.00"),y()()()(),g(40,"li",8)(41,"div",19),V(42,"i",20),y(),g(43,"span",11),b(44,"Jane Davis "),g(45,"span",12),b(46,"has posted a new questions about your product."),y()()()(),g(47,"span",6),b(48,"LAST WEEK"),y(),g(49,"ul",21)(50,"li",8)(51,"div",22),V(52,"i",23),y(),g(53,"span",11),b(54,"Your revenue has increased by "),g(55,"span",13),b(56,"%25"),y(),b(57,"."),y()(),g(58,"li",8)(59,"div",24),V(60,"i",25),y(),g(61,"span",11)(62,"span",13),b(63,"12"),y(),b(64," users have added your products to their wishlist."),y()()()()}t&2&&(te(6),ee("popup",!0)("model",n.items))},dependencies:[ze,ot,ao,oo],encapsulation:2})};var wo=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=X({type:r,selectors:[["app-stats-widget"]],decls:56,vars:0,consts:[[1,"col-span-12","lg:col-span-6","xl:col-span-3"],[1,"card","mb-0"],[1,"flex","justify-between","mb-4"],[1,"block","text-muted-color","font-medium","mb-4"],[1,"text-surface-900","dark:text-surface-0","font-medium","text-xl"],[1,"flex","items-center","justify-center","bg-blue-100","dark:bg-blue-400/10","rounded-border",2,"width","2.5rem","height","2.5rem"],[1,"pi","pi-shopping-cart","text-blue-500","!text-xl"],[1,"text-primary","font-medium"],[1,"text-muted-color"],[1,"flex","items-center","justify-center","bg-orange-100","dark:bg-orange-400/10","rounded-border",2,"width","2.5rem","height","2.5rem"],[1,"pi","pi-dollar","text-orange-500","!text-xl"],[1,"flex","items-center","justify-center","bg-cyan-100","dark:bg-cyan-400/10","rounded-border",2,"width","2.5rem","height","2.5rem"],[1,"pi","pi-users","text-cyan-500","!text-xl"],[1,"flex","items-center","justify-center","bg-purple-100","dark:bg-purple-400/10","rounded-border",2,"width","2.5rem","height","2.5rem"],[1,"pi","pi-comment","text-purple-500","!text-xl"]],template:function(t,n){t&1&&(g(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"span",3),b(5,"Orders"),y(),g(6,"div",4),b(7,"152"),y()(),g(8,"div",5),V(9,"i",6),y()(),g(10,"span",7),b(11,"24 new "),y(),g(12,"span",8),b(13,"since last visit"),y()()(),g(14,"div",0)(15,"div",1)(16,"div",2)(17,"div")(18,"span",3),b(19,"Revenue"),y(),g(20,"div",4),b(21,"$2.100"),y()(),g(22,"div",9),V(23,"i",10),y()(),g(24,"span",7),b(25,"%52+ "),y(),g(26,"span",8),b(27,"since last week"),y()()(),g(28,"div",0)(29,"div",1)(30,"div",2)(31,"div")(32,"span",3),b(33,"Customers"),y(),g(34,"div",4),b(35,"28441"),y()(),g(36,"div",11),V(37,"i",12),y()(),g(38,"span",7),b(39,"520 "),y(),g(40,"span",8),b(41,"newly registered"),y()()(),g(42,"div",0)(43,"div",1)(44,"div",2)(45,"div")(46,"span",3),b(47,"Comments"),y(),g(48,"div",4),b(49,"152 Unread"),y()(),g(50,"div",13),V(51,"i",14),y()(),g(52,"span",7),b(53,"85 "),y(),g(54,"span",8),b(55,"responded"),y()()())},dependencies:[Ge],encapsulation:2})};function Ry(r,e){r&1&&(g(0,"tr")(1,"th"),b(2,"Image"),y(),g(3,"th",5),b(4,"Name "),V(5,"p-sortIcon",6),y(),g(6,"th",7),b(7,"Price "),V(8,"p-sortIcon",8),y(),g(9,"th"),b(10,"View"),y()())}function Py(r,e){if(r&1&&(g(0,"tr")(1,"td",9),V(2,"img",10),y(),g(3,"td",11),b(4),y(),g(5,"td",12),b(6),zm(7,"currency"),y(),g(8,"td",13),V(9,"button",14),y()()),r&2){let t=e.$implicit;te(2),Um("src","https://primefaces.org/cdn/primevue/images/product/",t.image,"",Qs),Bm("alt",t.name),te(2),Fn(t.name),te(2),Fn(Km(7,5,t.price,"USD"))}}var Eo=class r{constructor(e){this.productService=e}products;ngOnInit(){this.productService.getProductsSmall().then(e=>this.products=e)}static \u0275fac=function(t){return new(t||r)(Pe(lo))};static \u0275cmp=X({type:r,selectors:[["app-recent-sales-widget"]],features:[Zs([lo])],decls:8,vars:3,consts:[["header",""],["body",""],[1,"card","!mb-8"],[1,"font-semibold","text-xl","mb-4"],["responsiveLayout","scroll",3,"value","paginator","rows"],["pSortableColumn","name"],["field","name"],["pSortableColumn","price"],["field","price"],[2,"width","15%","min-width","5rem"],["width","50",1,"shadow-lg",3,"src","alt"],[2,"width","35%","min-width","7rem"],[2,"width","35%","min-width","8rem"],[2,"width","15%"],["pButton","","pRipple","","type","button","icon","pi pi-search",1,"p-button","p-component","p-button-text","p-button-icon-only"]],template:function(t,n){t&1&&(g(0,"div",2)(1,"div",3),b(2,"Recent Sales"),y(),g(3,"p-table",4),_t(4,Ry,11,0,"ng-template",null,0,jl)(6,Py,10,8,"ng-template",null,1,jl),y()()),t&2&&(te(3),ee("value",n.products)("paginator",!0)("rows",5))},dependencies:[Ge,Hm,gf,mf,ff,pf,ze,ot,st,wt],encapsulation:2})};var To=class r{menu=null;items=[{label:"Add New",icon:"pi pi-fw pi-plus"},{label:"Remove",icon:"pi pi-fw pi-trash"}];static \u0275fac=function(t){return new(t||r)};static \u0275cmp=X({type:r,selectors:[["app-best-selling-widget"]],decls:75,vars:2,consts:[["menu",""],[1,"card"],[1,"flex","justify-between","items-center","mb-6"],[1,"font-semibold","text-xl"],["pButton","","type","button","icon","pi pi-ellipsis-v",1,"p-button-rounded","p-button-text","p-button-plain",3,"click"],[3,"popup","model"],[1,"list-none","p-0","m-0"],[1,"flex","flex-col","md:flex-row","md:items-center","md:justify-between","mb-6"],[1,"text-surface-900","dark:text-surface-0","font-medium","mr-2","mb-1","md:mb-0"],[1,"mt-1","text-muted-color"],[1,"mt-2","md:mt-0","flex","items-center"],[1,"bg-surface-300","dark:bg-surface-500","rounded-border","overflow-hidden","w-40","lg:w-24",2,"height","8px"],[1,"bg-orange-500","h-full",2,"width","50%"],[1,"text-orange-500","ml-4","font-medium"],[1,"mt-2","md:mt-0","ml-0","md:ml-20","flex","items-center"],[1,"bg-cyan-500","h-full",2,"width","16%"],[1,"text-cyan-500","ml-4","font-medium"],[1,"bg-pink-500","h-full",2,"width","67%"],[1,"text-pink-500","ml-4","font-medium"],[1,"bg-green-500","h-full",2,"width","35%"],[1,"text-primary","ml-4","font-medium"],[1,"bg-purple-500","h-full",2,"width","75%"],[1,"text-purple-500","ml-4","font-medium"],[1,"bg-teal-500","h-full",2,"width","40%"],[1,"text-teal-500","ml-4","font-medium"]],template:function(t,n){if(t&1){let i=Mn();g(0,"div",1)(1,"div",2)(2,"div",3),b(3,"Best Selling Products"),y(),g(4,"div")(5,"button",4),Fe("click",function(a){Vn(i);let l=Xs(7);return Nn(l.toggle(a))}),y(),V(6,"p-menu",5,0),y()(),g(8,"ul",6)(9,"li",7)(10,"div")(11,"span",8),b(12,"Space T-Shirt"),y(),g(13,"div",9),b(14,"Clothing"),y()(),g(15,"div",10)(16,"div",11),V(17,"div",12),y(),g(18,"span",13),b(19,"%50"),y()()(),g(20,"li",7)(21,"div")(22,"span",8),b(23,"Portal Sticker"),y(),g(24,"div",9),b(25,"Accessories"),y()(),g(26,"div",14)(27,"div",11),V(28,"div",15),y(),g(29,"span",16),b(30,"%16"),y()()(),g(31,"li",7)(32,"div")(33,"span",8),b(34,"Supernova Sticker"),y(),g(35,"div",9),b(36,"Accessories"),y()(),g(37,"div",14)(38,"div",11),V(39,"div",17),y(),g(40,"span",18),b(41,"%67"),y()()(),g(42,"li",7)(43,"div")(44,"span",8),b(45,"Wonders Notebook"),y(),g(46,"div",9),b(47,"Office"),y()(),g(48,"div",14)(49,"div",11),V(50,"div",19),y(),g(51,"span",20),b(52,"%35"),y()()(),g(53,"li",7)(54,"div")(55,"span",8),b(56,"Mat Black Case"),y(),g(57,"div",9),b(58,"Accessories"),y()(),g(59,"div",14)(60,"div",11),V(61,"div",21),y(),g(62,"span",22),b(63,"%75"),y()()(),g(64,"li",7)(65,"div")(66,"span",8),b(67,"Robots T-Shirt"),y(),g(68,"div",9),b(69,"Clothing"),y()(),g(70,"div",14)(71,"div",11),V(72,"div",23),y(),g(73,"span",24),b(74,"%40"),y()()()()()}t&2&&(te(6),ee("popup",!0)("model",n.items))},dependencies:[Ge,ze,ot,ao,oo],encapsulation:2})};var Io=class r{constructor(e){this.layoutService=e;this.subscription=this.layoutService.configUpdate$.pipe(Im(25)).subscribe(()=>{this.initChart()})}chartData;chartOptions;subscription;ngOnInit(){this.initChart()}initChart(){let e=getComputedStyle(document.documentElement),t=e.getPropertyValue("--text-color"),n=e.getPropertyValue("--surface-border"),i=e.getPropertyValue("--text-color-secondary");this.chartData={labels:["Q1","Q2","Q3","Q4"],datasets:[{type:"bar",label:"Subscriptions",backgroundColor:e.getPropertyValue("--p-primary-400"),data:[4e3,1e4,15e3,4e3],barThickness:32},{type:"bar",label:"Advertising",backgroundColor:e.getPropertyValue("--p-primary-300"),data:[2100,8400,2400,7500],barThickness:32},{type:"bar",label:"Affiliate",backgroundColor:e.getPropertyValue("--p-primary-200"),data:[4100,5200,3400,7400],borderRadius:{topLeft:8,topRight:8,bottomLeft:0,bottomRight:0},borderSkipped:!1,barThickness:32}]},this.chartOptions={maintainAspectRatio:!1,aspectRatio:.8,plugins:{legend:{labels:{color:t}}},scales:{x:{stacked:!0,ticks:{color:i},grid:{color:"transparent",borderColor:"transparent"}},y:{stacked:!0,ticks:{color:i},grid:{color:n,borderColor:"transparent",drawTicks:!1}}}}}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}static \u0275fac=function(t){return new(t||r)(Pe(Et))};static \u0275cmp=X({type:r,selectors:[["app-revenue-stream-widget"]],decls:4,vars:2,consts:[[1,"card","!mb-8"],[1,"font-semibold","text-xl","mb-4"],["type","bar",1,"h-80",3,"data","options"]],template:function(t,n){t&1&&(g(0,"div",0)(1,"div",1),b(2,"Revenue Stream"),y(),V(3,"p-chart",2),y()),t&2&&(te(3),ee("data",n.chartData)("options",n.chartOptions))},dependencies:[_f,yf],encapsulation:2})};var bo=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=X({type:r,selectors:[["app-dashboard"]],decls:8,vars:0,consts:[[1,"grid","grid-cols-12","gap-8"],[1,"contents"],[1,"col-span-12","xl:col-span-6"]],template:function(t,n){t&1&&(g(0,"div",0),V(1,"app-stats-widget",1),g(2,"div",2),V(3,"app-recent-sales-widget")(4,"app-best-selling-widget"),y(),g(5,"div",2),V(6,"app-revenue-stream-widget")(7,"app-notifications-widget"),y()())},dependencies:[wo,Eo,To,Io,vo],encapsulation:2})};var So=class r{constructor(e){this.router=e}static \u0275fac=function(t){return new(t||r)(Pe(tn))};static \u0275cmp=X({type:r,selectors:[["topbar-widget"]],decls:32,vars:6,consts:[["href","#",1,"flex","items-center"],["viewBox","0 0 54 40","fill","none","xmlns","http://www.w3.org/2000/svg",1,"h-12","mr-2"],["fill-rule","evenodd","clip-rule","evenodd","d","M17.1637 19.2467C17.1566 19.4033 17.1529 19.561 17.1529 19.7194C17.1529 25.3503 21.7203 29.915 27.3546 29.915C32.9887 29.915 37.5561 25.3503 37.5561 19.7194C37.5561 19.5572 37.5524 19.3959 37.5449 19.2355C38.5617 19.0801 39.5759 18.9013 40.5867 18.6994L40.6926 18.6782C40.7191 19.0218 40.7326 19.369 40.7326 19.7194C40.7326 27.1036 34.743 33.0896 27.3546 33.0896C19.966 33.0896 13.9765 27.1036 13.9765 19.7194C13.9765 19.374 13.9896 19.0316 14.0154 18.6927L14.0486 18.6994C15.0837 18.9062 16.1223 19.0886 17.1637 19.2467ZM33.3284 11.4538C31.6493 10.2396 29.5855 9.52381 27.3546 9.52381C25.1195 9.52381 23.0524 10.2421 21.3717 11.4603C20.0078 11.3232 18.6475 11.1387 17.2933 10.907C19.7453 8.11308 23.3438 6.34921 27.3546 6.34921C31.36 6.34921 34.9543 8.10844 37.4061 10.896C36.0521 11.1292 34.692 11.3152 33.3284 11.4538ZM43.826 18.0518C43.881 18.6003 43.9091 19.1566 43.9091 19.7194C43.9091 28.8568 36.4973 36.2642 27.3546 36.2642C18.2117 36.2642 10.8 28.8568 10.8 19.7194C10.8 19.1615 10.8276 18.61 10.8816 18.0663L7.75383 17.4411C7.66775 18.1886 7.62354 18.9488 7.62354 19.7194C7.62354 30.6102 16.4574 39.4388 27.3546 39.4388C38.2517 39.4388 47.0855 30.6102 47.0855 19.7194C47.0855 18.9439 47.0407 18.1789 46.9536 17.4267L43.826 18.0518ZM44.2613 9.54743L40.9084 10.2176C37.9134 5.95821 32.9593 3.1746 27.3546 3.1746C21.7442 3.1746 16.7856 5.96385 13.7915 10.2305L10.4399 9.56057C13.892 3.83178 20.1756 0 27.3546 0C34.5281 0 40.8075 3.82591 44.2613 9.54743Z","fill","var(--primary-color)"],["id","mask0_1413_1551","maskUnits","userSpaceOnUse","x","0","y","8","width","54","height","11",2,"mask-type","alpha"],["d","M27 18.3652C10.5114 19.1944 0 8.88892 0 8.88892C0 8.88892 16.5176 14.5866 27 14.5866C37.4824 14.5866 54 8.88892 54 8.88892C54 8.88892 43.4886 17.5361 27 18.3652Z","fill","var(--primary-color)"],["mask","url(#mask0_1413_1551)"],["d","M-4.673e-05 8.88887L3.73084 -1.91434L-8.00806 17.0473L-4.673e-05 8.88887ZM27 18.3652L26.4253 6.95109L27 18.3652ZM54 8.88887L61.2673 17.7127L50.2691 -1.91434L54 8.88887ZM-4.673e-05 8.88887C-8.00806 17.0473 -8.00469 17.0505 -8.00132 17.0538C-8.00018 17.055 -7.99675 17.0583 -7.9944 17.0607C-7.98963 17.0653 -7.98474 17.0701 -7.97966 17.075C-7.96949 17.0849 -7.95863 17.0955 -7.94707 17.1066C-7.92401 17.129 -7.89809 17.1539 -7.86944 17.1812C-7.8122 17.236 -7.74377 17.3005 -7.66436 17.3743C-7.50567 17.5218 -7.30269 17.7063 -7.05645 17.9221C-6.56467 18.3532 -5.89662 18.9125 -5.06089 19.5534C-3.39603 20.83 -1.02575 22.4605 1.98012 24.0457C7.97874 27.2091 16.7723 30.3226 27.5746 29.7793L26.4253 6.95109C20.7391 7.23699 16.0326 5.61231 12.6534 3.83024C10.9703 2.94267 9.68222 2.04866 8.86091 1.41888C8.45356 1.10653 8.17155 0.867278 8.0241 0.738027C7.95072 0.673671 7.91178 0.637576 7.90841 0.634492C7.90682 0.63298 7.91419 0.639805 7.93071 0.65557C7.93897 0.663455 7.94952 0.673589 7.96235 0.686039C7.96883 0.692262 7.97582 0.699075 7.98338 0.706471C7.98719 0.710167 7.99113 0.714014 7.99526 0.718014C7.99729 0.720008 8.00047 0.723119 8.00148 0.724116C8.00466 0.727265 8.00796 0.730446 -4.673e-05 8.88887ZM27.5746 29.7793C37.6904 29.2706 45.9416 26.3684 51.6602 23.6054C54.5296 22.2191 56.8064 20.8465 58.4186 19.7784C59.2265 19.2431 59.873 18.7805 60.3494 18.4257C60.5878 18.2482 60.7841 18.0971 60.9374 17.977C61.014 17.9169 61.0799 17.8645 61.1349 17.8203C61.1624 17.7981 61.1872 17.7781 61.2093 17.7602C61.2203 17.7512 61.2307 17.7427 61.2403 17.7348C61.2452 17.7308 61.2499 17.727 61.2544 17.7233C61.2566 17.7215 61.2598 17.7188 61.261 17.7179C61.2642 17.7153 61.2673 17.7127 54 8.88887C46.7326 0.0650536 46.7357 0.0625219 46.7387 0.0600241C46.7397 0.0592345 46.7427 0.0567658 46.7446 0.0551857C46.7485 0.0520238 46.7521 0.0489887 46.7557 0.0460799C46.7628 0.0402623 46.7694 0.0349487 46.7753 0.0301318C46.7871 0.0204986 46.7966 0.0128495 46.8037 0.00712562C46.818 -0.00431848 46.8228 -0.00808311 46.8184 -0.00463784C46.8096 0.00228345 46.764 0.0378652 46.6828 0.0983779C46.5199 0.219675 46.2165 0.439161 45.7812 0.727519C44.9072 1.30663 43.5257 2.14765 41.7061 3.02677C38.0469 4.79468 32.7981 6.63058 26.4253 6.95109L27.5746 29.7793ZM54 8.88887C50.2691 -1.91433 50.27 -1.91467 50.271 -1.91498C50.2712 -1.91506 50.272 -1.91535 50.2724 -1.9155C50.2733 -1.91581 50.274 -1.91602 50.2743 -1.91616C50.2752 -1.91643 50.275 -1.91636 50.2738 -1.91595C50.2714 -1.91515 50.2652 -1.91302 50.2552 -1.9096C50.2351 -1.90276 50.1999 -1.89078 50.1503 -1.874C50.0509 -1.84043 49.8938 -1.78773 49.6844 -1.71863C49.2652 -1.58031 48.6387 -1.377 47.8481 -1.13035C46.2609 -0.635237 44.0427 0.0249875 41.5325 0.6823C36.215 2.07471 30.6736 3.15796 27 3.15796V26.0151C33.8087 26.0151 41.7672 24.2495 47.3292 22.7931C50.2586 22.026 52.825 21.2618 54.6625 20.6886C55.5842 20.4011 56.33 20.1593 56.8551 19.986C57.1178 19.8993 57.3258 19.8296 57.4735 19.7797C57.5474 19.7548 57.6062 19.7348 57.6493 19.72C57.6709 19.7127 57.6885 19.7066 57.7021 19.7019C57.7089 19.6996 57.7147 19.6976 57.7195 19.696C57.7219 19.6952 57.7241 19.6944 57.726 19.6938C57.7269 19.6934 57.7281 19.693 57.7286 19.6929C57.7298 19.6924 57.7309 19.692 54 8.88887ZM27 3.15796C23.3263 3.15796 17.7849 2.07471 12.4674 0.6823C9.95717 0.0249875 7.73904 -0.635237 6.15184 -1.13035C5.36118 -1.377 4.73467 -1.58031 4.3155 -1.71863C4.10609 -1.78773 3.94899 -1.84043 3.84961 -1.874C3.79994 -1.89078 3.76474 -1.90276 3.74471 -1.9096C3.73469 -1.91302 3.72848 -1.91515 3.72613 -1.91595C3.72496 -1.91636 3.72476 -1.91643 3.72554 -1.91616C3.72593 -1.91602 3.72657 -1.91581 3.72745 -1.9155C3.72789 -1.91535 3.72874 -1.91506 3.72896 -1.91498C3.72987 -1.91467 3.73084 -1.91433 -4.673e-05 8.88887C-3.73093 19.692 -3.72983 19.6924 -3.72868 19.6929C-3.72821 19.693 -3.72698 19.6934 -3.72603 19.6938C-3.72415 19.6944 -3.72201 19.6952 -3.71961 19.696C-3.71482 19.6976 -3.70901 19.6996 -3.7022 19.7019C-3.68858 19.7066 -3.67095 19.7127 -3.6494 19.72C-3.60629 19.7348 -3.54745 19.7548 -3.47359 19.7797C-3.32589 19.8296 -3.11788 19.8993 -2.85516 19.986C-2.33008 20.1593 -1.58425 20.4011 -0.662589 20.6886C1.17485 21.2618 3.74125 22.026 6.67073 22.7931C12.2327 24.2495 20.1913 26.0151 27 26.0151V3.15796Z","fill","var(--primary-color)"],[1,"text-surface-900","dark:text-surface-0","font-medium","text-2xl","leading-normal","mr-20"],["pButton","","severity","secondary","pRipple","","pStyleClass","@next","enterClass","hidden","leaveToClass","hidden",1,"lg:!hidden",3,"text","rounded","hideOnOutsideClick"],[1,"pi","pi-bars","!text-2xl"],[1,"items-center","bg-surface-0","dark:bg-surface-900","grow","justify-between","hidden","lg:flex","absolute","lg:static","w-full","left-0","top-full","px-12","lg:px-0","z-20","rounded-border"],[1,"list-none","p-0","m-0","flex","lg:items-center","select-none","flex-col","lg:flex-row","cursor-pointer","gap-8"],["pRipple","",1,"px-0","py-4","text-surface-900","dark:text-surface-0","font-medium","text-xl",3,"click"],[1,"flex","border-t","lg:border-t-0","border-surface","py-4","lg:py-0","mt-4","lg:mt-0","gap-2"],["pButton","","pRipple","","label","Login","routerLink","/auth/login",3,"rounded","text"],["pButton","","pRipple","","label","Register","routerLink","/auth/login",3,"rounded"]],template:function(t,n){t&1&&(g(0,"a",0),yr(),g(1,"svg",1),V(2,"path",2),g(3,"mask",3),V(4,"path",4),y(),g(5,"g",5),V(6,"path",6),y()(),_r(),g(7,"span",7),b(8,"SAKAI"),y()(),g(9,"a",8),V(10,"i",9),y(),g(11,"div",10)(12,"ul",11)(13,"li")(14,"a",12),Fe("click",function(){return n.router.navigate(["/landing"],{fragment:"home"})}),g(15,"span"),b(16,"Home"),y()()(),g(17,"li")(18,"a",12),Fe("click",function(){return n.router.navigate(["/landing"],{fragment:"features"})}),g(19,"span"),b(20,"Features"),y()()(),g(21,"li")(22,"a",12),Fe("click",function(){return n.router.navigate(["/landing"],{fragment:"highlights"})}),g(23,"span"),b(24,"Highlights"),y()()(),g(25,"li")(26,"a",12),Fe("click",function(){return n.router.navigate(["/landing"],{fragment:"pricing"})}),g(27,"span"),b(28,"Pricing"),y()()()(),g(29,"div",13),V(30,"button",14)(31,"button",15),y()()),t&2&&(te(9),ee("text",!0)("rounded",!0)("hideOnOutsideClick",!0),te(21),ee("rounded",!0)("text",!0),te(),ee("rounded",!0))},dependencies:[Ve,nn,Er,so,ze,ot,st,wt],encapsulation:2})};var Ao=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=X({type:r,selectors:[["hero-widget"]],decls:11,vars:1,consts:[["id","hero",1,"flex","flex-col","pt-6","px-6","lg:px-20","overflow-hidden",2,"background","linear-gradient(0deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2)), radial-gradient(77.36% 256.97% at 77.36% 57.52%, rgb(238, 239, 175) 0%, rgb(195, 227, 250) 100%)","clip-path","ellipse(150% 87% at 93% 13%)"],[1,"mx-6","md:mx-20","mt-0","md:mt-6"],[1,"text-6xl","font-bold","text-gray-900","leading-tight"],[1,"font-light","block"],[1,"font-normal","text-2xl","leading-normal","md:mt-4","text-gray-700"],["pButton","","pRipple","","type","button","label","Get Started",1,"!text-xl","mt-8","!px-4",3,"rounded"],[1,"flex","justify-center","md:justify-end"],["src","https://primefaces.org/cdn/templates/sakai/landing/screen-1.png","alt","Hero Image",1,"w-9/12","md:w-auto"]],template:function(t,n){t&1&&(g(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),b(4,"Eu sem integer"),y(),b(5,"eget magna fermentum"),y(),g(6,"p",4),b(7,"Sed blandit libero volutpat sed cras. Fames ac turpis egestas integer. Placerat in egestas erat..."),y(),V(8,"button",5),y(),g(9,"div",6),V(10,"img",7),y()()),t&2&&(te(8),ee("rounded",!0))},dependencies:[ze,ot,st,wt],encapsulation:2})};var xo=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=X({type:r,selectors:[["features-widget"]],decls:97,vars:0,consts:[["id","features",1,"py-6","px-6","lg:px-20","mt-8","mx-0","lg:mx-20"],[1,"grid","grid-cols-12","gap-4","justify-center"],[1,"col-span-12","text-center","mt-20","mb-6"],[1,"text-surface-900","dark:text-surface-0","font-normal","mb-2","text-4xl"],[1,"text-muted-color","text-2xl"],[1,"col-span-12","md:col-span-12","lg:col-span-4","p-0","lg:pr-8","lg:pb-8","mt-6","lg:mt-0"],[2,"height","160px","padding","2px","border-radius","10px","background","linear-gradient(90deg, rgba(253, 228, 165, 0.2), rgba(187, 199, 205, 0.2)), linear-gradient(180deg, rgba(253, 228, 165, 0.2), rgba(187, 199, 205, 0.2))"],[1,"p-4","bg-surface-0","dark:bg-surface-900","h-full",2,"border-radius","8px"],[1,"flex","items-center","justify-center","bg-yellow-200","mb-4",2,"width","3.5rem","height","3.5rem","border-radius","10px"],[1,"pi","pi-fw","pi-users","!text-2xl","text-yellow-700"],[1,"mb-2","text-surface-900","dark:text-surface-0"],[1,"text-surface-600","dark:text-surface-200"],[2,"height","160px","padding","2px","border-radius","10px","background","linear-gradient(90deg, rgba(145, 226, 237, 0.2), rgba(251, 199, 145, 0.2)), linear-gradient(180deg, rgba(253, 228, 165, 0.2), rgba(172, 180, 223, 0.2))"],[1,"flex","items-center","justify-center","bg-cyan-200","mb-4",2,"width","3.5rem","height","3.5rem","border-radius","10px"],[1,"pi","pi-fw","pi-palette","!text-2xl","text-cyan-700"],[1,"col-span-12","md:col-span-12","lg:col-span-4","p-0","lg:pb-8","mt-6","lg:mt-0"],[2,"height","160px","padding","2px","border-radius","10px","background","linear-gradient(90deg, rgba(145, 226, 237, 0.2), rgba(172, 180, 223, 0.2)), linear-gradient(180deg, rgba(172, 180, 223, 0.2), rgba(246, 158, 188, 0.2))"],[1,"flex","items-center","justify-center","bg-indigo-200",2,"width","3.5rem","height","3.5rem","border-radius","10px"],[1,"pi","pi-fw","pi-map","!text-2xl","text-indigo-700"],[1,"mt-6","mb-1","text-surface-900","dark:text-surface-0","text-xl","font-semibold"],[2,"height","160px","padding","2px","border-radius","10px","background","linear-gradient(90deg, rgba(187, 199, 205, 0.2), rgba(251, 199, 145, 0.2)), linear-gradient(180deg, rgba(253, 228, 165, 0.2), rgba(145, 210, 204, 0.2))"],[1,"flex","items-center","justify-center","bg-slate-200","mb-4",2,"width","3.5rem","height","3.5rem","border-radius","10px"],[1,"pi","pi-fw","pi-id-card","!text-2xl","text-slate-700"],[2,"height","160px","padding","2px","border-radius","10px","background","linear-gradient(90deg, rgba(187, 199, 205, 0.2), rgba(246, 158, 188, 0.2)), linear-gradient(180deg, rgba(145, 226, 237, 0.2), rgba(160, 210, 250, 0.2))"],[1,"flex","items-center","justify-center","bg-orange-200","mb-4",2,"width","3.5rem","height","3.5rem","border-radius","10px"],[1,"pi","pi-fw","pi-star","!text-2xl","text-orange-700"],[2,"height","160px","padding","2px","border-radius","10px","background","linear-gradient(90deg, rgba(251, 199, 145, 0.2), rgba(246, 158, 188, 0.2)), linear-gradient(180deg, rgba(172, 180, 223, 0.2), rgba(212, 162, 221, 0.2))"],[1,"flex","items-center","justify-center","bg-pink-200","mb-4",2,"width","3.5rem","height","3.5rem","border-radius","10px"],[1,"pi","pi-fw","pi-moon","!text-2xl","text-pink-700"],[1,"col-span-12","md:col-span-12","lg:col-span-4","p-0","lg:pr-8","mt-6","lg:mt-0"],[2,"height","160px","padding","2px","border-radius","10px","background","linear-gradient(90deg, rgba(145, 210, 204, 0.2), rgba(160, 210, 250, 0.2)), linear-gradient(180deg, rgba(187, 199, 205, 0.2), rgba(145, 210, 204, 0.2))"],[1,"flex","items-center","justify-center","bg-teal-200","mb-4",2,"width","3.5rem","height","3.5rem","border-radius","10px"],[1,"pi","pi-fw","pi-shopping-cart","!text-2xl","text-teal-700"],[2,"height","160px","padding","2px","border-radius","10px","background","linear-gradient(90deg, rgba(145, 210, 204, 0.2), rgba(212, 162, 221, 0.2)), linear-gradient(180deg, rgba(251, 199, 145, 0.2), rgba(160, 210, 250, 0.2))"],[1,"flex","items-center","justify-center","bg-blue-200","mb-4",2,"width","3.5rem","height","3.5rem","border-radius","10px"],[1,"pi","pi-fw","pi-globe","!text-2xl","text-blue-700"],[1,"col-span-12","md:col-span-12","lg:col-span-4","p-0","lg-4","mt-6","lg:mt-0"],[2,"height","160px","padding","2px","border-radius","10px","background","linear-gradient(90deg, rgba(160, 210, 250, 0.2), rgba(212, 162, 221, 0.2)), linear-gradient(180deg, rgba(246, 158, 188, 0.2), rgba(212, 162, 221, 0.2))"],[1,"flex","items-center","justify-center","bg-purple-200","mb-4",2,"width","3.5rem","height","3.5rem","border-radius","10px"],[1,"pi","pi-fw","pi-eye","!text-2xl","text-purple-700"],[1,"col-span-12","mt-20","mb-20","p-2","md:p-20",2,"border-radius","20px","background","linear-gradient(0deg, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6)), radial-gradient(77.36% 256.97% at 77.36% 57.52%, #efe1af 0%, #c3dcfa 100%)"],[1,"flex","flex-col","justify-center","items-center","text-center","px-4","py-4","md:py-0"],[1,"text-gray-900","mb-2","text-3xl","font-semibold"],[1,"text-gray-600","text-2xl"],[1,"text-gray-900","sm:line-height-2","md:line-height-4","text-2xl","mt-6",2,"max-width","800px"],["src","https://primefaces.org/cdn/templates/sakai/landing/peak-logo.svg","alt","Company logo",1,"mt-6"]],template:function(t,n){t&1&&(g(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),b(4,"Marvelous Features"),y(),g(5,"span",4),b(6,"Placerat in egestas erat..."),y()(),g(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8),V(11,"i",9),y(),g(12,"h5",10),b(13,"Easy to Use"),y(),g(14,"span",11),b(15,"Posuere morbi leo urna molestie."),y()()()(),g(16,"div",5)(17,"div",12)(18,"div",7)(19,"div",13),V(20,"i",14),y(),g(21,"h5",10),b(22,"Fresh Design"),y(),g(23,"span",11),b(24,"Semper risus in hendrerit."),y()()()(),g(25,"div",15)(26,"div",16)(27,"div",7)(28,"div",17),V(29,"i",18),y(),g(30,"div",19),b(31,"Well Documented"),y(),g(32,"span",11),b(33,"Non arcu risus quis varius quam quisque."),y()()()(),g(34,"div",5)(35,"div",20)(36,"div",7)(37,"div",21),V(38,"i",22),y(),g(39,"div",19),b(40,"Responsive Layout"),y(),g(41,"span",11),b(42,"Nulla malesuada pellentesque elit."),y()()()(),g(43,"div",5)(44,"div",23)(45,"div",7)(46,"div",24),V(47,"i",25),y(),g(48,"div",19),b(49,"Clean Code"),y(),g(50,"span",11),b(51,"Condimentum lacinia quis vel eros."),y()()()(),g(52,"div",15)(53,"div",26)(54,"div",7)(55,"div",27),V(56,"i",28),y(),g(57,"div",19),b(58,"Dark Mode"),y(),g(59,"span",11),b(60,"Convallis tellus id interdum velit laoreet."),y()()()(),g(61,"div",29)(62,"div",30)(63,"div",7)(64,"div",31),V(65,"i",32),y(),g(66,"div",19),b(67,"Ready to Use"),y(),g(68,"span",11),b(69,"Mauris sit amet massa vitae."),y()()()(),g(70,"div",29)(71,"div",33)(72,"div",7)(73,"div",34),V(74,"i",35),y(),g(75,"div",19),b(76,"Modern Practices"),y(),g(77,"span",11),b(78,"Elementum nibh tellus molestie nunc non."),y()()()(),g(79,"div",36)(80,"div",37)(81,"div",7)(82,"div",38),V(83,"i",39),y(),g(84,"div",19),b(85,"Privacy"),y(),g(86,"span",11),b(87,"Neque egestas congue quisque."),y()()()(),g(88,"div",40)(89,"div",41)(90,"div",42),b(91,"Jos\xE9phine Miller"),y(),g(92,"span",43),b(93,"Peak Interactive"),y(),g(94,"p",44),b(95," \u201CDuis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\u201D "),y(),V(96,"img",45),y()()()())},dependencies:[Ge],encapsulation:2})};var Co=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=X({type:r,selectors:[["highlights-widget"]],decls:26,vars:0,consts:[["id","highlights",1,"py-6","px-6","lg:px-20","mx-0","my-12","lg:mx-20"],[1,"text-center"],[1,"text-surface-900","dark:text-surface-0","font-normal","mb-2","text-4xl"],[1,"text-muted-color","text-2xl"],[1,"grid","grid-cols-12","gap-4","mt-20","pb-2","md:pb-20"],[1,"flex","justify-center","col-span-12","lg:col-span-6","bg-purple-100","p-0","order-1","lg:order-none",2,"border-radius","8px"],["src","https://primefaces.org/cdn/templates/sakai/landing/mockup.png","alt","mockup mobile",1,"w-11/12"],[1,"col-span-12","lg:col-span-6","my-auto","flex","flex-col","lg:items-end","text-center","lg:text-right","gap-4"],[1,"flex","items-center","justify-center","bg-purple-200","self-center","lg:self-end",2,"width","4.2rem","height","4.2rem","border-radius","10px"],[1,"pi","pi-fw","pi-mobile","!text-4xl","text-purple-700"],[1,"leading-none","text-surface-900","dark:text-surface-0","text-3xl","font-normal"],[1,"text-surface-700","dark:text-surface-100","text-2xl","leading-normal","ml-0","md:ml-2",2,"max-width","650px"],[1,"grid","grid-cols-12","gap-4","my-20","pt-2","md:pt-20"],[1,"col-span-12","lg:col-span-6","my-auto","flex","flex-col","text-center","lg:text-left","lg:items-start","gap-4"],[1,"flex","items-center","justify-center","bg-yellow-200","self-center","lg:self-start",2,"width","4.2rem","height","4.2rem","border-radius","10px"],[1,"pi","pi-fw","pi-desktop","!text-3xl","text-yellow-700"],[1,"text-surface-700","dark:text-surface-100","text-2xl","leading-normal","mr-0","md:mr-2",2,"max-width","650px"],[1,"flex","justify-end","order-1","sm:order-2","col-span-12","lg:col-span-6","bg-yellow-100","p-0",2,"border-radius","8px"],["src","https://primefaces.org/cdn/templates/sakai/landing/mockup-desktop.png","alt","mockup",1,"w-11/12"]],template:function(t,n){t&1&&(g(0,"div",0)(1,"div",1)(2,"div",2),b(3,"Powerful Everywhere"),y(),g(4,"span",3),b(5,"Amet consectetur adipiscing elit..."),y()(),g(6,"div",4)(7,"div",5),V(8,"img",6),y(),g(9,"div",7)(10,"div",8),V(11,"i",9),y(),g(12,"div",10),b(13,"Congue Quisque Egestas"),y(),g(14,"span",11),b(15,"Lectus arcu bibendum at varius vel pharetra vel turpis nunc. Eget aliquet nibh praesent tristique magna sit amet purus gravida. Sit amet mattis vulputate enim nulla aliquet."),y()()(),g(16,"div",12)(17,"div",13)(18,"div",14),V(19,"i",15),y(),g(20,"div",10),b(21,"Celerisque Eu Ultrices"),y(),g(22,"span",16),b(23,"Adipiscing commodo elit at imperdiet dui. Viverra nibh cras pulvinar mattis nunc sed blandit libero. Suspendisse in est ante in. Mauris pharetra et ultrices neque ornare aenean euismod elementum nisi."),y()(),g(24,"div",17),V(25,"img",18),y()()())},encapsulation:2})};var Ro=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=X({type:r,selectors:[["pricing-widget"]],decls:97,vars:0,consts:[["id","pricing",1,"py-6","px-6","lg:px-20","my-2","md:my-6"],[1,"text-center","mb-6"],[1,"text-surface-900","dark:text-surface-0","font-normal","mb-2","text-4xl"],[1,"text-muted-color","text-2xl"],[1,"grid","grid-cols-12","gap-4","justify-between","mt-20","md:mt-0"],[1,"col-span-12","lg:col-span-4","p-0","md:p-4"],[1,"p-4","flex","flex-col","border-surface-200","dark:border-surface-600","pricing-card","cursor-pointer","border-2","hover:border-primary","duration-300","transition-all",2,"border-radius","10px"],[1,"text-surface-900","dark:text-surface-0","text-center","my-8","text-3xl"],["src","https://primefaces.org/cdn/templates/sakai/landing/free.svg","alt","free",1,"w-10/12","mx-auto"],[1,"my-8","flex","flex-col","items-center","gap-4"],[1,"flex","items-center"],[1,"text-5xl","font-bold","mr-2","text-surface-900","dark:text-surface-0"],[1,"text-surface-600","dark:text-surface-200"],["pButton","","pRipple","","label","Get Started",1,"p-button-rounded","border-0","ml-4","font-light","leading-tight","bg-blue-500","text-white"],[1,"w-full","bg-surface-200"],[1,"my-8","list-none","p-0","flex","text-surface-900","dark:text-surface-0","flex-col","px-8"],[1,"py-2"],[1,"pi","pi-fw","pi-check","text-xl","text-cyan-500","mr-2"],[1,"text-xl","leading-normal"],[1,"col-span-12","lg:col-span-4","p-0","md:p-4","mt-6","md:mt-0"],["src","https://primefaces.org/cdn/templates/sakai/landing/startup.svg","alt","startup",1,"w-10/12","mx-auto"],["src","https://primefaces.org/cdn/templates/sakai/landing/enterprise.svg","alt","enterprise",1,"w-10/12","mx-auto"],["pButton","","pRipple","","label","Try Free",1,"p-button-rounded","border-0","ml-4","font-light","leading-tight","bg-blue-500","text-white"]],template:function(t,n){t&1&&(g(0,"div",0)(1,"div",1)(2,"div",2),b(3,"Matchless Pricing"),y(),g(4,"span",3),b(5,"Amet consectetur adipiscing elit..."),y()(),g(6,"div",4)(7,"div",5)(8,"div",6)(9,"div",7),b(10,"Free"),y(),V(11,"img",8),g(12,"div",9)(13,"div",10)(14,"span",11),b(15,"$0"),y(),g(16,"span",12),b(17,"per month"),y()(),V(18,"button",13),y(),V(19,"p-divider",14),g(20,"ul",15)(21,"li",16),V(22,"i",17),g(23,"span",18),b(24,"Responsive Layout"),y()(),g(25,"li",16),V(26,"i",17),g(27,"span",18),b(28,"Unlimited Push Messages"),y()(),g(29,"li",16),V(30,"i",17),g(31,"span",18),b(32,"50 Support Ticket"),y()(),g(33,"li",16),V(34,"i",17),g(35,"span",18),b(36,"Free Shipping"),y()()()()(),g(37,"div",19)(38,"div",6)(39,"div",7),b(40,"Startup"),y(),V(41,"img",20),g(42,"div",9)(43,"div",10)(44,"span",11),b(45,"$1"),y(),g(46,"span",12),b(47,"per month"),y()(),V(48,"button",13),y(),V(49,"p-divider",14),g(50,"ul",15)(51,"li",16),V(52,"i",17),g(53,"span",18),b(54,"Responsive Layout"),y()(),g(55,"li",16),V(56,"i",17),g(57,"span",18),b(58,"Unlimited Push Messages"),y()(),g(59,"li",16),V(60,"i",17),g(61,"span",18),b(62,"50 Support Ticket"),y()(),g(63,"li",16),V(64,"i",17),g(65,"span",18),b(66,"Free Shipping"),y()()()()(),g(67,"div",19)(68,"div",6)(69,"div",7),b(70,"Enterprise"),y(),V(71,"img",21),g(72,"div",9)(73,"div",10)(74,"span",11),b(75,"$5"),y(),g(76,"span",12),b(77,"per month"),y()(),V(78,"button",22),y(),V(79,"p-divider",14),g(80,"ul",15)(81,"li",16),V(82,"i",17),g(83,"span",18),b(84,"Responsive Layout"),y()(),g(85,"li",16),V(86,"i",17),g(87,"span",18),b(88,"Unlimited Push Messages"),y()(),g(89,"li",16),V(90,"i",17),g(91,"span",18),b(92,"50 Support Ticket"),y()(),g(93,"li",16),V(94,"i",17),g(95,"span",18),b(96,"Free Shipping"),y()()()()()()())},dependencies:[uo,wf,ze,ot,st,wt],encapsulation:2})};var Po=class r{constructor(e){this.router=e}static \u0275fac=function(t){return new(t||r)(Pe(tn))};static \u0275cmp=X({type:r,selectors:[["footer-widget"]],decls:57,vars:0,consts:[[1,"py-12","px-12","mx-0","mt-20","lg:mx-20"],[1,"grid","grid-cols-12","gap-4"],[1,"col-span-12","md:col-span-2"],[1,"flex","flex-wrap","items-center","justify-center","md:justify-start","md:mb-0","mb-6","cursor-pointer",3,"click"],["viewBox","0 0 54 40","fill","none","xmlns","http://www.w3.org/2000/svg",1,"h-14","mr-2"],["fill-rule","evenodd","clip-rule","evenodd","d","M17.1637 19.2467C17.1566 19.4033 17.1529 19.561 17.1529 19.7194C17.1529 25.3503 21.7203 29.915 27.3546 29.915C32.9887 29.915 37.5561 25.3503 37.5561 19.7194C37.5561 19.5572 37.5524 19.3959 37.5449 19.2355C38.5617 19.0801 39.5759 18.9013 40.5867 18.6994L40.6926 18.6782C40.7191 19.0218 40.7326 19.369 40.7326 19.7194C40.7326 27.1036 34.743 33.0896 27.3546 33.0896C19.966 33.0896 13.9765 27.1036 13.9765 19.7194C13.9765 19.374 13.9896 19.0316 14.0154 18.6927L14.0486 18.6994C15.0837 18.9062 16.1223 19.0886 17.1637 19.2467ZM33.3284 11.4538C31.6493 10.2396 29.5855 9.52381 27.3546 9.52381C25.1195 9.52381 23.0524 10.2421 21.3717 11.4603C20.0078 11.3232 18.6475 11.1387 17.2933 10.907C19.7453 8.11308 23.3438 6.34921 27.3546 6.34921C31.36 6.34921 34.9543 8.10844 37.4061 10.896C36.0521 11.1292 34.692 11.3152 33.3284 11.4538ZM43.826 18.0518C43.881 18.6003 43.9091 19.1566 43.9091 19.7194C43.9091 28.8568 36.4973 36.2642 27.3546 36.2642C18.2117 36.2642 10.8 28.8568 10.8 19.7194C10.8 19.1615 10.8276 18.61 10.8816 18.0663L7.75383 17.4411C7.66775 18.1886 7.62354 18.9488 7.62354 19.7194C7.62354 30.6102 16.4574 39.4388 27.3546 39.4388C38.2517 39.4388 47.0855 30.6102 47.0855 19.7194C47.0855 18.9439 47.0407 18.1789 46.9536 17.4267L43.826 18.0518ZM44.2613 9.54743L40.9084 10.2176C37.9134 5.95821 32.9593 3.1746 27.3546 3.1746C21.7442 3.1746 16.7856 5.96385 13.7915 10.2305L10.4399 9.56057C13.892 3.83178 20.1756 0 27.3546 0C34.5281 0 40.8075 3.82591 44.2613 9.54743Z","fill","var(--primary-color)"],["id","mask0_1413_1551","maskUnits","userSpaceOnUse","x","0","y","8","width","54","height","11",2,"mask-type","alpha"],["d","M27 18.3652C10.5114 19.1944 0 8.88892 0 8.88892C0 8.88892 16.5176 14.5866 27 14.5866C37.4824 14.5866 54 8.88892 54 8.88892C54 8.88892 43.4886 17.5361 27 18.3652Z","fill","var(--primary-color)"],["mask","url(#mask0_1413_1551)"],["d","M-4.673e-05 8.88887L3.73084 -1.91434L-8.00806 17.0473L-4.673e-05 8.88887ZM27 18.3652L26.4253 6.95109L27 18.3652ZM54 8.88887L61.2673 17.7127L50.2691 -1.91434L54 8.88887ZM-4.673e-05 8.88887C-8.00806 17.0473 -8.00469 17.0505 -8.00132 17.0538C-8.00018 17.055 -7.99675 17.0583 -7.9944 17.0607C-7.98963 17.0653 -7.98474 17.0701 -7.97966 17.075C-7.96949 17.0849 -7.95863 17.0955 -7.94707 17.1066C-7.92401 17.129 -7.89809 17.1539 -7.86944 17.1812C-7.8122 17.236 -7.74377 17.3005 -7.66436 17.3743C-7.50567 17.5218 -7.30269 17.7063 -7.05645 17.9221C-6.56467 18.3532 -5.89662 18.9125 -5.06089 19.5534C-3.39603 20.83 -1.02575 22.4605 1.98012 24.0457C7.97874 27.2091 16.7723 30.3226 27.5746 29.7793L26.4253 6.95109C20.7391 7.23699 16.0326 5.61231 12.6534 3.83024C10.9703 2.94267 9.68222 2.04866 8.86091 1.41888C8.45356 1.10653 8.17155 0.867278 8.0241 0.738027C7.95072 0.673671 7.91178 0.637576 7.90841 0.634492C7.90682 0.63298 7.91419 0.639805 7.93071 0.65557C7.93897 0.663455 7.94952 0.673589 7.96235 0.686039C7.96883 0.692262 7.97582 0.699075 7.98338 0.706471C7.98719 0.710167 7.99113 0.714014 7.99526 0.718014C7.99729 0.720008 8.00047 0.723119 8.00148 0.724116C8.00466 0.727265 8.00796 0.730446 -4.673e-05 8.88887ZM27.5746 29.7793C37.6904 29.2706 45.9416 26.3684 51.6602 23.6054C54.5296 22.2191 56.8064 20.8465 58.4186 19.7784C59.2265 19.2431 59.873 18.7805 60.3494 18.4257C60.5878 18.2482 60.7841 18.0971 60.9374 17.977C61.014 17.9169 61.0799 17.8645 61.1349 17.8203C61.1624 17.7981 61.1872 17.7781 61.2093 17.7602C61.2203 17.7512 61.2307 17.7427 61.2403 17.7348C61.2452 17.7308 61.2499 17.727 61.2544 17.7233C61.2566 17.7215 61.2598 17.7188 61.261 17.7179C61.2642 17.7153 61.2673 17.7127 54 8.88887C46.7326 0.0650536 46.7357 0.0625219 46.7387 0.0600241C46.7397 0.0592345 46.7427 0.0567658 46.7446 0.0551857C46.7485 0.0520238 46.7521 0.0489887 46.7557 0.0460799C46.7628 0.0402623 46.7694 0.0349487 46.7753 0.0301318C46.7871 0.0204986 46.7966 0.0128495 46.8037 0.00712562C46.818 -0.00431848 46.8228 -0.00808311 46.8184 -0.00463784C46.8096 0.00228345 46.764 0.0378652 46.6828 0.0983779C46.5199 0.219675 46.2165 0.439161 45.7812 0.727519C44.9072 1.30663 43.5257 2.14765 41.7061 3.02677C38.0469 4.79468 32.7981 6.63058 26.4253 6.95109L27.5746 29.7793ZM54 8.88887C50.2691 -1.91433 50.27 -1.91467 50.271 -1.91498C50.2712 -1.91506 50.272 -1.91535 50.2724 -1.9155C50.2733 -1.91581 50.274 -1.91602 50.2743 -1.91616C50.2752 -1.91643 50.275 -1.91636 50.2738 -1.91595C50.2714 -1.91515 50.2652 -1.91302 50.2552 -1.9096C50.2351 -1.90276 50.1999 -1.89078 50.1503 -1.874C50.0509 -1.84043 49.8938 -1.78773 49.6844 -1.71863C49.2652 -1.58031 48.6387 -1.377 47.8481 -1.13035C46.2609 -0.635237 44.0427 0.0249875 41.5325 0.6823C36.215 2.07471 30.6736 3.15796 27 3.15796V26.0151C33.8087 26.0151 41.7672 24.2495 47.3292 22.7931C50.2586 22.026 52.825 21.2618 54.6625 20.6886C55.5842 20.4011 56.33 20.1593 56.8551 19.986C57.1178 19.8993 57.3258 19.8296 57.4735 19.7797C57.5474 19.7548 57.6062 19.7348 57.6493 19.72C57.6709 19.7127 57.6885 19.7066 57.7021 19.7019C57.7089 19.6996 57.7147 19.6976 57.7195 19.696C57.7219 19.6952 57.7241 19.6944 57.726 19.6938C57.7269 19.6934 57.7281 19.693 57.7286 19.6929C57.7298 19.6924 57.7309 19.692 54 8.88887ZM27 3.15796C23.3263 3.15796 17.7849 2.07471 12.4674 0.6823C9.95717 0.0249875 7.73904 -0.635237 6.15184 -1.13035C5.36118 -1.377 4.73467 -1.58031 4.3155 -1.71863C4.10609 -1.78773 3.94899 -1.84043 3.84961 -1.874C3.79994 -1.89078 3.76474 -1.90276 3.74471 -1.9096C3.73469 -1.91302 3.72848 -1.91515 3.72613 -1.91595C3.72496 -1.91636 3.72476 -1.91643 3.72554 -1.91616C3.72593 -1.91602 3.72657 -1.91581 3.72745 -1.9155C3.72789 -1.91535 3.72874 -1.91506 3.72896 -1.91498C3.72987 -1.91467 3.73084 -1.91433 -4.673e-05 8.88887C-3.73093 19.692 -3.72983 19.6924 -3.72868 19.6929C-3.72821 19.693 -3.72698 19.6934 -3.72603 19.6938C-3.72415 19.6944 -3.72201 19.6952 -3.71961 19.696C-3.71482 19.6976 -3.70901 19.6996 -3.7022 19.7019C-3.68858 19.7066 -3.67095 19.7127 -3.6494 19.72C-3.60629 19.7348 -3.54745 19.7548 -3.47359 19.7797C-3.32589 19.8296 -3.11788 19.8993 -2.85516 19.986C-2.33008 20.1593 -1.58425 20.4011 -0.662589 20.6886C1.17485 21.2618 3.74125 22.026 6.67073 22.7931C12.2327 24.2495 20.1913 26.0151 27 26.0151V3.15796Z","fill","var(--primary-color)"],[1,"font-medium","text-3xl","text-surface-900","dark:text-surface-0"],[1,"col-span-12","md:col-span-10"],[1,"grid","grid-cols-12","gap-8","text-center","md:text-left"],[1,"col-span-12","md:col-span-3"],[1,"font-medium","text-2xl","leading-normal","mb-6","text-surface-900","dark:text-surface-0"],[1,"leading-normal","text-xl","block","cursor-pointer","mb-2","text-surface-700","dark:text-surface-100"],[1,"leading-normal","text-xl","block","cursor-pointer","text-surface-700","dark:text-surface-100"],["src","https://primefaces.org/cdn/templates/sakai/landing/new-badge.svg","alt","badge",1,"ml-2"]],template:function(t,n){t&1&&(g(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),Fe("click",function(){return n.router.navigate(["/pages/landing"],{fragment:"home"})}),yr(),g(4,"svg",4),V(5,"path",5),g(6,"mask",6),V(7,"path",7),y(),g(8,"g",8),V(9,"path",9),y()(),_r(),g(10,"h4",10),b(11,"SAKAI"),y()()(),g(12,"div",11)(13,"div",12)(14,"div",13)(15,"h4",14),b(16,"Company"),y(),g(17,"a",15),b(18,"About Us"),y(),g(19,"a",15),b(20,"News"),y(),g(21,"a",15),b(22,"Investor Relations"),y(),g(23,"a",15),b(24,"Careers"),y(),g(25,"a",16),b(26,"Media Kit"),y()(),g(27,"div",13)(28,"h4",14),b(29,"Resources"),y(),g(30,"a",15),b(31,"Get Started"),y(),g(32,"a",15),b(33,"Learn"),y(),g(34,"a",16),b(35,"Case Studies"),y()(),g(36,"div",13)(37,"h4",14),b(38,"Community"),y(),g(39,"a",15),b(40,"Discord"),y(),g(41,"a",15),b(42,"Events"),V(43,"img",17),y(),g(44,"a",15),b(45,"FAQ"),y(),g(46,"a",16),b(47,"Blog"),y()(),g(48,"div",13)(49,"h4",14),b(50,"Legal"),y(),g(51,"a",15),b(52,"Brand Policy"),y(),g(53,"a",15),b(54,"Privacy Policy"),y(),g(55,"a",16),b(56,"Terms of Service"),y()()()()()())},dependencies:[Ve],encapsulation:2})};var ko=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=X({type:r,selectors:[["app-landing"]],decls:8,vars:0,consts:[[1,"bg-surface-0","dark:bg-surface-900"],["id","home",1,"landing-wrapper","overflow-hidden"],[1,"py-6","px-6","mx-0","md:mx-12","lg:mx-20","lg:px-20","flex","items-center","justify-between","relative","lg:static"]],template:function(t,n){t&1&&(g(0,"div",0)(1,"div",1),V(2,"topbar-widget",2)(3,"hero-widget")(4,"features-widget")(5,"highlights-widget")(6,"pricing-widget")(7,"footer-widget"),y()())},dependencies:[Ve,So,Ao,xo,Co,Ro,Po,st,Er,ze,uo],encapsulation:2})};var Do=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=X({type:r,selectors:[["app-notfound"]],decls:42,vars:0,consts:[[1,"flex","items-center","justify-center","min-h-screen","overflow-hidden"],[1,"flex","flex-col","items-center","justify-center"],["width","54","height","40","viewBox","0 0 54 40","fill","none","xmlns","http://www.w3.org/2000/svg",1,"mb-8","w-32","shrink-0"],["fill-rule","evenodd","clip-rule","evenodd","d","M17.1637 19.2467C17.1566 19.4033 17.1529 19.561 17.1529 19.7194C17.1529 25.3503 21.7203 29.915 27.3546 29.915C32.9887 29.915 37.5561 25.3503 37.5561 19.7194C37.5561 19.5572 37.5524 19.3959 37.5449 19.2355C38.5617 19.0801 39.5759 18.9013 40.5867 18.6994L40.6926 18.6782C40.7191 19.0218 40.7326 19.369 40.7326 19.7194C40.7326 27.1036 34.743 33.0896 27.3546 33.0896C19.966 33.0896 13.9765 27.1036 13.9765 19.7194C13.9765 19.374 13.9896 19.0316 14.0154 18.6927L14.0486 18.6994C15.0837 18.9062 16.1223 19.0886 17.1637 19.2467ZM33.3284 11.4538C31.6493 10.2396 29.5855 9.52381 27.3546 9.52381C25.1195 9.52381 23.0524 10.2421 21.3717 11.4603C20.0078 11.3232 18.6475 11.1387 17.2933 10.907C19.7453 8.11308 23.3438 6.34921 27.3546 6.34921C31.36 6.34921 34.9543 8.10844 37.4061 10.896C36.0521 11.1292 34.692 11.3152 33.3284 11.4538ZM43.826 18.0518C43.881 18.6003 43.9091 19.1566 43.9091 19.7194C43.9091 28.8568 36.4973 36.2642 27.3546 36.2642C18.2117 36.2642 10.8 28.8568 10.8 19.7194C10.8 19.1615 10.8276 18.61 10.8816 18.0663L7.75383 17.4411C7.66775 18.1886 7.62354 18.9488 7.62354 19.7194C7.62354 30.6102 16.4574 39.4388 27.3546 39.4388C38.2517 39.4388 47.0855 30.6102 47.0855 19.7194C47.0855 18.9439 47.0407 18.1789 46.9536 17.4267L43.826 18.0518ZM44.2613 9.54743L40.9084 10.2176C37.9134 5.95821 32.9593 3.1746 27.3546 3.1746C21.7442 3.1746 16.7856 5.96385 13.7915 10.2305L10.4399 9.56057C13.892 3.83178 20.1756 0 27.3546 0C34.5281 0 40.8075 3.82591 44.2613 9.54743Z","fill","var(--primary-color)"],["id","mask0_1413_1551","maskUnits","userSpaceOnUse","x","0","y","8","width","54","height","11",2,"mask-type","alpha"],["d","M27 18.3652C10.5114 19.1944 0 8.88892 0 8.88892C0 8.88892 16.5176 14.5866 27 14.5866C37.4824 14.5866 54 8.88892 54 8.88892C54 8.88892 43.4886 17.5361 27 18.3652Z","fill","var(--primary-color)"],["mask","url(#mask0_1413_1551)"],["d","M-4.673e-05 8.88887L3.73084 -1.91434L-8.00806 17.0473L-4.673e-05 8.88887ZM27 18.3652L26.4253 6.95109L27 18.3652ZM54 8.88887L61.2673 17.7127L50.2691 -1.91434L54 8.88887ZM-4.673e-05 8.88887C-8.00806 17.0473 -8.00469 17.0505 -8.00132 17.0538C-8.00018 17.055 -7.99675 17.0583 -7.9944 17.0607C-7.98963 17.0653 -7.98474 17.0701 -7.97966 17.075C-7.96949 17.0849 -7.95863 17.0955 -7.94707 17.1066C-7.92401 17.129 -7.89809 17.1539 -7.86944 17.1812C-7.8122 17.236 -7.74377 17.3005 -7.66436 17.3743C-7.50567 17.5218 -7.30269 17.7063 -7.05645 17.9221C-6.56467 18.3532 -5.89662 18.9125 -5.06089 19.5534C-3.39603 20.83 -1.02575 22.4605 1.98012 24.0457C7.97874 27.2091 16.7723 30.3226 27.5746 29.7793L26.4253 6.95109C20.7391 7.23699 16.0326 5.61231 12.6534 3.83024C10.9703 2.94267 9.68222 2.04866 8.86091 1.41888C8.45356 1.10653 8.17155 0.867278 8.0241 0.738027C7.95072 0.673671 7.91178 0.637576 7.90841 0.634492C7.90682 0.63298 7.91419 0.639805 7.93071 0.65557C7.93897 0.663455 7.94952 0.673589 7.96235 0.686039C7.96883 0.692262 7.97582 0.699075 7.98338 0.706471C7.98719 0.710167 7.99113 0.714014 7.99526 0.718014C7.99729 0.720008 8.00047 0.723119 8.00148 0.724116C8.00466 0.727265 8.00796 0.730446 -4.673e-05 8.88887ZM27.5746 29.7793C37.6904 29.2706 45.9416 26.3684 51.6602 23.6054C54.5296 22.2191 56.8064 20.8465 58.4186 19.7784C59.2265 19.2431 59.873 18.7805 60.3494 18.4257C60.5878 18.2482 60.7841 18.0971 60.9374 17.977C61.014 17.9169 61.0799 17.8645 61.1349 17.8203C61.1624 17.7981 61.1872 17.7781 61.2093 17.7602C61.2203 17.7512 61.2307 17.7427 61.2403 17.7348C61.2452 17.7308 61.2499 17.727 61.2544 17.7233C61.2566 17.7215 61.2598 17.7188 61.261 17.7179C61.2642 17.7153 61.2673 17.7127 54 8.88887C46.7326 0.0650536 46.7357 0.0625219 46.7387 0.0600241C46.7397 0.0592345 46.7427 0.0567658 46.7446 0.0551857C46.7485 0.0520238 46.7521 0.0489887 46.7557 0.0460799C46.7628 0.0402623 46.7694 0.0349487 46.7753 0.0301318C46.7871 0.0204986 46.7966 0.0128495 46.8037 0.00712562C46.818 -0.00431848 46.8228 -0.00808311 46.8184 -0.00463784C46.8096 0.00228345 46.764 0.0378652 46.6828 0.0983779C46.5199 0.219675 46.2165 0.439161 45.7812 0.727519C44.9072 1.30663 43.5257 2.14765 41.7061 3.02677C38.0469 4.79468 32.7981 6.63058 26.4253 6.95109L27.5746 29.7793ZM54 8.88887C50.2691 -1.91433 50.27 -1.91467 50.271 -1.91498C50.2712 -1.91506 50.272 -1.91535 50.2724 -1.9155C50.2733 -1.91581 50.274 -1.91602 50.2743 -1.91616C50.2752 -1.91643 50.275 -1.91636 50.2738 -1.91595C50.2714 -1.91515 50.2652 -1.91302 50.2552 -1.9096C50.2351 -1.90276 50.1999 -1.89078 50.1503 -1.874C50.0509 -1.84043 49.8938 -1.78773 49.6844 -1.71863C49.2652 -1.58031 48.6387 -1.377 47.8481 -1.13035C46.2609 -0.635237 44.0427 0.0249875 41.5325 0.6823C36.215 2.07471 30.6736 3.15796 27 3.15796V26.0151C33.8087 26.0151 41.7672 24.2495 47.3292 22.7931C50.2586 22.026 52.825 21.2618 54.6625 20.6886C55.5842 20.4011 56.33 20.1593 56.8551 19.986C57.1178 19.8993 57.3258 19.8296 57.4735 19.7797C57.5474 19.7548 57.6062 19.7348 57.6493 19.72C57.6709 19.7127 57.6885 19.7066 57.7021 19.7019C57.7089 19.6996 57.7147 19.6976 57.7195 19.696C57.7219 19.6952 57.7241 19.6944 57.726 19.6938C57.7269 19.6934 57.7281 19.693 57.7286 19.6929C57.7298 19.6924 57.7309 19.692 54 8.88887ZM27 3.15796C23.3263 3.15796 17.7849 2.07471 12.4674 0.6823C9.95717 0.0249875 7.73904 -0.635237 6.15184 -1.13035C5.36118 -1.377 4.73467 -1.58031 4.3155 -1.71863C4.10609 -1.78773 3.94899 -1.84043 3.84961 -1.874C3.79994 -1.89078 3.76474 -1.90276 3.74471 -1.9096C3.73469 -1.91302 3.72848 -1.91515 3.72613 -1.91595C3.72496 -1.91636 3.72476 -1.91643 3.72554 -1.91616C3.72593 -1.91602 3.72657 -1.91581 3.72745 -1.9155C3.72789 -1.91535 3.72874 -1.91506 3.72896 -1.91498C3.72987 -1.91467 3.73084 -1.91433 -4.673e-05 8.88887C-3.73093 19.692 -3.72983 19.6924 -3.72868 19.6929C-3.72821 19.693 -3.72698 19.6934 -3.72603 19.6938C-3.72415 19.6944 -3.72201 19.6952 -3.71961 19.696C-3.71482 19.6976 -3.70901 19.6996 -3.7022 19.7019C-3.68858 19.7066 -3.67095 19.7127 -3.6494 19.72C-3.60629 19.7348 -3.54745 19.7548 -3.47359 19.7797C-3.32589 19.8296 -3.11788 19.8993 -2.85516 19.986C-2.33008 20.1593 -1.58425 20.4011 -0.662589 20.6886C1.17485 21.2618 3.74125 22.026 6.67073 22.7931C12.2327 24.2495 20.1913 26.0151 27 26.0151V3.15796Z","fill","var(--primary-color)"],[2,"border-radius","56px","padding","0.3rem","background","linear-gradient(180deg, color-mix(in srgb, var(--primary-color), transparent 60%) 10%, var(--surface-ground) 30%)"],[1,"w-full","bg-surface-0","dark:bg-surface-900","py-20","px-8","sm:px-20","flex","flex-col","items-center",2,"border-radius","53px"],[1,"text-primary","font-bold","text-3xl"],[1,"text-surface-900","dark:text-surface-0","font-bold","text-3xl","lg:text-5xl","mb-2"],[1,"text-surface-600","dark:text-surface-200","mb-8"],["routerLink","/",1,"w-full","flex","items-center","py-8","border-surface-300","dark:border-surface-500","border-b"],[1,"flex","justify-center","items-center","border-2","border-primary","text-primary","rounded-border",2,"height","3.5rem","width","3.5rem"],[1,"pi","pi-fw","pi-table","!text-2xl"],[1,"ml-6","flex","flex-col"],[1,"text-surface-900","dark:text-surface-0","lg:text-xl","font-medium","mb-0","block"],[1,"text-surface-600","dark:text-surface-200","lg:text-xl"],[1,"pi","pi-fw","pi-question-circle","!text-2xl"],[1,"text-surface-900","dark:text-surface-0","lg:text-xl","font-medium","mb-0"],["routerLink","/",1,"w-full","flex","items-center","mb-8","py-8","border-surface-300","dark:border-surface-500","border-b"],[1,"pi","pi-fw","pi-unlock","!text-2xl"],["label","Go to Dashboard","routerLink","/"]],template:function(t,n){t&1&&(V(0,"app-floating-configurator"),g(1,"div",0)(2,"div",1),yr(),g(3,"svg",2),V(4,"path",3),g(5,"mask",4),V(6,"path",5),y(),g(7,"g",6),V(8,"path",7),y()(),_r(),g(9,"div",8)(10,"div",9)(11,"span",10),b(12,"404"),y(),g(13,"h1",11),b(14,"Not Found"),y(),g(15,"div",12),b(16,"Requested resource is not available."),y(),g(17,"a",13)(18,"span",14),V(19,"i",15),y(),g(20,"span",16)(21,"span",17),b(22,"Frequently Asked Questions"),y(),g(23,"span",18),b(24,"Ultricies mi quis hendrerit dolor."),y()()(),g(25,"a",13)(26,"span",14),V(27,"i",19),y(),g(28,"span",16)(29,"span",20),b(30,"Solution Center"),y(),g(31,"span",18),b(32,"Phasellus faucibus scelerisque eleifend."),y()()(),g(33,"a",21)(34,"span",14),V(35,"i",22),y(),g(36,"span",16)(37,"span",20),b(38,"Permission Manager"),y(),g(39,"span",18),b(40,"Accumsan in nisl nisi scelerisque"),y()()(),V(41,"p-button",23),y()()()())},dependencies:[Ve,nn,Ef,ze,df],encapsulation:2})};var kf=[{path:"",component:_o,children:[{path:"",component:bo},{path:"uikit",loadChildren:()=>import("./chunk-BCGX2SSG.js")},{path:"documentation",component:vf},{path:"pages",loadChildren:()=>import("./chunk-QQP25YGI.js")}]},{path:"landing",component:ko},{path:"notfound",component:Do},{path:"auth",loadChildren:()=>import("./chunk-D5EXCS6D.js")},{path:"**",redirectTo:"/notfound"}];var ky="firebase",Dy="11.9.1";If(ky,Dy,"app");var Vy="firebase",Ny="10.14.1";rn(Vy,Ny,"app");var Fi=new $m("ANGULARFIRE2_VERSION");var My=(r,e)=>{let t=e?[e]:Rf(),n=[];return t.forEach(i=>{i.container.getProvider(r).instances.forEach(a=>{n.includes(a)||n.push(a)})}),n},Ln=class{constructor(){return My(Fy)}},Fy="app-check";function Yl(){}var Vo=class{zone;delegate;constructor(e,t=Em){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,n){let i=this.zone,s=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,t,n)}},Xl=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Yl,{},Yl,Yl)),t.pipe(Am({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},No=(()=>{class r{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Vo(Zone.current)),this.insideAngular=t.run(()=>new Vo(Zone.current,Gs)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(n){return new(n||r)(re(yt))};static \u0275prov=en({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();function Oy(){let r=globalThis.\u0275AngularFireScheduler;if(!r)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return r}function Ze(r){return Ly(Oy())(r)}function Ly(r){return function(t){return t=t.lift(new Xl(r.ngZone)),t.pipe(gr(r.outsideAngular),kn(r.insideAngular))}}var qy="firebase",By="10.14.1";nt.registerVersion(qy,By,"app-compat");var Uy=["ngOnDestroy"],Nf=(r,e,t,n={})=>new Proxy(r,{get:(i,s)=>t.runOutsideAngular(()=>{if(r[s])return n?.spy?.get&&n.spy.get(s,r[s]),r[s];if(Uy.indexOf(s)>-1)return()=>{};let a=e.toPromise().then(l=>{let u=l?.[s];return typeof u=="function"?u.bind(l):u?.then?u.then(d=>t.run(()=>d)):t.run(()=>u)});return new Proxy(()=>{},{get:(l,u)=>a[u],apply:(l,u,d)=>a.then(m=>{let p=m?.(...d);return n?.spy?.apply&&n.spy.apply(s,d,p),p})})})});var Mo=class{constructor(e){return e}},br=new Me("angularfire2.app.options"),Sr=new Me("angularfire2.app.name");function Oi(r,e,t){let n=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||n;let a=nt.apps.filter(l=>l&&l.name===i.name)[0]||e.runOutsideAngular(()=>nt.initializeApp(r,i));try{if(JSON.stringify(r)!==JSON.stringify(a.options)){let l=!!module.hot;jy("error",`${a.name} Firebase App already initialized with different options${l?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Mo(a)}var jy=(r,...e)=>{Gl()&&typeof console<"u"&&console[r](...e)},Gy={provide:Mo,useFactory:Oi,deps:[br,yt,[new Cm,Sr]]},Mf=(()=>{class r{static initializeApp(t,n){return{ngModule:r,providers:[{provide:br,useValue:t},{provide:Sr,useValue:n}]}}constructor(t){nt.registerVersion("angularfire",Fi.full,"core"),nt.registerVersion("angularfire",Fi.full,"app-compat"),nt.registerVersion("angular",Wm.full,t.toString())}static \u0275fac=function(n){return new(n||r)(re(vr))};static \u0275mod=Hs({type:r});static \u0275inj=Ws({providers:[Gy]})}return r})();function Fo(r,e,t,n,i){let[,s,a]=globalThis.\u0275AngularfireInstanceCache.find(l=>l[0]===r)||[];if(s)return zy(i,a)||(Vf("error",`${e} was already initialized on the ${t} Firebase App with different settings.${Ky?" You may need to reload as Firebase is not HMR aware.":""}`),Vf("warn",{is:i,was:a})),s;{let l=n();return globalThis.\u0275AngularfireInstanceCache.push([r,l,i]),l}}function zy(r,e){try{return r.toString()===e.toString()}catch{return r===e}}var Ky=typeof module<"u"&&!!module.hot,Vf=(r,...e)=>{Gl()&&typeof console<"u"&&console[r](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Qy=new Map,Hy={activated:!1,tokenObservers:[]},Jy={initialized:!1,enabled:!1};function ht(r){return Qy.get(r)||Object.assign({},Hy)}function Bf(){return Jy}var Yy="https://content-firebaseappcheck.googleapis.com/v1";var Xy="exchangeDebugToken",Ff={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},sT=24*60*60*1e3;var eu=class{constructor(e,t,n,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return D(this,null,function*(){this.stop();try{this.pending=new $l,this.pending.promise.catch(t=>{}),yield Zy(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new $l,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function Zy(r){return new Promise(e=>{setTimeout(e,r)})}var e_={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},sn=new xf("appCheck","AppCheck",e_);function Uf(r){if(!ht(r).activated)throw sn.create("use-before-activation",{appName:r.name})}function jf(n,i){return D(this,arguments,function*({url:r,body:e},t){let s={"Content-Type":"application/json"},a=t.getImmediate({optional:!0});if(a){let x=yield a.getHeartbeatsHeader();x&&(s["X-Firebase-Client"]=x)}let l={method:"POST",body:JSON.stringify(e),headers:s},u;try{u=yield fetch(r,l)}catch(x){throw sn.create("fetch-network-error",{originalErrorMessage:x?.message})}if(u.status!==200)throw sn.create("fetch-status-error",{httpStatus:u.status});let d;try{d=yield u.json()}catch(x){throw sn.create("fetch-parse-error",{originalErrorMessage:x?.message})}let m=d.ttl.match(/^([\d.]+)(s)$/);if(!m||!m[2]||isNaN(Number(m[1])))throw sn.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});let p=Number(m[1])*1e3,v=Date.now();return{token:d.token,expireTimeMillis:v+p,issuedAtTimeMillis:v}})}function Gf(r,e){let{projectId:t,appId:n,apiKey:i}=r.options;return{url:`${Yy}/projects/${t}/apps/${n}:${Xy}?key=${i}`,body:{debug_token:e}}}var t_="firebase-app-check-database",n_=1,tu="firebase-app-check-store";var Oo=null;function r_(){return Oo||(Oo=new Promise((r,e)=>{try{let t=indexedDB.open(t_,n_);t.onsuccess=n=>{r(n.target.result)},t.onerror=n=>{var i;e(sn.create("storage-open",{originalErrorMessage:(i=n.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=n=>{let i=n.target.result;switch(n.oldVersion){case 0:i.createObjectStore(tu,{keyPath:"compositeKey"})}}}catch(t){e(sn.create("storage-open",{originalErrorMessage:t?.message}))}}),Oo)}function i_(r,e){return s_(o_(r),e)}function s_(r,e){return D(this,null,function*(){let n=(yield r_()).transaction(tu,"readwrite"),s=n.objectStore(tu).put({compositeKey:r,value:e});return new Promise((a,l)=>{s.onsuccess=u=>{a()},n.onerror=u=>{var d;l(sn.create("storage-set",{originalErrorMessage:(d=u.target.error)===null||d===void 0?void 0:d.message}))}})})}function o_(r){return`${r.options.appId}-${r.name}`}var nu=new ho("@firebase/app-check");function Zl(r,e){return co()?i_(r,e).catch(t=>{nu.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function zf(){return Bf().enabled}function Kf(){return D(this,null,function*(){let r=Bf();if(r.enabled&&r.token)return r.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var a_={error:"UNKNOWN_ERROR"};function l_(r){return bf.encodeString(JSON.stringify(r),!1)}function ru(r,e=!1){return D(this,null,function*(){let t=r.app;Uf(t);let n=ht(t),i=n.token,s;if(i&&!Li(i)&&(n.token=void 0,i=void 0),!i){let u=yield n.cachedTokenPromise;u&&(Li(u)?i=u:yield Zl(t,void 0))}if(!e&&i&&Li(i))return{token:i.token};let a=!1;if(zf()){n.exchangeTokenPromise||(n.exchangeTokenPromise=jf(Gf(t,yield Kf()),r.heartbeatServiceProvider).finally(()=>{n.exchangeTokenPromise=void 0}),a=!0);let u=yield n.exchangeTokenPromise;return yield Zl(t,u),n.token=u,{token:u.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().finally(()=>{n.exchangeTokenPromise=void 0}),a=!0),i=yield ht(t).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"?nu.warn(u.message):nu.error(u),s=u}let l;return i?s?Li(i)?l={token:i.token,internalError:s}:l=Lf(s):(l={token:i.token},n.token=i,yield Zl(t,i)):l=Lf(s),a&&d_(t,l),l})}function u_(r){return D(this,null,function*(){let e=r.app;Uf(e);let{provider:t}=ht(e);if(zf()){let n=yield Kf(),{token:i}=yield jf(Gf(e,n),r.heartbeatServiceProvider);return{token:i}}else{let{token:n}=yield t.getToken();return{token:n}}})}function c_(r,e,t,n){let{app:i}=r,s=ht(i),a={next:t,error:n,type:e};if(s.tokenObservers=[...s.tokenObservers,a],s.token&&Li(s.token)){let l=s.token;Promise.resolve().then(()=>{t({token:l.token}),Of(r)}).catch(()=>{})}s.cachedTokenPromise.then(()=>Of(r))}function $f(r,e){let t=ht(r),n=t.tokenObservers.filter(i=>i.next!==e);n.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=n}function Of(r){let{app:e}=r,t=ht(e),n=t.tokenRefresher;n||(n=h_(r),t.tokenRefresher=n),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function h_(r){let{app:e}=r;return new eu(()=>D(this,null,function*(){let t=ht(e),n;if(t.token?n=yield ru(r,!0):n=yield ru(r),n.error)throw n.error;if(n.internalError)throw n.internalError}),()=>!0,()=>{let t=ht(e);if(t.token){let n=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return n=Math.min(n,i),Math.max(0,n-Date.now())}else return 0},Ff.RETRIAL_MIN_WAIT,Ff.RETRIAL_MAX_WAIT)}function d_(r,e){let t=ht(r).tokenObservers;for(let n of t)try{n.type==="EXTERNAL"&&e.error!=null?n.error(e.error):n.next(e)}catch{}}function Li(r){return r.expireTimeMillis-Date.now()>0}function Lf(r){return{token:l_(a_),error:r}}var iu=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=ht(this.app);for(let t of e)$f(this.app,t.next);return Promise.resolve()}};function m_(r,e){return new iu(r,e)}function f_(r){return{getToken:e=>ru(r,e),getLimitedUseToken:()=>u_(r),addTokenListener:e=>c_(r,"INTERNAL",e),removeTokenListener:e=>$f(r.app,e)}}var p_="@firebase/app-check",g_="0.8.8";var y_="app-check",qf="app-check-internal";function __(){Vi(new On(y_,r=>{let e=r.getProvider("app").getImmediate(),t=r.getProvider("heartbeat");return m_(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((r,e,t)=>{r.getProvider(qf).initialize()})),Vi(new On(qf,r=>{let e=r.getProvider("app-check").getImmediate();return f_(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),rn(p_,g_)}__();var v_=["localhost","0.0.0.0","127.0.0.1"],yT=typeof window<"u"&&v_.includes(window.location.hostname);var su=new Me("angularfire2.auth.use-emulator"),ou=new Me("angularfire2.auth.settings"),au=new Me("angularfire2.auth.tenant-id"),lu=new Me("angularfire2.auth.langugage-code"),uu=new Me("angularfire2.auth.use-device-language"),cu=new Me("angularfire.auth.persistence"),hu=(r,e,t,n,i,s,a,l)=>Fo(`${r.name}.auth`,"AngularFireAuth",r.name,()=>{let u=e.runOutsideAngular(()=>r.auth());if(t&&u.useEmulator(...t),n&&(u.tenantId=n),u.languageCode=i,s&&u.useDeviceLanguage(),a)for(let[d,m]of Object.entries(a))u.settings[d]=m;return l&&u.setPersistence(l),u},[t,n,i,s,a,l]),Qf=(()=>{class r{authState;idToken;user;idTokenResult;credential;constructor(t,n,i,s,a,l,u,d,m,p,v,x){let F=new wm,L=Zt(void 0).pipe(kn(a.outsideAngular),Dn(()=>s.runOutsideAngular(()=>import("./chunk-WJOJVVWO.js"))),He(()=>Oi(t,s,n)),He(N=>hu(N,s,l,d,m,p,u,v)),Ml({bufferSize:1,refCount:!1}));if(no(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=Zt(null);else{L.pipe(Sm()).subscribe();let N=L.pipe(Dn(B=>B.getRedirectResult().then(Q=>Q,()=>null)),Ze,Ml({bufferSize:1,refCount:!1})),$=L.pipe(Dn(B=>new pr(Q=>({unsubscribe:s.runOutsideAngular(()=>B.onAuthStateChanged(J=>Q.next(J),J=>Q.error(J),()=>Q.complete()))})))),W=L.pipe(Dn(B=>new pr(Q=>({unsubscribe:s.runOutsideAngular(()=>B.onIdTokenChanged(J=>Q.next(J),J=>Q.error(J),()=>Q.complete()))}))));this.authState=N.pipe(Fl($),gr(a.outsideAngular),kn(a.insideAngular)),this.user=N.pipe(Fl(W),gr(a.outsideAngular),kn(a.insideAngular)),this.idToken=this.user.pipe(Dn(B=>B?Xt(B.getIdToken()):Zt(null))),this.idTokenResult=this.user.pipe(Dn(B=>B?Xt(B.getIdTokenResult()):Zt(null))),this.credential=Tm(N,F,this.authState.pipe(Ft(B=>!B))).pipe(He(B=>B?.user?B:null),gr(a.outsideAngular),kn(a.insideAngular))}return Nf(this,L,s,{spy:{apply:(N,$,W)=>{(N.startsWith("signIn")||N.startsWith("createUser"))&&W.then(B=>F.next(B))}}})}static \u0275fac=function(n){return new(n||r)(re(br),re(Sr,8),re(vr),re(yt),re(No),re(su,8),re(ou,8),re(au,8),re(lu,8),re(uu,8),re(cu,8),re(Ln,8))};static \u0275prov=en({token:r,factory:r.\u0275fac,providedIn:"any"})}return r})();var Hf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Jf={};var on,du;(function(){var r;function e(T,_){function E(){}E.prototype=_.prototype,T.D=_.prototype,T.prototype=new E,T.prototype.constructor=T,T.C=function(I,S,C){for(var w=Array(arguments.length-2),Vt=2;Vt<arguments.length;Vt++)w[Vt-2]=arguments[Vt];return _.prototype[S].apply(I,w)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,_,E){E||(E=0);var I=Array(16);if(typeof _=="string")for(var S=0;16>S;++S)I[S]=_.charCodeAt(E++)|_.charCodeAt(E++)<<8|_.charCodeAt(E++)<<16|_.charCodeAt(E++)<<24;else for(S=0;16>S;++S)I[S]=_[E++]|_[E++]<<8|_[E++]<<16|_[E++]<<24;_=T.g[0],E=T.g[1],S=T.g[2];var C=T.g[3],w=_+(C^E&(S^C))+I[0]+3614090360&4294967295;_=E+(w<<7&4294967295|w>>>25),w=C+(S^_&(E^S))+I[1]+3905402710&4294967295,C=_+(w<<12&4294967295|w>>>20),w=S+(E^C&(_^E))+I[2]+606105819&4294967295,S=C+(w<<17&4294967295|w>>>15),w=E+(_^S&(C^_))+I[3]+3250441966&4294967295,E=S+(w<<22&4294967295|w>>>10),w=_+(C^E&(S^C))+I[4]+4118548399&4294967295,_=E+(w<<7&4294967295|w>>>25),w=C+(S^_&(E^S))+I[5]+1200080426&4294967295,C=_+(w<<12&4294967295|w>>>20),w=S+(E^C&(_^E))+I[6]+2821735955&4294967295,S=C+(w<<17&4294967295|w>>>15),w=E+(_^S&(C^_))+I[7]+4249261313&4294967295,E=S+(w<<22&4294967295|w>>>10),w=_+(C^E&(S^C))+I[8]+1770035416&4294967295,_=E+(w<<7&4294967295|w>>>25),w=C+(S^_&(E^S))+I[9]+2336552879&4294967295,C=_+(w<<12&4294967295|w>>>20),w=S+(E^C&(_^E))+I[10]+4294925233&4294967295,S=C+(w<<17&4294967295|w>>>15),w=E+(_^S&(C^_))+I[11]+2304563134&4294967295,E=S+(w<<22&4294967295|w>>>10),w=_+(C^E&(S^C))+I[12]+1804603682&4294967295,_=E+(w<<7&4294967295|w>>>25),w=C+(S^_&(E^S))+I[13]+4254626195&4294967295,C=_+(w<<12&4294967295|w>>>20),w=S+(E^C&(_^E))+I[14]+2792965006&4294967295,S=C+(w<<17&4294967295|w>>>15),w=E+(_^S&(C^_))+I[15]+1236535329&4294967295,E=S+(w<<22&4294967295|w>>>10),w=_+(S^C&(E^S))+I[1]+4129170786&4294967295,_=E+(w<<5&4294967295|w>>>27),w=C+(E^S&(_^E))+I[6]+3225465664&4294967295,C=_+(w<<9&4294967295|w>>>23),w=S+(_^E&(C^_))+I[11]+643717713&4294967295,S=C+(w<<14&4294967295|w>>>18),w=E+(C^_&(S^C))+I[0]+3921069994&4294967295,E=S+(w<<20&4294967295|w>>>12),w=_+(S^C&(E^S))+I[5]+3593408605&4294967295,_=E+(w<<5&4294967295|w>>>27),w=C+(E^S&(_^E))+I[10]+38016083&4294967295,C=_+(w<<9&4294967295|w>>>23),w=S+(_^E&(C^_))+I[15]+3634488961&4294967295,S=C+(w<<14&4294967295|w>>>18),w=E+(C^_&(S^C))+I[4]+3889429448&4294967295,E=S+(w<<20&4294967295|w>>>12),w=_+(S^C&(E^S))+I[9]+568446438&4294967295,_=E+(w<<5&4294967295|w>>>27),w=C+(E^S&(_^E))+I[14]+3275163606&4294967295,C=_+(w<<9&4294967295|w>>>23),w=S+(_^E&(C^_))+I[3]+4107603335&4294967295,S=C+(w<<14&4294967295|w>>>18),w=E+(C^_&(S^C))+I[8]+1163531501&4294967295,E=S+(w<<20&4294967295|w>>>12),w=_+(S^C&(E^S))+I[13]+2850285829&4294967295,_=E+(w<<5&4294967295|w>>>27),w=C+(E^S&(_^E))+I[2]+4243563512&4294967295,C=_+(w<<9&4294967295|w>>>23),w=S+(_^E&(C^_))+I[7]+1735328473&4294967295,S=C+(w<<14&4294967295|w>>>18),w=E+(C^_&(S^C))+I[12]+2368359562&4294967295,E=S+(w<<20&4294967295|w>>>12),w=_+(E^S^C)+I[5]+4294588738&4294967295,_=E+(w<<4&4294967295|w>>>28),w=C+(_^E^S)+I[8]+2272392833&4294967295,C=_+(w<<11&4294967295|w>>>21),w=S+(C^_^E)+I[11]+1839030562&4294967295,S=C+(w<<16&4294967295|w>>>16),w=E+(S^C^_)+I[14]+4259657740&4294967295,E=S+(w<<23&4294967295|w>>>9),w=_+(E^S^C)+I[1]+2763975236&4294967295,_=E+(w<<4&4294967295|w>>>28),w=C+(_^E^S)+I[4]+1272893353&4294967295,C=_+(w<<11&4294967295|w>>>21),w=S+(C^_^E)+I[7]+4139469664&4294967295,S=C+(w<<16&4294967295|w>>>16),w=E+(S^C^_)+I[10]+3200236656&4294967295,E=S+(w<<23&4294967295|w>>>9),w=_+(E^S^C)+I[13]+681279174&4294967295,_=E+(w<<4&4294967295|w>>>28),w=C+(_^E^S)+I[0]+3936430074&4294967295,C=_+(w<<11&4294967295|w>>>21),w=S+(C^_^E)+I[3]+3572445317&4294967295,S=C+(w<<16&4294967295|w>>>16),w=E+(S^C^_)+I[6]+76029189&4294967295,E=S+(w<<23&4294967295|w>>>9),w=_+(E^S^C)+I[9]+3654602809&4294967295,_=E+(w<<4&4294967295|w>>>28),w=C+(_^E^S)+I[12]+3873151461&4294967295,C=_+(w<<11&4294967295|w>>>21),w=S+(C^_^E)+I[15]+530742520&4294967295,S=C+(w<<16&4294967295|w>>>16),w=E+(S^C^_)+I[2]+3299628645&4294967295,E=S+(w<<23&4294967295|w>>>9),w=_+(S^(E|~C))+I[0]+4096336452&4294967295,_=E+(w<<6&4294967295|w>>>26),w=C+(E^(_|~S))+I[7]+1126891415&4294967295,C=_+(w<<10&4294967295|w>>>22),w=S+(_^(C|~E))+I[14]+2878612391&4294967295,S=C+(w<<15&4294967295|w>>>17),w=E+(C^(S|~_))+I[5]+4237533241&4294967295,E=S+(w<<21&4294967295|w>>>11),w=_+(S^(E|~C))+I[12]+1700485571&4294967295,_=E+(w<<6&4294967295|w>>>26),w=C+(E^(_|~S))+I[3]+2399980690&4294967295,C=_+(w<<10&4294967295|w>>>22),w=S+(_^(C|~E))+I[10]+4293915773&4294967295,S=C+(w<<15&4294967295|w>>>17),w=E+(C^(S|~_))+I[1]+2240044497&4294967295,E=S+(w<<21&4294967295|w>>>11),w=_+(S^(E|~C))+I[8]+1873313359&4294967295,_=E+(w<<6&4294967295|w>>>26),w=C+(E^(_|~S))+I[15]+4264355552&4294967295,C=_+(w<<10&4294967295|w>>>22),w=S+(_^(C|~E))+I[6]+2734768916&4294967295,S=C+(w<<15&4294967295|w>>>17),w=E+(C^(S|~_))+I[13]+1309151649&4294967295,E=S+(w<<21&4294967295|w>>>11),w=_+(S^(E|~C))+I[4]+4149444226&4294967295,_=E+(w<<6&4294967295|w>>>26),w=C+(E^(_|~S))+I[11]+3174756917&4294967295,C=_+(w<<10&4294967295|w>>>22),w=S+(_^(C|~E))+I[2]+718787259&4294967295,S=C+(w<<15&4294967295|w>>>17),w=E+(C^(S|~_))+I[9]+3951481745&4294967295,T.g[0]=T.g[0]+_&4294967295,T.g[1]=T.g[1]+(S+(w<<21&4294967295|w>>>11))&4294967295,T.g[2]=T.g[2]+S&4294967295,T.g[3]=T.g[3]+C&4294967295}n.prototype.u=function(T,_){_===void 0&&(_=T.length);for(var E=_-this.blockSize,I=this.B,S=this.h,C=0;C<_;){if(S==0)for(;C<=E;)i(this,T,C),C+=this.blockSize;if(typeof T=="string"){for(;C<_;)if(I[S++]=T.charCodeAt(C++),S==this.blockSize){i(this,I),S=0;break}}else for(;C<_;)if(I[S++]=T[C++],S==this.blockSize){i(this,I),S=0;break}}this.h=S,this.o+=_},n.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var _=1;_<T.length-8;++_)T[_]=0;var E=8*this.o;for(_=T.length-8;_<T.length;++_)T[_]=E&255,E/=256;for(this.u(T),T=Array(16),_=E=0;4>_;++_)for(var I=0;32>I;I+=8)T[E++]=this.g[_]>>>I&255;return T};function s(T,_){var E=l;return Object.prototype.hasOwnProperty.call(E,T)?E[T]:E[T]=_(T)}function a(T,_){this.h=_;for(var E=[],I=!0,S=T.length-1;0<=S;S--){var C=T[S]|0;I&&C==_||(E[S]=C,I=!1)}this.g=E}var l={};function u(T){return-128<=T&&128>T?s(T,function(_){return new a([_|0],0>_?-1:0)}):new a([T|0],0>T?-1:0)}function d(T){if(isNaN(T)||!isFinite(T))return p;if(0>T)return N(d(-T));for(var _=[],E=1,I=0;T>=E;I++)_[I]=T/E|0,E*=4294967296;return new a(_,0)}function m(T,_){if(T.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(T.charAt(0)=="-")return N(m(T.substring(1),_));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=d(Math.pow(_,8)),I=p,S=0;S<T.length;S+=8){var C=Math.min(8,T.length-S),w=parseInt(T.substring(S,S+C),_);8>C?(C=d(Math.pow(_,C)),I=I.j(C).add(d(w))):(I=I.j(E),I=I.add(d(w)))}return I}var p=u(0),v=u(1),x=u(16777216);r=a.prototype,r.m=function(){if(L(this))return-N(this).m();for(var T=0,_=1,E=0;E<this.g.length;E++){var I=this.i(E);T+=(0<=I?I:4294967296+I)*_,_*=4294967296}return T},r.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(F(this))return"0";if(L(this))return"-"+N(this).toString(T);for(var _=d(Math.pow(T,6)),E=this,I="";;){var S=Q(E,_).g;E=$(E,S.j(_));var C=((0<E.g.length?E.g[0]:E.h)>>>0).toString(T);if(E=S,F(E))return C+I;for(;6>C.length;)C="0"+C;I=C+I}},r.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function F(T){if(T.h!=0)return!1;for(var _=0;_<T.g.length;_++)if(T.g[_]!=0)return!1;return!0}function L(T){return T.h==-1}r.l=function(T){return T=$(this,T),L(T)?-1:F(T)?0:1};function N(T){for(var _=T.g.length,E=[],I=0;I<_;I++)E[I]=~T.g[I];return new a(E,~T.h).add(v)}r.abs=function(){return L(this)?N(this):this},r.add=function(T){for(var _=Math.max(this.g.length,T.g.length),E=[],I=0,S=0;S<=_;S++){var C=I+(this.i(S)&65535)+(T.i(S)&65535),w=(C>>>16)+(this.i(S)>>>16)+(T.i(S)>>>16);I=w>>>16,C&=65535,w&=65535,E[S]=w<<16|C}return new a(E,E[E.length-1]&-2147483648?-1:0)};function $(T,_){return T.add(N(_))}r.j=function(T){if(F(this)||F(T))return p;if(L(this))return L(T)?N(this).j(N(T)):N(N(this).j(T));if(L(T))return N(this.j(N(T)));if(0>this.l(x)&&0>T.l(x))return d(this.m()*T.m());for(var _=this.g.length+T.g.length,E=[],I=0;I<2*_;I++)E[I]=0;for(I=0;I<this.g.length;I++)for(var S=0;S<T.g.length;S++){var C=this.i(I)>>>16,w=this.i(I)&65535,Vt=T.i(S)>>>16,mi=T.i(S)&65535;E[2*I+2*S]+=w*mi,W(E,2*I+2*S),E[2*I+2*S+1]+=C*mi,W(E,2*I+2*S+1),E[2*I+2*S+1]+=w*Vt,W(E,2*I+2*S+1),E[2*I+2*S+2]+=C*Vt,W(E,2*I+2*S+2)}for(I=0;I<_;I++)E[I]=E[2*I+1]<<16|E[2*I];for(I=_;I<2*_;I++)E[I]=0;return new a(E,0)};function W(T,_){for(;(T[_]&65535)!=T[_];)T[_+1]+=T[_]>>>16,T[_]&=65535,_++}function B(T,_){this.g=T,this.h=_}function Q(T,_){if(F(_))throw Error("division by zero");if(F(T))return new B(p,p);if(L(T))return _=Q(N(T),_),new B(N(_.g),N(_.h));if(L(_))return _=Q(T,N(_)),new B(N(_.g),_.h);if(30<T.g.length){if(L(T)||L(_))throw Error("slowDivide_ only works with positive integers.");for(var E=v,I=_;0>=I.l(T);)E=J(E),I=J(I);var S=Y(E,1),C=Y(I,1);for(I=Y(I,2),E=Y(E,2);!F(I);){var w=C.add(I);0>=w.l(T)&&(S=S.add(E),C=w),I=Y(I,1),E=Y(E,1)}return _=$(T,S.j(_)),new B(S,_)}for(S=p;0<=T.l(_);){for(E=Math.max(1,Math.floor(T.m()/_.m())),I=Math.ceil(Math.log(E)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),C=d(E),w=C.j(_);L(w)||0<w.l(T);)E-=I,C=d(E),w=C.j(_);F(C)&&(C=v),S=S.add(C),T=$(T,w)}return new B(S,T)}r.A=function(T){return Q(this,T).h},r.and=function(T){for(var _=Math.max(this.g.length,T.g.length),E=[],I=0;I<_;I++)E[I]=this.i(I)&T.i(I);return new a(E,this.h&T.h)},r.or=function(T){for(var _=Math.max(this.g.length,T.g.length),E=[],I=0;I<_;I++)E[I]=this.i(I)|T.i(I);return new a(E,this.h|T.h)},r.xor=function(T){for(var _=Math.max(this.g.length,T.g.length),E=[],I=0;I<_;I++)E[I]=this.i(I)^T.i(I);return new a(E,this.h^T.h)};function J(T){for(var _=T.g.length+1,E=[],I=0;I<_;I++)E[I]=T.i(I)<<1|T.i(I-1)>>>31;return new a(E,T.h)}function Y(T,_){var E=_>>5;_%=32;for(var I=T.g.length-E,S=[],C=0;C<I;C++)S[C]=0<_?T.i(C+E)>>>_|T.i(C+E+1)<<32-_:T.i(C+E);return new a(S,T.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,du=Jf.Md5=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=m,on=Jf.Integer=a}).apply(typeof Hf<"u"?Hf:typeof self<"u"?self:typeof window<"u"?window:{});var Lo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ot={};var mu,E_,Ar,fu,qi,qo,pu,gu,yu;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,c,h){return o==Array.prototype||o==Object.prototype||(o[c]=h.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Lo=="object"&&Lo];for(var c=0;c<o.length;++c){var h=o[c];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var n=t(this);function i(o,c){if(c)e:{var h=n;o=o.split(".");for(var f=0;f<o.length-1;f++){var A=o[f];if(!(A in h))break e;h=h[A]}o=o[o.length-1],f=h[o],c=c(f),c!=f&&c!=null&&e(h,o,{configurable:!0,writable:!0,value:c})}}function s(o,c){o instanceof String&&(o+="");var h=0,f=!1,A={next:function(){if(!f&&h<o.length){var P=h++;return{value:c(P,o[P]),done:!1}}return f=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(o){return o||function(){return s(this,function(c,h){return h})}});var a=a||{},l=this||self;function u(o){var c=typeof o;return c=c!="object"?c:o?Array.isArray(o)?"array":c:"null",c=="array"||c=="object"&&typeof o.length=="number"}function d(o){var c=typeof o;return c=="object"&&o!=null||c=="function"}function m(o,c,h){return o.call.apply(o.bind,arguments)}function p(o,c,h){if(!o)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,f),o.apply(c,A)}}return function(){return o.apply(c,arguments)}}function v(o,c,h){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:p,v.apply(null,arguments)}function x(o,c){var h=Array.prototype.slice.call(arguments,1);return function(){var f=h.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function F(o,c){function h(){}h.prototype=c.prototype,o.aa=c.prototype,o.prototype=new h,o.prototype.constructor=o,o.Qb=function(f,A,P){for(var q=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)q[ue-2]=arguments[ue];return c.prototype[A].apply(f,q)}}function L(o){let c=o.length;if(0<c){let h=Array(c);for(let f=0;f<c;f++)h[f]=o[f];return h}return[]}function N(o,c){for(let h=1;h<arguments.length;h++){let f=arguments[h];if(u(f)){let A=o.length||0,P=f.length||0;o.length=A+P;for(let q=0;q<P;q++)o[A+q]=f[q]}else o.push(f)}}class ${constructor(c,h){this.i=c,this.j=h,this.h=0,this.g=null}get(){let c;return 0<this.h?(this.h--,c=this.g,this.g=c.next,c.next=null):c=this.i(),c}}function W(o){return/^[\s\xa0]*$/.test(o)}function B(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function Q(o){return Q[" "](o),o}Q[" "]=function(){};var J=B().indexOf("Gecko")!=-1&&!(B().toLowerCase().indexOf("webkit")!=-1&&B().indexOf("Edge")==-1)&&!(B().indexOf("Trident")!=-1||B().indexOf("MSIE")!=-1)&&B().indexOf("Edge")==-1;function Y(o,c,h){for(let f in o)c.call(h,o[f],f,o)}function T(o,c){for(let h in o)c.call(void 0,o[h],h,o)}function _(o){let c={};for(let h in o)c[h]=o[h];return c}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(o,c){let h,f;for(let A=1;A<arguments.length;A++){f=arguments[A];for(h in f)o[h]=f[h];for(let P=0;P<E.length;P++)h=E[P],Object.prototype.hasOwnProperty.call(f,h)&&(o[h]=f[h])}}function S(o){var c=1;o=o.split(":");let h=[];for(;0<c&&o.length;)h.push(o.shift()),c--;return o.length&&h.push(o.join(":")),h}function C(o){l.setTimeout(()=>{throw o},0)}function w(){var o=ul;let c=null;return o.g&&(c=o.g,o.g=o.g.next,o.g||(o.h=null),c.next=null),c}class Vt{constructor(){this.h=this.g=null}add(c,h){let f=mi.get();f.set(c,h),this.h?this.h.next=f:this.g=f,this.h=f}}var mi=new $(()=>new k1,o=>o.reset());class k1{constructor(){this.next=this.g=this.h=null}set(c,h){this.h=c,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let fi,pi=!1,ul=new Vt,vd=()=>{let o=l.Promise.resolve(void 0);fi=()=>{o.then(D1)}};var D1=()=>{for(var o;o=w();){try{o.h.call(o.g)}catch(h){C(h)}var c=mi;c.j(o),100>c.h&&(c.h++,o.next=c.g,c.g=o)}pi=!1};function Wt(){this.s=this.s,this.C=this.C}Wt.prototype.s=!1,Wt.prototype.ma=function(){this.s||(this.s=!0,this.N())},Wt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function qe(o,c){this.type=o,this.g=this.target=c,this.defaultPrevented=!1}qe.prototype.h=function(){this.defaultPrevented=!0};var V1=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,c=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let h=()=>{};l.addEventListener("test",h,c),l.removeEventListener("test",h,c)}catch{}return o}();function gi(o,c){if(qe.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var h=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=c,c=o.relatedTarget){if(J){e:{try{Q(c.nodeName);var A=!0;break e}catch{}A=!1}A||(c=null)}}else h=="mouseover"?c=o.fromElement:h=="mouseout"&&(c=o.toElement);this.relatedTarget=c,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:N1[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&gi.aa.h.call(this)}}F(gi,qe);var N1={2:"touch",3:"pen",4:"mouse"};gi.prototype.h=function(){gi.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var yi="closure_listenable_"+(1e6*Math.random()|0),M1=0;function F1(o,c,h,f,A){this.listener=o,this.proxy=null,this.src=c,this.type=h,this.capture=!!f,this.ha=A,this.key=++M1,this.da=this.fa=!1}function As(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function xs(o){this.src=o,this.g={},this.h=0}xs.prototype.add=function(o,c,h,f,A){var P=o.toString();o=this.g[P],o||(o=this.g[P]=[],this.h++);var q=hl(o,c,f,A);return-1<q?(c=o[q],h||(c.fa=!1)):(c=new F1(c,this.src,P,!!f,A),c.fa=h,o.push(c)),c};function cl(o,c){var h=c.type;if(h in o.g){var f=o.g[h],A=Array.prototype.indexOf.call(f,c,void 0),P;(P=0<=A)&&Array.prototype.splice.call(f,A,1),P&&(As(c),o.g[h].length==0&&(delete o.g[h],o.h--))}}function hl(o,c,h,f){for(var A=0;A<o.length;++A){var P=o[A];if(!P.da&&P.listener==c&&P.capture==!!h&&P.ha==f)return A}return-1}var dl="closure_lm_"+(1e6*Math.random()|0),ml={};function wd(o,c,h,f,A){if(f&&f.once)return Td(o,c,h,f,A);if(Array.isArray(c)){for(var P=0;P<c.length;P++)wd(o,c[P],h,f,A);return null}return h=yl(h),o&&o[yi]?o.K(c,h,d(f)?!!f.capture:!!f,A):Ed(o,c,h,!1,f,A)}function Ed(o,c,h,f,A,P){if(!c)throw Error("Invalid event type");var q=d(A)?!!A.capture:!!A,ue=pl(o);if(ue||(o[dl]=ue=new xs(o)),h=ue.add(c,h,f,q,P),h.proxy)return h;if(f=O1(),h.proxy=f,f.src=o,f.listener=h,o.addEventListener)V1||(A=q),A===void 0&&(A=!1),o.addEventListener(c.toString(),f,A);else if(o.attachEvent)o.attachEvent(bd(c.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return h}function O1(){function o(h){return c.call(o.src,o.listener,h)}let c=L1;return o}function Td(o,c,h,f,A){if(Array.isArray(c)){for(var P=0;P<c.length;P++)Td(o,c[P],h,f,A);return null}return h=yl(h),o&&o[yi]?o.L(c,h,d(f)?!!f.capture:!!f,A):Ed(o,c,h,!0,f,A)}function Id(o,c,h,f,A){if(Array.isArray(c))for(var P=0;P<c.length;P++)Id(o,c[P],h,f,A);else f=d(f)?!!f.capture:!!f,h=yl(h),o&&o[yi]?(o=o.i,c=String(c).toString(),c in o.g&&(P=o.g[c],h=hl(P,h,f,A),-1<h&&(As(P[h]),Array.prototype.splice.call(P,h,1),P.length==0&&(delete o.g[c],o.h--)))):o&&(o=pl(o))&&(c=o.g[c.toString()],o=-1,c&&(o=hl(c,h,f,A)),(h=-1<o?c[o]:null)&&fl(h))}function fl(o){if(typeof o!="number"&&o&&!o.da){var c=o.src;if(c&&c[yi])cl(c.i,o);else{var h=o.type,f=o.proxy;c.removeEventListener?c.removeEventListener(h,f,o.capture):c.detachEvent?c.detachEvent(bd(h),f):c.addListener&&c.removeListener&&c.removeListener(f),(h=pl(c))?(cl(h,o),h.h==0&&(h.src=null,c[dl]=null)):As(o)}}}function bd(o){return o in ml?ml[o]:ml[o]="on"+o}function L1(o,c){if(o.da)o=!0;else{c=new gi(c,this);var h=o.listener,f=o.ha||o.src;o.fa&&fl(o),o=h.call(f,c)}return o}function pl(o){return o=o[dl],o instanceof xs?o:null}var gl="__closure_events_fn_"+(1e9*Math.random()>>>0);function yl(o){return typeof o=="function"?o:(o[gl]||(o[gl]=function(c){return o.handleEvent(c)}),o[gl])}function Be(){Wt.call(this),this.i=new xs(this),this.M=this,this.F=null}F(Be,Wt),Be.prototype[yi]=!0,Be.prototype.removeEventListener=function(o,c,h,f){Id(this,o,c,h,f)};function We(o,c){var h,f=o.F;if(f)for(h=[];f;f=f.F)h.push(f);if(o=o.M,f=c.type||c,typeof c=="string")c=new qe(c,o);else if(c instanceof qe)c.target=c.target||o;else{var A=c;c=new qe(f,o),I(c,A)}if(A=!0,h)for(var P=h.length-1;0<=P;P--){var q=c.g=h[P];A=Cs(q,f,!0,c)&&A}if(q=c.g=o,A=Cs(q,f,!0,c)&&A,A=Cs(q,f,!1,c)&&A,h)for(P=0;P<h.length;P++)q=c.g=h[P],A=Cs(q,f,!1,c)&&A}Be.prototype.N=function(){if(Be.aa.N.call(this),this.i){var o=this.i,c;for(c in o.g){for(var h=o.g[c],f=0;f<h.length;f++)As(h[f]);delete o.g[c],o.h--}}this.F=null},Be.prototype.K=function(o,c,h,f){return this.i.add(String(o),c,!1,h,f)},Be.prototype.L=function(o,c,h,f){return this.i.add(String(o),c,!0,h,f)};function Cs(o,c,h,f){if(c=o.i.g[String(c)],!c)return!0;c=c.concat();for(var A=!0,P=0;P<c.length;++P){var q=c[P];if(q&&!q.da&&q.capture==h){var ue=q.listener,Ne=q.ha||q.src;q.fa&&cl(o.i,q),A=ue.call(Ne,f)!==!1&&A}}return A&&!f.defaultPrevented}function Sd(o,c,h){if(typeof o=="function")h&&(o=v(o,h));else if(o&&typeof o.handleEvent=="function")o=v(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(c)?-1:l.setTimeout(o,c||0)}function Ad(o){o.g=Sd(()=>{o.g=null,o.i&&(o.i=!1,Ad(o))},o.l);let c=o.h;o.h=null,o.m.apply(null,c)}class q1 extends Wt{constructor(c,h){super(),this.m=c,this.l=h,this.h=null,this.i=!1,this.g=null}j(c){this.h=arguments,this.g?this.i=!0:Ad(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _i(o){Wt.call(this),this.h=o,this.g={}}F(_i,Wt);var xd=[];function Cd(o){Y(o.g,function(c,h){this.g.hasOwnProperty(h)&&fl(c)},o),o.g={}}_i.prototype.N=function(){_i.aa.N.call(this),Cd(this)},_i.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _l=l.JSON.stringify,B1=l.JSON.parse,U1=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function vl(){}vl.prototype.h=null;function Rd(o){return o.h||(o.h=o.i())}function Pd(){}var vi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function wl(){qe.call(this,"d")}F(wl,qe);function El(){qe.call(this,"c")}F(El,qe);var An={},kd=null;function Rs(){return kd=kd||new Be}An.La="serverreachability";function Dd(o){qe.call(this,An.La,o)}F(Dd,qe);function wi(o){let c=Rs();We(c,new Dd(c))}An.STAT_EVENT="statevent";function Vd(o,c){qe.call(this,An.STAT_EVENT,o),this.stat=c}F(Vd,qe);function Qe(o){let c=Rs();We(c,new Vd(c,o))}An.Ma="timingevent";function Nd(o,c){qe.call(this,An.Ma,o),this.size=c}F(Nd,qe);function Ei(o,c){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},c)}function Ti(){this.g=!0}Ti.prototype.xa=function(){this.g=!1};function j1(o,c,h,f,A,P){o.info(function(){if(o.g)if(P)for(var q="",ue=P.split("&"),Ne=0;Ne<ue.length;Ne++){var ae=ue[Ne].split("=");if(1<ae.length){var Ue=ae[0];ae=ae[1];var je=Ue.split("_");q=2<=je.length&&je[1]=="type"?q+(Ue+"="+ae+"&"):q+(Ue+"=redacted&")}}else q=null;else q=P;return"XMLHTTP REQ ("+f+") [attempt "+A+"]: "+c+`
`+h+`
`+q})}function G1(o,c,h,f,A,P,q){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+A+"]: "+c+`
`+h+`
`+P+" "+q})}function hr(o,c,h,f){o.info(function(){return"XMLHTTP TEXT ("+c+"): "+K1(o,h)+(f?" "+f:"")})}function z1(o,c){o.info(function(){return"TIMEOUT: "+c})}Ti.prototype.info=function(){};function K1(o,c){if(!o.g)return c;if(!c)return null;try{var h=JSON.parse(c);if(h){for(o=0;o<h.length;o++)if(Array.isArray(h[o])){var f=h[o];if(!(2>f.length)){var A=f[1];if(Array.isArray(A)&&!(1>A.length)){var P=A[0];if(P!="noop"&&P!="stop"&&P!="close")for(var q=1;q<A.length;q++)A[q]=""}}}}return _l(h)}catch{return c}}var Ps={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Md={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Tl;function ks(){}F(ks,vl),ks.prototype.g=function(){return new XMLHttpRequest},ks.prototype.i=function(){return{}},Tl=new ks;function Qt(o,c,h,f){this.j=o,this.i=c,this.l=h,this.R=f||1,this.U=new _i(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Fd}function Fd(){this.i=null,this.g="",this.h=!1}var Od={},Il={};function bl(o,c,h){o.L=1,o.v=Ms(Nt(c)),o.m=h,o.P=!0,Ld(o,null)}function Ld(o,c){o.F=Date.now(),Ds(o),o.A=Nt(o.v);var h=o.A,f=o.R;Array.isArray(f)||(f=[String(f)]),Xd(h.i,"t",f),o.C=0,h=o.j.J,o.h=new Fd,o.g=gm(o.j,h?c:null,!o.m),0<o.O&&(o.M=new q1(v(o.Y,o,o.g),o.O)),c=o.U,h=o.g,f=o.ca;var A="readystatechange";Array.isArray(A)||(A&&(xd[0]=A.toString()),A=xd);for(var P=0;P<A.length;P++){var q=wd(h,A[P],f||c.handleEvent,!1,c.h||c);if(!q)break;c.g[q.key]=q}c=o.H?_(o.H):{},o.m?(o.u||(o.u="POST"),c["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,c)):(o.u="GET",o.g.ea(o.A,o.u,null,c)),wi(),j1(o.i,o.u,o.A,o.l,o.R,o.m)}Qt.prototype.ca=function(o){o=o.target;let c=this.M;c&&Mt(o)==3?c.j():this.Y(o)},Qt.prototype.Y=function(o){try{if(o==this.g)e:{let je=Mt(this.g);var c=this.g.Ba();let fr=this.g.Z();if(!(3>je)&&(je!=3||this.g&&(this.h.h||this.g.oa()||sm(this.g)))){this.J||je!=4||c==7||(c==8||0>=fr?wi(3):wi(2)),Sl(this);var h=this.g.Z();this.X=h;t:if(qd(this)){var f=sm(this.g);o="";var A=f.length,P=Mt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){xn(this),Ii(this);var q="";break t}this.h.i=new l.TextDecoder}for(c=0;c<A;c++)this.h.h=!0,o+=this.h.i.decode(f[c],{stream:!(P&&c==A-1)});f.length=0,this.h.g+=o,this.C=0,q=this.h.g}else q=this.g.oa();if(this.o=h==200,G1(this.i,this.u,this.A,this.l,this.R,je,h),this.o){if(this.T&&!this.K){t:{if(this.g){var ue,Ne=this.g;if((ue=Ne.g?Ne.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(ue)){var ae=ue;break t}}ae=null}if(h=ae)hr(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Al(this,h);else{this.o=!1,this.s=3,Qe(12),xn(this),Ii(this);break e}}if(this.P){h=!0;let ct;for(;!this.J&&this.C<q.length;)if(ct=$1(this,q),ct==Il){je==4&&(this.s=4,Qe(14),h=!1),hr(this.i,this.l,null,"[Incomplete Response]");break}else if(ct==Od){this.s=4,Qe(15),hr(this.i,this.l,q,"[Invalid Chunk]"),h=!1;break}else hr(this.i,this.l,ct,null),Al(this,ct);if(qd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),je!=4||q.length!=0||this.h.h||(this.s=1,Qe(16),h=!1),this.o=this.o&&h,!h)hr(this.i,this.l,q,"[Invalid Chunked Response]"),xn(this),Ii(this);else if(0<q.length&&!this.W){this.W=!0;var Ue=this.j;Ue.g==this&&Ue.ba&&!Ue.M&&(Ue.j.info("Great, no buffering proxy detected. Bytes received: "+q.length),Dl(Ue),Ue.M=!0,Qe(11))}}else hr(this.i,this.l,q,null),Al(this,q);je==4&&xn(this),this.o&&!this.J&&(je==4?dm(this.j,this):(this.o=!1,Ds(this)))}else uy(this.g),h==400&&0<q.indexOf("Unknown SID")?(this.s=3,Qe(12)):(this.s=0,Qe(13)),xn(this),Ii(this)}}}catch{}finally{}};function qd(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function $1(o,c){var h=o.C,f=c.indexOf(`
`,h);return f==-1?Il:(h=Number(c.substring(h,f)),isNaN(h)?Od:(f+=1,f+h>c.length?Il:(c=c.slice(f,f+h),o.C=f+h,c)))}Qt.prototype.cancel=function(){this.J=!0,xn(this)};function Ds(o){o.S=Date.now()+o.I,Bd(o,o.I)}function Bd(o,c){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Ei(v(o.ba,o),c)}function Sl(o){o.B&&(l.clearTimeout(o.B),o.B=null)}Qt.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(z1(this.i,this.A),this.L!=2&&(wi(),Qe(17)),xn(this),this.s=2,Ii(this)):Bd(this,this.S-o)};function Ii(o){o.j.G==0||o.J||dm(o.j,o)}function xn(o){Sl(o);var c=o.M;c&&typeof c.ma=="function"&&c.ma(),o.M=null,Cd(o.U),o.g&&(c=o.g,o.g=null,c.abort(),c.ma())}function Al(o,c){try{var h=o.j;if(h.G!=0&&(h.g==o||xl(h.h,o))){if(!o.K&&xl(h.h,o)&&h.G==3){try{var f=h.Da.g.parse(c)}catch{f=null}if(Array.isArray(f)&&f.length==3){var A=f;if(A[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<o.F)Bs(h),Ls(h);else break e;kl(h),Qe(18)}}else h.za=A[1],0<h.za-h.T&&37500>A[2]&&h.F&&h.v==0&&!h.C&&(h.C=Ei(v(h.Za,h),6e3));if(1>=Gd(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else Rn(h,11)}else if((o.K||h.g==o)&&Bs(h),!W(c))for(A=h.Da.g.parse(c),c=0;c<A.length;c++){let ae=A[c];if(h.T=ae[0],ae=ae[1],h.G==2)if(ae[0]=="c"){h.K=ae[1],h.ia=ae[2];let Ue=ae[3];Ue!=null&&(h.la=Ue,h.j.info("VER="+h.la));let je=ae[4];je!=null&&(h.Aa=je,h.j.info("SVER="+h.Aa));let fr=ae[5];fr!=null&&typeof fr=="number"&&0<fr&&(f=1.5*fr,h.L=f,h.j.info("backChannelRequestTimeoutMs_="+f)),f=h;let ct=o.g;if(ct){let js=ct.g?ct.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(js){var P=f.h;P.g||js.indexOf("spdy")==-1&&js.indexOf("quic")==-1&&js.indexOf("h2")==-1||(P.j=P.l,P.g=new Set,P.h&&(Cl(P,P.h),P.h=null))}if(f.D){let Vl=ct.g?ct.g.getResponseHeader("X-HTTP-Session-Id"):null;Vl&&(f.ya=Vl,de(f.I,f.D,Vl))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-o.F,h.j.info("Handshake RTT: "+h.R+"ms")),f=h;var q=o;if(f.qa=pm(f,f.J?f.ia:null,f.W),q.K){zd(f.h,q);var ue=q,Ne=f.L;Ne&&(ue.I=Ne),ue.B&&(Sl(ue),Ds(ue)),f.g=q}else cm(f);0<h.i.length&&qs(h)}else ae[0]!="stop"&&ae[0]!="close"||Rn(h,7);else h.G==3&&(ae[0]=="stop"||ae[0]=="close"?ae[0]=="stop"?Rn(h,7):Pl(h):ae[0]!="noop"&&h.l&&h.l.ta(ae),h.v=0)}}wi(4)}catch{}}var W1=class{constructor(o,c){this.g=o,this.map=c}};function Ud(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function jd(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Gd(o){return o.h?1:o.g?o.g.size:0}function xl(o,c){return o.h?o.h==c:o.g?o.g.has(c):!1}function Cl(o,c){o.g?o.g.add(c):o.h=c}function zd(o,c){o.h&&o.h==c?o.h=null:o.g&&o.g.has(c)&&o.g.delete(c)}Ud.prototype.cancel=function(){if(this.i=Kd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function Kd(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let c=o.i;for(let h of o.g.values())c=c.concat(h.D);return c}return L(o.i)}function Q1(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var c=[],h=o.length,f=0;f<h;f++)c.push(o[f]);return c}c=[],h=0;for(f in o)c[h++]=o[f];return c}function H1(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(u(o)||typeof o=="string"){var c=[];o=o.length;for(var h=0;h<o;h++)c.push(h);return c}c=[],h=0;for(let f in o)c[h++]=f;return c}}}function $d(o,c){if(o.forEach&&typeof o.forEach=="function")o.forEach(c,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,c,void 0);else for(var h=H1(o),f=Q1(o),A=f.length,P=0;P<A;P++)c.call(void 0,f[P],h&&h[P],o)}var Wd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function J1(o,c){if(o){o=o.split("&");for(var h=0;h<o.length;h++){var f=o[h].indexOf("="),A=null;if(0<=f){var P=o[h].substring(0,f);A=o[h].substring(f+1)}else P=o[h];c(P,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function Cn(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Cn){this.h=o.h,Vs(this,o.j),this.o=o.o,this.g=o.g,Ns(this,o.s),this.l=o.l;var c=o.i,h=new Ai;h.i=c.i,c.g&&(h.g=new Map(c.g),h.h=c.h),Qd(this,h),this.m=o.m}else o&&(c=String(o).match(Wd))?(this.h=!1,Vs(this,c[1]||"",!0),this.o=bi(c[2]||""),this.g=bi(c[3]||"",!0),Ns(this,c[4]),this.l=bi(c[5]||"",!0),Qd(this,c[6]||"",!0),this.m=bi(c[7]||"")):(this.h=!1,this.i=new Ai(null,this.h))}Cn.prototype.toString=function(){var o=[],c=this.j;c&&o.push(Si(c,Hd,!0),":");var h=this.g;return(h||c=="file")&&(o.push("//"),(c=this.o)&&o.push(Si(c,Hd,!0),"@"),o.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&o.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&o.push("/"),o.push(Si(h,h.charAt(0)=="/"?Z1:X1,!0))),(h=this.i.toString())&&o.push("?",h),(h=this.m)&&o.push("#",Si(h,ty)),o.join("")};function Nt(o){return new Cn(o)}function Vs(o,c,h){o.j=h?bi(c,!0):c,o.j&&(o.j=o.j.replace(/:$/,""))}function Ns(o,c){if(c){if(c=Number(c),isNaN(c)||0>c)throw Error("Bad port number "+c);o.s=c}else o.s=null}function Qd(o,c,h){c instanceof Ai?(o.i=c,ny(o.i,o.h)):(h||(c=Si(c,ey)),o.i=new Ai(c,o.h))}function de(o,c,h){o.i.set(c,h)}function Ms(o){return de(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function bi(o,c){return o?c?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Si(o,c,h){return typeof o=="string"?(o=encodeURI(o).replace(c,Y1),h&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function Y1(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Hd=/[#\/\?@]/g,X1=/[#\?:]/g,Z1=/[#\?]/g,ey=/[#\?@]/g,ty=/#/g;function Ai(o,c){this.h=this.g=null,this.i=o||null,this.j=!!c}function Ht(o){o.g||(o.g=new Map,o.h=0,o.i&&J1(o.i,function(c,h){o.add(decodeURIComponent(c.replace(/\+/g," ")),h)}))}r=Ai.prototype,r.add=function(o,c){Ht(this),this.i=null,o=dr(this,o);var h=this.g.get(o);return h||this.g.set(o,h=[]),h.push(c),this.h+=1,this};function Jd(o,c){Ht(o),c=dr(o,c),o.g.has(c)&&(o.i=null,o.h-=o.g.get(c).length,o.g.delete(c))}function Yd(o,c){return Ht(o),c=dr(o,c),o.g.has(c)}r.forEach=function(o,c){Ht(this),this.g.forEach(function(h,f){h.forEach(function(A){o.call(c,A,f,this)},this)},this)},r.na=function(){Ht(this);let o=Array.from(this.g.values()),c=Array.from(this.g.keys()),h=[];for(let f=0;f<c.length;f++){let A=o[f];for(let P=0;P<A.length;P++)h.push(c[f])}return h},r.V=function(o){Ht(this);let c=[];if(typeof o=="string")Yd(this,o)&&(c=c.concat(this.g.get(dr(this,o))));else{o=Array.from(this.g.values());for(let h=0;h<o.length;h++)c=c.concat(o[h])}return c},r.set=function(o,c){return Ht(this),this.i=null,o=dr(this,o),Yd(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[c]),this.h+=1,this},r.get=function(o,c){return o?(o=this.V(o),0<o.length?String(o[0]):c):c};function Xd(o,c,h){Jd(o,c),0<h.length&&(o.i=null,o.g.set(dr(o,c),L(h)),o.h+=h.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],c=Array.from(this.g.keys());for(var h=0;h<c.length;h++){var f=c[h];let P=encodeURIComponent(String(f)),q=this.V(f);for(f=0;f<q.length;f++){var A=P;q[f]!==""&&(A+="="+encodeURIComponent(String(q[f]))),o.push(A)}}return this.i=o.join("&")};function dr(o,c){return c=String(c),o.j&&(c=c.toLowerCase()),c}function ny(o,c){c&&!o.j&&(Ht(o),o.i=null,o.g.forEach(function(h,f){var A=f.toLowerCase();f!=A&&(Jd(this,f),Xd(this,A,h))},o)),o.j=c}function ry(o,c){let h=new Ti;if(l.Image){let f=new Image;f.onload=x(Jt,h,"TestLoadImage: loaded",!0,c,f),f.onerror=x(Jt,h,"TestLoadImage: error",!1,c,f),f.onabort=x(Jt,h,"TestLoadImage: abort",!1,c,f),f.ontimeout=x(Jt,h,"TestLoadImage: timeout",!1,c,f),l.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else c(!1)}function iy(o,c){let h=new Ti,f=new AbortController,A=setTimeout(()=>{f.abort(),Jt(h,"TestPingServer: timeout",!1,c)},1e4);fetch(o,{signal:f.signal}).then(P=>{clearTimeout(A),P.ok?Jt(h,"TestPingServer: ok",!0,c):Jt(h,"TestPingServer: server error",!1,c)}).catch(()=>{clearTimeout(A),Jt(h,"TestPingServer: error",!1,c)})}function Jt(o,c,h,f,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),f(h)}catch{}}function sy(){this.g=new U1}function oy(o,c,h){let f=h||"";try{$d(o,function(A,P){let q=A;d(A)&&(q=_l(A)),c.push(f+P+"="+encodeURIComponent(q))})}catch(A){throw c.push(f+"type="+encodeURIComponent("_badmap")),A}}function xi(o){this.l=o.Ub||null,this.j=o.eb||!1}F(xi,vl),xi.prototype.g=function(){return new Fs(this.l,this.j)},xi.prototype.i=function(o){return function(){return o}}({});function Fs(o,c){Be.call(this),this.D=o,this.o=c,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}F(Fs,Be),r=Fs.prototype,r.open=function(o,c){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=c,this.readyState=1,Ri(this)},r.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let c={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(c.body=o),(this.D||l).fetch(new Request(this.A,c)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ci(this)),this.readyState=0},r.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Ri(this)),this.g&&(this.readyState=3,Ri(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Zd(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function Zd(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}r.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var c=o.value?o.value:new Uint8Array(0);(c=this.v.decode(c,{stream:!o.done}))&&(this.response=this.responseText+=c)}o.done?Ci(this):Ri(this),this.readyState==3&&Zd(this)}},r.Ra=function(o){this.g&&(this.response=this.responseText=o,Ci(this))},r.Qa=function(o){this.g&&(this.response=o,Ci(this))},r.ga=function(){this.g&&Ci(this)};function Ci(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Ri(o)}r.setRequestHeader=function(o,c){this.u.append(o,c)},r.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],c=this.h.entries();for(var h=c.next();!h.done;)h=h.value,o.push(h[0]+": "+h[1]),h=c.next();return o.join(`\r
`)};function Ri(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Fs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function em(o){let c="";return Y(o,function(h,f){c+=f,c+=":",c+=h,c+=`\r
`}),c}function Rl(o,c,h){e:{for(f in h){var f=!1;break e}f=!0}f||(h=em(h),typeof o=="string"?h!=null&&encodeURIComponent(String(h)):de(o,c,h))}function ve(o){Be.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}F(ve,Be);var ay=/^https?$/i,ly=["POST","PUT"];r=ve.prototype,r.Ha=function(o){this.J=o},r.ea=function(o,c,h,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);c=c?c.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Tl.g(),this.v=this.o?Rd(this.o):Rd(Tl),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(c,String(o),!0),this.B=!1}catch(P){tm(this,P);return}if(o=h||"",h=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var A in f)h.set(A,f[A]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let P of f.keys())h.set(P,f.get(P));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(h.keys()).find(P=>P.toLowerCase()=="content-type"),A=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(ly,c,void 0))||f||A||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[P,q]of h)this.g.setRequestHeader(P,q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{im(this),this.u=!0,this.g.send(o),this.u=!1}catch(P){tm(this,P)}};function tm(o,c){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=c,o.m=5,nm(o),Os(o)}function nm(o){o.A||(o.A=!0,We(o,"complete"),We(o,"error"))}r.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,We(this,"complete"),We(this,"abort"),Os(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Os(this,!0)),ve.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?rm(this):this.bb())},r.bb=function(){rm(this)};function rm(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Mt(o)!=4||o.Z()!=2)){if(o.u&&Mt(o)==4)Sd(o.Ea,0,o);else if(We(o,"readystatechange"),Mt(o)==4){o.h=!1;try{let q=o.Z();e:switch(q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var h;if(!(h=c)){var f;if(f=q===0){var A=String(o.D).match(Wd)[1]||null;!A&&l.self&&l.self.location&&(A=l.self.location.protocol.slice(0,-1)),f=!ay.test(A?A.toLowerCase():"")}h=f}if(h)We(o,"complete"),We(o,"success");else{o.m=6;try{var P=2<Mt(o)?o.g.statusText:""}catch{P=""}o.l=P+" ["+o.Z()+"]",nm(o)}}finally{Os(o)}}}}function Os(o,c){if(o.g){im(o);let h=o.g,f=o.v[0]?()=>{}:null;o.g=null,o.v=null,c||We(o,"ready");try{h.onreadystatechange=f}catch{}}}function im(o){o.I&&(l.clearTimeout(o.I),o.I=null)}r.isActive=function(){return!!this.g};function Mt(o){return o.g?o.g.readyState:0}r.Z=function(){try{return 2<Mt(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(o){if(this.g){var c=this.g.responseText;return o&&c.indexOf(o)==0&&(c=c.substring(o.length)),B1(c)}};function sm(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function uy(o){let c={};o=(o.g&&2<=Mt(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if(W(o[f]))continue;var h=S(o[f]);let A=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let P=c[A]||[];c[A]=P,P.push(h)}T(c,function(f){return f.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Pi(o,c,h){return h&&h.internalChannelParams&&h.internalChannelParams[o]||c}function om(o){this.Aa=0,this.i=[],this.j=new Ti,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Pi("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Pi("baseRetryDelayMs",5e3,o),this.cb=Pi("retryDelaySeedMs",1e4,o),this.Wa=Pi("forwardChannelMaxRetries",2,o),this.wa=Pi("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Ud(o&&o.concurrentRequestLimit),this.Da=new sy,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=om.prototype,r.la=8,r.G=1,r.connect=function(o,c,h,f){Qe(0),this.W=o,this.H=c||{},h&&f!==void 0&&(this.H.OSID=h,this.H.OAID=f),this.F=this.X,this.I=pm(this,null,this.W),qs(this)};function Pl(o){if(am(o),o.G==3){var c=o.U++,h=Nt(o.I);if(de(h,"SID",o.K),de(h,"RID",c),de(h,"TYPE","terminate"),ki(o,h),c=new Qt(o,o.j,c),c.L=2,c.v=Ms(Nt(h)),h=!1,l.navigator&&l.navigator.sendBeacon)try{h=l.navigator.sendBeacon(c.v.toString(),"")}catch{}!h&&l.Image&&(new Image().src=c.v,h=!0),h||(c.g=gm(c.j,null),c.g.ea(c.v)),c.F=Date.now(),Ds(c)}fm(o)}function Ls(o){o.g&&(Dl(o),o.g.cancel(),o.g=null)}function am(o){Ls(o),o.u&&(l.clearTimeout(o.u),o.u=null),Bs(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function qs(o){if(!jd(o.h)&&!o.s){o.s=!0;var c=o.Ga;fi||vd(),pi||(fi(),pi=!0),ul.add(c,o),o.B=0}}function cy(o,c){return Gd(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=c.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Ei(v(o.Ga,o,c),mm(o,o.B)),o.B++,!0)}r.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let A=new Qt(this,this.j,o),P=this.o;if(this.S&&(P?(P=_(P),I(P,this.S)):P=this.S),this.m!==null||this.O||(A.H=P,P=null),this.P)e:{for(var c=0,h=0;h<this.i.length;h++){t:{var f=this.i[h];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(c+=f,4096<c){c=h;break e}if(c===4096||h===this.i.length-1){c=h+1;break e}}c=1e3}else c=1e3;c=um(this,A,c),h=Nt(this.I),de(h,"RID",o),de(h,"CVER",22),this.D&&de(h,"X-HTTP-Session-Id",this.D),ki(this,h),P&&(this.O?c="headers="+encodeURIComponent(String(em(P)))+"&"+c:this.m&&Rl(h,this.m,P)),Cl(this.h,A),this.Ua&&de(h,"TYPE","init"),this.P?(de(h,"$req",c),de(h,"SID","null"),A.T=!0,bl(A,h,null)):bl(A,h,c),this.G=2}}else this.G==3&&(o?lm(this,o):this.i.length==0||jd(this.h)||lm(this))};function lm(o,c){var h;c?h=c.l:h=o.U++;let f=Nt(o.I);de(f,"SID",o.K),de(f,"RID",h),de(f,"AID",o.T),ki(o,f),o.m&&o.o&&Rl(f,o.m,o.o),h=new Qt(o,o.j,h,o.B+1),o.m===null&&(h.H=o.o),c&&(o.i=c.D.concat(o.i)),c=um(o,h,1e3),h.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),Cl(o.h,h),bl(h,f,c)}function ki(o,c){o.H&&Y(o.H,function(h,f){de(c,f,h)}),o.l&&$d({},function(h,f){de(c,f,h)})}function um(o,c,h){h=Math.min(o.i.length,h);var f=o.l?v(o.l.Na,o.l,o):null;e:{var A=o.i;let P=-1;for(;;){let q=["count="+h];P==-1?0<h?(P=A[0].g,q.push("ofs="+P)):P=0:q.push("ofs="+P);let ue=!0;for(let Ne=0;Ne<h;Ne++){let ae=A[Ne].g,Ue=A[Ne].map;if(ae-=P,0>ae)P=Math.max(0,A[Ne].g-100),ue=!1;else try{oy(Ue,q,"req"+ae+"_")}catch{f&&f(Ue)}}if(ue){f=q.join("&");break e}}}return o=o.i.splice(0,h),c.D=o,f}function cm(o){if(!o.g&&!o.u){o.Y=1;var c=o.Fa;fi||vd(),pi||(fi(),pi=!0),ul.add(c,o),o.v=0}}function kl(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Ei(v(o.Fa,o),mm(o,o.v)),o.v++,!0)}r.Fa=function(){if(this.u=null,hm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Ei(v(this.ab,this),o)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Qe(10),Ls(this),hm(this))};function Dl(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function hm(o){o.g=new Qt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var c=Nt(o.qa);de(c,"RID","rpc"),de(c,"SID",o.K),de(c,"AID",o.T),de(c,"CI",o.F?"0":"1"),!o.F&&o.ja&&de(c,"TO",o.ja),de(c,"TYPE","xmlhttp"),ki(o,c),o.m&&o.o&&Rl(c,o.m,o.o),o.L&&(o.g.I=o.L);var h=o.g;o=o.ia,h.L=1,h.v=Ms(Nt(c)),h.m=null,h.P=!0,Ld(h,o)}r.Za=function(){this.C!=null&&(this.C=null,Ls(this),kl(this),Qe(19))};function Bs(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function dm(o,c){var h=null;if(o.g==c){Bs(o),Dl(o),o.g=null;var f=2}else if(xl(o.h,c))h=c.D,zd(o.h,c),f=1;else return;if(o.G!=0){if(c.o)if(f==1){h=c.m?c.m.length:0,c=Date.now()-c.F;var A=o.B;f=Rs(),We(f,new Nd(f,h)),qs(o)}else cm(o);else if(A=c.s,A==3||A==0&&0<c.X||!(f==1&&cy(o,c)||f==2&&kl(o)))switch(h&&0<h.length&&(c=o.h,c.i=c.i.concat(h)),A){case 1:Rn(o,5);break;case 4:Rn(o,10);break;case 3:Rn(o,6);break;default:Rn(o,2)}}}function mm(o,c){let h=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(h*=2),h*c}function Rn(o,c){if(o.j.info("Error code "+c),c==2){var h=v(o.fb,o),f=o.Xa;let A=!f;f=new Cn(f||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Vs(f,"https"),Ms(f),A?ry(f.toString(),h):iy(f.toString(),h)}else Qe(2);o.G=0,o.l&&o.l.sa(c),fm(o),am(o)}r.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Qe(2)):(this.j.info("Failed to ping google.com"),Qe(1))};function fm(o){if(o.G=0,o.ka=[],o.l){let c=Kd(o.h);(c.length!=0||o.i.length!=0)&&(N(o.ka,c),N(o.ka,o.i),o.h.i.length=0,L(o.i),o.i.length=0),o.l.ra()}}function pm(o,c,h){var f=h instanceof Cn?Nt(h):new Cn(h);if(f.g!="")c&&(f.g=c+"."+f.g),Ns(f,f.s);else{var A=l.location;f=A.protocol,c=c?c+"."+A.hostname:A.hostname,A=+A.port;var P=new Cn(null);f&&Vs(P,f),c&&(P.g=c),A&&Ns(P,A),h&&(P.l=h),f=P}return h=o.D,c=o.ya,h&&c&&de(f,h,c),de(f,"VER",o.la),ki(o,f),f}function gm(o,c,h){if(c&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return c=o.Ca&&!o.pa?new ve(new xi({eb:h})):new ve(o.pa),c.Ha(o.J),c}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function ym(){}r=ym.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Us(){}Us.prototype.g=function(o,c){return new tt(o,c)};function tt(o,c){Be.call(this),this.g=new om(c),this.l=o,this.h=c&&c.messageUrlParams||null,o=c&&c.messageHeaders||null,c&&c.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=c&&c.initMessageHeaders||null,c&&c.messageContentType&&(o?o["X-WebChannel-Content-Type"]=c.messageContentType:o={"X-WebChannel-Content-Type":c.messageContentType}),c&&c.va&&(o?o["X-WebChannel-Client-Profile"]=c.va:o={"X-WebChannel-Client-Profile":c.va}),this.g.S=o,(o=c&&c.Sb)&&!W(o)&&(this.g.m=o),this.v=c&&c.supportsCrossDomainXhr||!1,this.u=c&&c.sendRawJson||!1,(c=c&&c.httpSessionIdParam)&&!W(c)&&(this.g.D=c,o=this.h,o!==null&&c in o&&(o=this.h,c in o&&delete o[c])),this.j=new mr(this)}F(tt,Be),tt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},tt.prototype.close=function(){Pl(this.g)},tt.prototype.o=function(o){var c=this.g;if(typeof o=="string"){var h={};h.__data__=o,o=h}else this.u&&(h={},h.__data__=_l(o),o=h);c.i.push(new W1(c.Ya++,o)),c.G==3&&qs(c)},tt.prototype.N=function(){this.g.l=null,delete this.j,Pl(this.g),delete this.g,tt.aa.N.call(this)};function _m(o){wl.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var c=o.__sm__;if(c){e:{for(let h in c){o=h;break e}o=void 0}(this.i=o)&&(o=this.i,c=c!==null&&o in c?c[o]:void 0),this.data=c}else this.data=o}F(_m,wl);function vm(){El.call(this),this.status=1}F(vm,El);function mr(o){this.g=o}F(mr,ym),mr.prototype.ua=function(){We(this.g,"a")},mr.prototype.ta=function(o){We(this.g,new _m(o))},mr.prototype.sa=function(o){We(this.g,new vm)},mr.prototype.ra=function(){We(this.g,"b")},Us.prototype.createWebChannel=Us.prototype.g,tt.prototype.send=tt.prototype.o,tt.prototype.open=tt.prototype.m,tt.prototype.close=tt.prototype.close,yu=Ot.createWebChannelTransport=function(){return new Us},gu=Ot.getStatEventTarget=function(){return Rs()},pu=Ot.Event=An,qo=Ot.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ps.NO_ERROR=0,Ps.TIMEOUT=8,Ps.HTTP_ERROR=6,qi=Ot.ErrorCode=Ps,Md.COMPLETE="complete",fu=Ot.EventType=Md,Pd.EventType=vi,vi.OPEN="a",vi.CLOSE="b",vi.ERROR="c",vi.MESSAGE="d",Be.prototype.listen=Be.prototype.K,Ar=Ot.WebChannel=Pd,E_=Ot.FetchXmlHttpFactory=xi,ve.prototype.listenOnce=ve.prototype.L,ve.prototype.getLastError=ve.prototype.Ka,ve.prototype.getLastErrorCode=ve.prototype.Ba,ve.prototype.getStatus=ve.prototype.Z,ve.prototype.getResponseJson=ve.prototype.Oa,ve.prototype.getResponseText=ve.prototype.oa,ve.prototype.send=ve.prototype.ea,ve.prototype.setWithCredentials=ve.prototype.Ha,mu=Ot.XhrIo=ve}).apply(typeof Lo<"u"?Lo:typeof self<"u"?self:typeof window<"u"?window:{});var Yf="@firebase/firestore";var Ce=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ce.UNAUTHENTICATED=new Ce(null),Ce.GOOGLE_CREDENTIALS=new Ce("google-credentials-uid"),Ce.FIRST_PARTY=new Ce("first-party-uid"),Ce.MOCK_USER=new Ce("mock-user");var ri="10.14.0";var mn=new ho("@firebase/firestore");function kr(){return mn.logLevel}function eg(r){mn.setLogLevel(r)}function O(r,...e){if(mn.logLevel<=Tt.DEBUG){let t=e.map(Th);mn.debug(`Firestore (${ri}): ${r}`,...t)}}function Ee(r,...e){if(mn.logLevel<=Tt.ERROR){let t=e.map(Th);mn.error(`Firestore (${ri}): ${r}`,...t)}}function dt(r,...e){if(mn.logLevel<=Tt.WARN){let t=e.map(Th);mn.warn(`Firestore (${ri}): ${r}`,...t)}}function Th(r){if(typeof r=="string")return r;try{return function(t){return JSON.stringify(t)}(r)}catch{return r}}function G(r="Unexpected state"){let e=`FIRESTORE (${ri}) INTERNAL ASSERTION FAILED: `+r;throw Ee(e),new Error(e)}function z(r,e){r||G()}function tg(r,e){r||G()}function U(r,e){return r}var k={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},M=class extends Af{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ke=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Ho=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Iu=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ce.UNAUTHENTICATED))}shutdown(){}},bu=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Su=class{constructor(e){this.t=e,this.currentUser=Ce.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){z(this.o===void 0);let n=this.i,i=u=>this.i!==n?(n=this.i,t(u)):Promise.resolve(),s=new ke;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ke,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let u=s;e.enqueueRetryable(()=>D(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},l=u=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?l(u):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ke)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(z(typeof n.accessToken=="string"),new Ho(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return z(e===null||typeof e=="string"),new Ce(e)}},Au=class{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Ce.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},xu=class{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Au(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ce.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Cu=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Ru=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){z(this.o===void 0);let n=s=>{s.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,O("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};let i=s=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(z(typeof t.token=="string"),this.R=t.token,new Cu(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function T_(r){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}var Jo=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";for(;n.length<20;){let i=T_(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%e.length))}return n}};function H(r,e){return r<e?-1:r>e?1:0}function Br(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}function ng(r){return r+"\0"}var ye=class r{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new M(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new M(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new M(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return r.fromMillis(Date.now())}static fromDate(e){return r.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new r(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?H(this.nanoseconds,e.nanoseconds):H(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var K=class r{constructor(e){this.timestamp=e}static fromTimestamp(e){return new r(e)}static min(){return new r(new ye(0,0))}static max(){return new r(new ye(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Yo=class r{constructor(e,t,n){t===void 0?t=0:t>e.length&&G(),n===void 0?n=e.length-t:n>e.length-t&&G(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return r.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof r?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let n=Math.min(e.length,t.length);for(let i=0;i<n;i++){let s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},se=class r extends Yo{construct(e,t,n){return new r(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let n of e){if(n.indexOf("//")>=0)throw new M(k.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new r(t)}static emptyPath(){return new r([])}},I_=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Te=class r extends Yo{construct(e,t,n){return new r(e,t,n)}static isValidIdentifier(e){return I_.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),r.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new r(["__name__"])}static fromServerFormat(e){let t=[],n="",i=0,s=()=>{if(n.length===0)throw new M(k.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""},a=!1;for(;i<e.length;){let l=e[i];if(l==="\\"){if(i+1===e.length)throw new M(k.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new M(k.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(n+=l,i++):(s(),i++)}if(s(),a)throw new M(k.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new r(t)}static emptyPath(){return new r([])}};var j=class r{constructor(e){this.path=e}static fromPath(e){return new r(se.fromString(e))}static fromName(e){return new r(se.fromString(e).popFirst(5))}static empty(){return new r(se.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&se.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return se.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new r(new se(e.slice()))}};var Ur=class{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}};function Pu(r){return r.fields.find(e=>e.kind===2)}function Bn(r){return r.fields.filter(e=>e.kind!==2)}Ur.UNKNOWN_ID=-1;var Or=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Yi=class r{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new r(0,lt.min())}};function rg(r,e){let t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=K.fromTimestamp(n===1e9?new ye(t+1,0):new ye(t,n));return new lt(i,j.empty(),e)}function ig(r){return new lt(r.readTime,r.key,-1)}var lt=class r{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new r(K.min(),j.empty(),-1)}static max(){return new r(K.max(),j.empty(),-1)}};function Ih(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=j.comparator(r.documentKey,e.documentKey),t!==0?t:H(r.largestBatchId,e.largestBatchId))}var sg="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Xo=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function In(r){return D(this,null,function*(){if(r.code!==k.FAILED_PRECONDITION||r.message!==sg)throw r;O("LocalStore","Unexpectedly lost primary lease")})}var R=class r{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&G(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new r((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof r?t:r.resolve(t)}catch(t){return r.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):r.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):r.reject(t)}static resolve(e){return new r((t,n)=>{t(e)})}static reject(e){return new r((t,n)=>{n(e)})}static waitFor(e){return new r((t,n)=>{let i=0,s=0,a=!1;e.forEach(l=>{++i,l.next(()=>{++s,a&&s===i&&t()},u=>n(u))}),a=!0,s===i&&t()})}static or(e){let t=r.resolve(!1);for(let n of e)t=t.next(i=>i?r.resolve(i):n());return t}static forEach(e,t){let n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new r((n,i)=>{let s=e.length,a=new Array(s),l=0;for(let u=0;u<s;u++){let d=u;t(e[d]).next(m=>{a[d]=m,++l,l===s&&n(a)},m=>i(m))}})}static doWhile(e,t){return new r((n,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}};var Zo=class r{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new ke,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new $n(e,t.error)):this.V.resolve()},this.transaction.onerror=n=>{let i=bh(n.target.error);this.V.reject(new $n(e,i))}}static open(e,t,n,i){try{return new r(t,e.transaction(i,n))}catch(s){throw new $n(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(O("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new Du(t)}},fn=class r{constructor(e,t,n){this.name=e,this.version=t,this.p=n,r.S(Di())===12.2&&Ee("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return O("SimpleDb","Removing database:",e),Un(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!co())return!1;if(r.v())return!0;let e=Di(),t=r.S(e),n=0<t&&t<10,i=og(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}M(e){return D(this,null,function*(){return this.db||(O("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,n)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let a=s.target.result;t(a)},i.onblocked=()=>{n(new $n(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let a=s.target.error;a.name==="VersionError"?n(new M(k.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):a.name==="InvalidStateError"?n(new M(k.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):n(new $n(e,a))},i.onupgradeneeded=s=>{O("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let a=s.target.result;this.p.O(a,i.transaction,s.oldVersion,this.version).next(()=>{O("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,n,i){return D(this,null,function*(){let s=t==="readonly",a=0;for(;;){++a;try{this.db=yield this.M(e);let l=Zo.open(this.db,e,s?"readonly":"readwrite",n),u=i(l).next(d=>(l.g(),d)).catch(d=>(l.abort(d),R.reject(d))).toPromise();return u.catch(()=>{}),yield l.m,u}catch(l){let u=l,d=u.name!=="FirebaseError"&&a<3;if(O("SimpleDb","Transaction failed with error:",u.message,"Retrying:",d),this.close(),!d)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function og(r){let e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var ku=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Un(this.B.delete())}},$n=class extends M{constructor(e,t){super(k.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function bn(r){return r.name==="IndexedDbTransactionError"}var Du=class{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(O("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(O("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Un(n)}add(e){return O("SimpleDb","ADD",this.store.name,e,e),Un(this.store.add(e))}get(e){return Un(this.store.get(e)).next(t=>(t===void 0&&(t=null),O("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return O("SimpleDb","DELETE",this.store.name,e),Un(this.store.delete(e))}count(){return O("SimpleDb","COUNT",this.store.name),Un(this.store.count())}U(e,t){let n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(n.range);return new R((a,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{a(u.target.result)}})}{let s=this.cursor(n),a=[];return this.W(s,(l,u)=>{a.push(u)}).next(()=>a)}}G(e,t){let n=this.store.getAll(e,t===null?void 0:t);return new R((i,s)=>{n.onerror=a=>{s(a.target.error)},n.onsuccess=a=>{i(a.target.result)}})}j(e,t){O("SimpleDb","DELETE ALL",this.store.name);let n=this.options(e,t);n.H=!1;let i=this.cursor(n);return this.W(i,(s,a,l)=>l.delete())}J(e,t){let n;t?n=e:(n={},t=e);let i=this.cursor(n);return this.W(i,t)}Y(e){let t=this.cursor({});return new R((n,i)=>{t.onerror=s=>{let a=bh(s.target.error);i(a)},t.onsuccess=s=>{let a=s.target.result;a?e(a.primaryKey,a.value).next(l=>{l?a.continue():n()}):n()}})}W(e,t){let n=[];return new R((i,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{let l=a.target.result;if(!l)return void i();let u=new ku(l),d=t(l.primaryKey,l.value,u);if(d instanceof R){let m=d.catch(p=>(u.done(),R.reject(p)));n.push(m)}u.isDone?i():u.K===null?l.continue():l.continue(u.K)}}).next(()=>R.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function Un(r){return new R((e,t)=>{r.onsuccess=n=>{let i=n.target.result;e(i)},r.onerror=n=>{let i=bh(n.target.error);t(i)}})}var Xf=!1;function bh(r){let e=fn.S(Di());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){let n=new M("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Xf||(Xf=!0,setTimeout(()=>{throw n},0)),n}}return r}var Vu=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){O("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>D(this,null,function*(){this.task=null;try{O("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){bn(t)?O("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield In(t)}yield this.X(6e4)}))}},Nu=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return D(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let n=new Set,i=t,s=!0;return R.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(a!==null&&!n.has(a))return O("IndexBackfiller",`Processing collection: ${a}`),this.ne(e,a,i).next(l=>{i-=l,n.add(a)});s=!1})).next(()=>t-i)}ne(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next(s=>{let a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.re(i,s)).next(l=>(O("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>a.size)}))}re(e,t){let n=e;return t.changes.forEach((i,s)=>{let a=ig(s);Ih(a,n)>0&&(n=a)}),new lt(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}};var rt=(()=>{class r{constructor(t,n){this.previousValue=t,n&&(n.sequenceNumberHandler=i=>this.ie(i),this.se=i=>n.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return r.oe=-1,r})();function _s(r){return r==null}function Xi(r){return r===0&&1/r==-1/0}function ag(r){return typeof r=="number"&&Number.isInteger(r)&&!Xi(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}function Je(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=Zf(e)),e=b_(r.get(t),e);return Zf(e)}function b_(r,e){let t=e,n=r.length;for(let i=0;i<n;i++){let s=r.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function Zf(r){return r+""}function It(r){let e=r.length;if(z(e>=2),e===2)return z(r.charAt(0)===""&&r.charAt(1)===""),se.emptyPath();let t=e-2,n=[],i="";for(let s=0;s<e;){let a=r.indexOf("",s);switch((a<0||a>t)&&G(),r.charAt(a+1)){case"":let l=r.substring(s,a),u;i.length===0?u=l:(i+=l,u=i,i=""),n.push(u);break;case"":i+=r.substring(s,a),i+="\0";break;case"":i+=r.substring(s,a+1);break;default:G()}s=a+2}return new se(n)}var ep=["userId","batchId"];function zo(r,e){return[r,Je(e)]}function lg(r,e,t){return[r,Je(e),t]}var S_={},A_=["prefixPath","collectionGroup","readTime","documentId"],x_=["prefixPath","collectionGroup","documentId"],C_=["collectionGroup","readTime","prefixPath","documentId"],R_=["canonicalId","targetId"],P_=["targetId","path"],k_=["path","targetId"],D_=["collectionId","parent"],V_=["indexId","uid"],N_=["uid","sequenceNumber"],M_=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],F_=["indexId","uid","orderedDocumentKey"],O_=["userId","collectionPath","documentId"],L_=["userId","collectionPath","largestBatchId"],q_=["userId","collectionGroup","largestBatchId"],ug=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],B_=[...ug,"documentOverlays"],cg=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],hg=cg,Sh=[...hg,"indexConfiguration","indexState","indexEntries"],U_=Sh,j_=[...Sh,"globals"];var Zi=class extends Xo{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function De(r,e){let t=U(r);return fn.F(t._e,e)}function tp(r){let e=0;for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function ir(r,e){for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function dg(r){for(let e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}var fe=class r{constructor(e,t){this.comparator=e,this.root=t||St.EMPTY}insert(e,t){return new r(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,St.BLACK,null,null))}remove(e){return new r(this.comparator,this.root.remove(e,this.comparator).copy(null,null,St.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){let e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fr(this.root,e,this.comparator,!0)}},Fr=class{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},St=class r{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??r.RED,this.left=i??r.EMPTY,this.right=s??r.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new r(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this,s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return r.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return r.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,r.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw G();let e=this.left.check();if(e!==this.right.check())throw G();return e+(this.isRed()?0:1)}};St.EMPTY=null,St.RED=!0,St.BLACK=!1;St.EMPTY=new class{constructor(){this.size=0}get key(){throw G()}get value(){throw G()}get color(){throw G()}get left(){throw G()}get right(){throw G()}copy(e,t,n,i,s){return this}insert(e,t,n){return new St(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var ce=class r{constructor(e){this.comparator=e,this.data=new fe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ea(this.data.getIterator())}getIteratorFrom(e){return new ea(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof r)||this.size!==e.size)return!1;let t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new r(this.comparator);return t.data=e,t}},ea=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function xr(r){return r.hasNext()?r.getNext():void 0}var it=class r{constructor(e){this.fields=e,e.sort(Te.comparator)}static empty(){return new r([])}unionWith(e){let t=new ce(Te.comparator);for(let n of this.fields)t=t.add(n);for(let n of e)t=t.add(n);return new r(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Br(this.fields,e.fields,(t,n)=>t.isEqual(n))}};var ta=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function mg(){return typeof atob<"u"}var be=class r{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ta("Invalid base64 string: "+s):s}}(e);return new r(t)}static fromUint8Array(e){let t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new r(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return H(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};be.EMPTY_BYTE_STRING=new be("");var G_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bt(r){if(z(!!r),typeof r=="string"){let e=0,t=G_.exec(r);if(z(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:pe(r.seconds),nanos:pe(r.nanos)}}function pe(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function pn(r){return typeof r=="string"?be.fromBase64String(r):be.fromUint8Array(r)}function $a(r){var e,t;return((t=(((e=r?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Ah(r){let e=r.mapValue.fields.__previous_value__;return $a(e)?Ah(e):e}function es(r){let e=Bt(r.mapValue.fields.__local_write_time__.timestampValue);return new ye(e.seconds,e.nanos)}var Mu=class{constructor(e,t,n,i,s,a,l,u,d){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d}},gn=class r{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new r("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof r&&e.projectId===this.projectId&&e.database===this.database}};var hn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ko={nullValue:"NULL_VALUE"};function Wn(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?$a(r)?4:fg(r)?9007199254740991:Wa(r)?10:11:G()}function Ct(r,e){if(r===e)return!0;let t=Wn(r);if(t!==Wn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return es(r).isEqual(es(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=Bt(i.timestampValue),l=Bt(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return pn(i.bytesValue).isEqual(pn(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return pe(i.geoPointValue.latitude)===pe(s.geoPointValue.latitude)&&pe(i.geoPointValue.longitude)===pe(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return pe(i.integerValue)===pe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=pe(i.doubleValue),l=pe(s.doubleValue);return a===l?Xi(a)===Xi(l):isNaN(a)&&isNaN(l)}return!1}(r,e);case 9:return Br(r.arrayValue.values||[],e.arrayValue.values||[],Ct);case 10:case 11:return function(i,s){let a=i.mapValue.fields||{},l=s.mapValue.fields||{};if(tp(a)!==tp(l))return!1;for(let u in a)if(a.hasOwnProperty(u)&&(l[u]===void 0||!Ct(a[u],l[u])))return!1;return!0}(r,e);default:return G()}}function ts(r,e){return(r.values||[]).find(t=>Ct(t,e))!==void 0}function yn(r,e){if(r===e)return 0;let t=Wn(r),n=Wn(e);if(t!==n)return H(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return H(r.booleanValue,e.booleanValue);case 2:return function(s,a){let l=pe(s.integerValue||s.doubleValue),u=pe(a.integerValue||a.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(r,e);case 3:return np(r.timestampValue,e.timestampValue);case 4:return np(es(r),es(e));case 5:return H(r.stringValue,e.stringValue);case 6:return function(s,a){let l=pn(s),u=pn(a);return l.compareTo(u)}(r.bytesValue,e.bytesValue);case 7:return function(s,a){let l=s.split("/"),u=a.split("/");for(let d=0;d<l.length&&d<u.length;d++){let m=H(l[d],u[d]);if(m!==0)return m}return H(l.length,u.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,a){let l=H(pe(s.latitude),pe(a.latitude));return l!==0?l:H(pe(s.longitude),pe(a.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return rp(r.arrayValue,e.arrayValue);case 10:return function(s,a){var l,u,d,m;let p=s.fields||{},v=a.fields||{},x=(l=p.value)===null||l===void 0?void 0:l.arrayValue,F=(u=v.value)===null||u===void 0?void 0:u.arrayValue,L=H(((d=x?.values)===null||d===void 0?void 0:d.length)||0,((m=F?.values)===null||m===void 0?void 0:m.length)||0);return L!==0?L:rp(x,F)}(r.mapValue,e.mapValue);case 11:return function(s,a){if(s===hn.mapValue&&a===hn.mapValue)return 0;if(s===hn.mapValue)return 1;if(a===hn.mapValue)return-1;let l=s.fields||{},u=Object.keys(l),d=a.fields||{},m=Object.keys(d);u.sort(),m.sort();for(let p=0;p<u.length&&p<m.length;++p){let v=H(u[p],m[p]);if(v!==0)return v;let x=yn(l[u[p]],d[m[p]]);if(x!==0)return x}return H(u.length,m.length)}(r.mapValue,e.mapValue);default:throw G()}}function np(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return H(r,e);let t=Bt(r),n=Bt(e),i=H(t.seconds,n.seconds);return i!==0?i:H(t.nanos,n.nanos)}function rp(r,e){let t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){let s=yn(t[i],n[i]);if(s)return s}return H(t.length,n.length)}function jr(r){return Fu(r)}function Fu(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){let n=Bt(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return pn(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return j.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(let s of t.values||[])i?i=!1:n+=",",n+=Fu(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){let n=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of n)s?s=!1:i+=",",i+=`${a}:${Fu(t.fields[a])}`;return i+"}"}(r.mapValue):G()}function Qn(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function Ou(r){return!!r&&"integerValue"in r}function ns(r){return!!r&&"arrayValue"in r}function ip(r){return!!r&&"nullValue"in r}function sp(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function $o(r){return!!r&&"mapValue"in r}function Wa(r){var e,t;return((t=(((e=r?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function $i(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){let e={mapValue:{fields:{}}};return ir(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=$i(n)),e}if(r.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=$i(r.arrayValue.values[t]);return e}return Object.assign({},r)}function fg(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var pg={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function z_(r){return"nullValue"in r?Ko:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?Qn(gn.empty(),j.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?Wa(r)?pg:{mapValue:{}}:G()}function K_(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?Qn(gn.empty(),j.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?pg:"mapValue"in r?Wa(r)?{mapValue:{}}:hn:G()}function op(r,e){let t=yn(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function ap(r,e){let t=yn(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}var $e=class r{constructor(e){this.value=e}static empty(){return new r({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!$o(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=$i(t)}setAll(e){let t=Te.emptyPath(),n={},i=[];e.forEach((a,l)=>{if(!t.isImmediateParentOf(l)){let u=this.getFieldsMap(t);this.applyChanges(u,n,i),n={},i=[],t=l.popLast()}a?n[l.lastSegment()]=$i(a):i.push(l.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){let t=this.field(e.popLast());$o(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ct(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];$o(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){ir(t,(i,s)=>e[i]=s);for(let i of n)delete e[i]}clone(){return new r($i(this.value))}};function gg(r){let e=[];return ir(r.fields,(t,n)=>{let i=new Te([t]);if($o(n)){let s=gg(n.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new it(e)}var Re=class r{constructor(e,t,n,i,s,a,l){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(e){return new r(e,0,K.min(),K.min(),K.min(),$e.empty(),0)}static newFoundDocument(e,t,n,i){return new r(e,1,t,K.min(),n,i,0)}static newNoDocument(e,t){return new r(e,2,t,K.min(),K.min(),$e.empty(),0)}static newUnknownDocument(e,t){return new r(e,3,t,K.min(),K.min(),$e.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$e.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$e.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof r&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new r(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Rt=class{constructor(e,t){this.position=e,this.inclusive=t}};function lp(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){let s=e[i],a=r.position[i];if(s.field.isKeyField()?n=j.comparator(j.fromName(a.referenceValue),t.key):n=yn(a,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function up(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Ct(r.position[t],e.position[t]))return!1;return!0}var Hn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function $_(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}var na=class{},ne=class r extends na{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new Bu(e,t,n):t==="array-contains"?new Gu(e,n):t==="in"?new ra(e,n):t==="not-in"?new zu(e,n):t==="array-contains-any"?new Ku(e,n):new r(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new Uu(e,n):new ju(e,n)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(yn(t,this.value)):t!==null&&Wn(this.value)===Wn(t)&&this.matchesComparison(yn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return G()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},le=class r extends na{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new r(e,t)}matches(e){return Gr(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Gr(r){return r.op==="and"}function Lu(r){return r.op==="or"}function xh(r){return yg(r)&&Gr(r)}function yg(r){for(let e of r.filters)if(e instanceof le)return!1;return!0}function qu(r){if(r instanceof ne)return r.field.canonicalString()+r.op.toString()+jr(r.value);if(xh(r))return r.filters.map(e=>qu(e)).join(",");{let e=r.filters.map(t=>qu(t)).join(",");return`${r.op}(${e})`}}function _g(r,e){return r instanceof ne?function(n,i){return i instanceof ne&&n.op===i.op&&n.field.isEqual(i.field)&&Ct(n.value,i.value)}(r,e):r instanceof le?function(n,i){return i instanceof le&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,l)=>s&&_g(a,i.filters[l]),!0):!1}(r,e):void G()}function vg(r,e){let t=r.filters.concat(e);return le.create(t,r.op)}function wg(r){return r instanceof ne?function(t){return`${t.field.canonicalString()} ${t.op} ${jr(t.value)}`}(r):r instanceof le?function(t){return t.op.toString()+" {"+t.getFilters().map(wg).join(" ,")+"}"}(r):"Filter"}var Bu=class extends ne{constructor(e,t,n){super(e,t,n),this.key=j.fromName(n.referenceValue)}matches(e){let t=j.comparator(e.key,this.key);return this.matchesComparison(t)}},Uu=class extends ne{constructor(e,t){super(e,"in",t),this.keys=Eg("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},ju=class extends ne{constructor(e,t){super(e,"not-in",t),this.keys=Eg("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Eg(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>j.fromName(n.referenceValue))}var Gu=class extends ne{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return ns(t)&&ts(t.arrayValue,this.value)}},ra=class extends ne{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&ts(this.value.arrayValue,t)}},zu=class extends ne{constructor(e,t){super(e,"not-in",t)}matches(e){if(ts(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!ts(this.value.arrayValue,t)}},Ku=class extends ne{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!ns(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>ts(this.value.arrayValue,n))}};var $u=class{constructor(e,t=null,n=[],i=[],s=null,a=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=l,this.ue=null}};function Wu(r,e=null,t=[],n=[],i=null,s=null,a=null){return new $u(r,e,t,n,i,s,a)}function Jn(r){let e=U(r);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>qu(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),_s(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>jr(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>jr(n)).join(",")),e.ue=t}return e.ue}function vs(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!$_(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!_g(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!up(r.startAt,e.startAt)&&up(r.endAt,e.endAt)}function ia(r){return j.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function sa(r,e){return r.filters.filter(t=>t instanceof ne&&t.field.isEqual(e))}function cp(r,e,t){let n=Ko,i=!0;for(let s of sa(r,e)){let a=Ko,l=!0;switch(s.op){case"<":case"<=":a=z_(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,l=!1;break;case"!=":case"not-in":a=Ko}op({value:n,inclusive:i},{value:a,inclusive:l})<0&&(n=a,i=l)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){let a=t.position[s];op({value:n,inclusive:i},{value:a,inclusive:t.inclusive})<0&&(n=a,i=t.inclusive);break}}return{value:n,inclusive:i}}function hp(r,e,t){let n=hn,i=!0;for(let s of sa(r,e)){let a=hn,l=!0;switch(s.op){case">=":case">":a=K_(s.value),l=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,l=!1;break;case"!=":case"not-in":a=hn}ap({value:n,inclusive:i},{value:a,inclusive:l})>0&&(n=a,i=l)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){let a=t.position[s];ap({value:n,inclusive:i},{value:a,inclusive:t.inclusive})>0&&(n=a,i=t.inclusive);break}}return{value:n,inclusive:i}}var mt=class{constructor(e,t=null,n=[],i=[],s=null,a="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Tg(r,e,t,n,i,s,a,l){return new mt(r,e,t,n,i,s,a,l)}function ii(r){return new mt(r)}function dp(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function Ch(r){return r.collectionGroup!==null}function Lr(r){let e=U(r);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new ce(Te.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Hn(s,n))}),t.has(Te.keyField().canonicalString())||e.ce.push(new Hn(Te.keyField(),n))}return e.ce}function Ye(r){let e=U(r);return e.le||(e.le=W_(e,Lr(r))),e.le}function W_(r,e){if(r.limitType==="F")return Wu(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Hn(i.field,s)});let t=r.endAt?new Rt(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Rt(r.startAt.position,r.startAt.inclusive):null;return Wu(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function Qu(r,e){let t=r.filters.concat([e]);return new mt(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function oa(r,e,t){return new mt(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function ws(r,e){return vs(Ye(r),Ye(e))&&r.limitType===e.limitType}function Ig(r){return`${Jn(Ye(r))}|lt:${r.limitType}`}function Dr(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>wg(i)).join(", ")}]`),_s(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>jr(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>jr(i)).join(",")),`Target(${n})`}(Ye(r))}; limitType=${r.limitType})`}function Es(r,e){return e.isFoundDocument()&&function(n,i){let s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):j.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(let s of Lr(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(let s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(a,l,u){let d=lp(a,l,u);return a.inclusive?d<=0:d<0}(n.startAt,Lr(n),i)||n.endAt&&!function(a,l,u){let d=lp(a,l,u);return a.inclusive?d>=0:d>0}(n.endAt,Lr(n),i))}(r,e)}function bg(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function Sg(r){return(e,t)=>{let n=!1;for(let i of Lr(r)){let s=Q_(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function Q_(r,e,t){let n=r.field.isKeyField()?j.comparator(e.key,t.key):function(s,a,l){let u=a.data.field(s),d=l.data.field(s);return u!==null&&d!==null?yn(u,d):G()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return G()}}var Pt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(let[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ir(this.inner,(t,n)=>{for(let[i,s]of n)e(i,s)})}isEmpty(){return dg(this.inner)}size(){return this.innerSize}};var H_=new fe(j.comparator);function et(){return H_}var Ag=new fe(j.comparator);function zi(...r){let e=Ag;for(let t of r)e=e.insert(t.key,t);return e}function xg(r){let e=Ag;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function bt(){return Wi()}function Cg(){return Wi()}function Wi(){return new Pt(r=>r.toString(),(r,e)=>r.isEqual(e))}var J_=new fe(j.comparator),Y_=new ce(j.comparator);function Z(...r){let e=Y_;for(let t of r)e=e.add(t);return e}var X_=new ce(H);function Rh(){return X_}function Ph(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xi(e)?"-0":e}}function Rg(r){return{integerValue:""+r}}function Pg(r,e){return ag(e)?Rg(e):Ph(r,e)}var zr=class{constructor(){this._=void 0}};function Z_(r,e,t){return r instanceof _n?function(i,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&$a(s)&&(s=Ah(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):r instanceof Ut?Dg(r,e):r instanceof jt?Vg(r,e):function(i,s){let a=kg(i,s),l=mp(a)+mp(i.Pe);return Ou(a)&&Ou(i.Pe)?Rg(l):Ph(i.serializer,l)}(r,e)}function ev(r,e,t){return r instanceof Ut?Dg(r,e):r instanceof jt?Vg(r,e):t}function kg(r,e){return r instanceof vn?function(n){return Ou(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}var _n=class extends zr{},Ut=class extends zr{constructor(e){super(),this.elements=e}};function Dg(r,e){let t=Ng(e);for(let n of r.elements)t.some(i=>Ct(i,n))||t.push(n);return{arrayValue:{values:t}}}var jt=class extends zr{constructor(e){super(),this.elements=e}};function Vg(r,e){let t=Ng(e);for(let n of r.elements)t=t.filter(i=>!Ct(i,n));return{arrayValue:{values:t}}}var vn=class extends zr{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function mp(r){return pe(r.integerValue||r.doubleValue)}function Ng(r){return ns(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}var Yn=class{constructor(e,t){this.field=e,this.transform=t}};function tv(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof Ut&&i instanceof Ut||n instanceof jt&&i instanceof jt?Br(n.elements,i.elements,Ct):n instanceof vn&&i instanceof vn?Ct(n.Pe,i.Pe):n instanceof _n&&i instanceof _n}(r.transform,e.transform)}var Hu=class{constructor(e,t){this.version=e,this.transformResults=t}},we=class r{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new r}static exists(e){return new r(void 0,e)}static updateTime(e){return new r(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Wo(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}var Kr=class{};function Mg(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new En(r.key,we.none()):new wn(r.key,r.data,we.none());{let t=r.data,n=$e.empty(),i=new ce(Te.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new ft(r.key,n,new it(i.toArray()),we.none())}}function nv(r,e,t){r instanceof wn?function(i,s,a){let l=i.value.clone(),u=pp(i.fieldTransforms,s,a.transformResults);l.setAll(u),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(r,e,t):r instanceof ft?function(i,s,a){if(!Wo(i.precondition,s))return void s.convertToUnknownDocument(a.version);let l=pp(i.fieldTransforms,s,a.transformResults),u=s.data;u.setAll(Fg(i)),u.setAll(l),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(r,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Qi(r,e,t,n){return r instanceof wn?function(s,a,l,u){if(!Wo(s.precondition,a))return l;let d=s.value.clone(),m=gp(s.fieldTransforms,u,a);return d.setAll(m),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(r,e,t,n):r instanceof ft?function(s,a,l,u){if(!Wo(s.precondition,a))return l;let d=gp(s.fieldTransforms,u,a),m=a.data;return m.setAll(Fg(s)),m.setAll(d),a.convertToFoundDocument(a.version,m).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(r,e,t,n):function(s,a,l){return Wo(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l}(r,e,t)}function rv(r,e){let t=null;for(let n of r.fieldTransforms){let i=e.data.field(n.field),s=kg(n.transform,i||null);s!=null&&(t===null&&(t=$e.empty()),t.set(n.field,s))}return t||null}function fp(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Br(n,i,(s,a)=>tv(s,a))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}var wn=class extends Kr{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},ft=class extends Kr{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Fg(r){let e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let n=r.data.field(t);e.set(t,n)}}),e}function pp(r,e,t){let n=new Map;z(r.length===t.length);for(let i=0;i<t.length;i++){let s=r[i],a=s.transform,l=e.data.field(s.field);n.set(s.field,ev(a,l,t[i]))}return n}function gp(r,e,t){let n=new Map;for(let i of r){let s=i.transform,a=t.data.field(i.field);n.set(i.field,Z_(s,a,e))}return n}var En=class extends Kr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},rs=class extends Kr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var is=class{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&nv(s,e,n[i])}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=Qi(n,e,t,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(t=Qi(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=Cg();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,l=this.applyToLocalView(a,s.mutatedFields);l=t.has(i.key)?null:l;let u=Mg(a,l);u!==null&&n.set(i.key,u),a.isValidDocument()||a.convertToNoDocument(K.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Z())}isEqual(e){return this.batchId===e.batchId&&Br(this.mutations,e.mutations,(t,n)=>fp(t,n))&&Br(this.baseMutations,e.baseMutations,(t,n)=>fp(t,n))}},Ju=class r{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){z(e.mutations.length===n.length);let i=function(){return J_}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new r(e,t,n,i)}};var ss=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Yu=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ae,ie;function Og(r){switch(r){default:return G();case k.CANCELLED:case k.UNKNOWN:case k.DEADLINE_EXCEEDED:case k.RESOURCE_EXHAUSTED:case k.INTERNAL:case k.UNAVAILABLE:case k.UNAUTHENTICATED:return!1;case k.INVALID_ARGUMENT:case k.NOT_FOUND:case k.ALREADY_EXISTS:case k.PERMISSION_DENIED:case k.FAILED_PRECONDITION:case k.ABORTED:case k.OUT_OF_RANGE:case k.UNIMPLEMENTED:case k.DATA_LOSS:return!0}}function Lg(r){if(r===void 0)return Ee("GRPC error has no .code"),k.UNKNOWN;switch(r){case Ae.OK:return k.OK;case Ae.CANCELLED:return k.CANCELLED;case Ae.UNKNOWN:return k.UNKNOWN;case Ae.DEADLINE_EXCEEDED:return k.DEADLINE_EXCEEDED;case Ae.RESOURCE_EXHAUSTED:return k.RESOURCE_EXHAUSTED;case Ae.INTERNAL:return k.INTERNAL;case Ae.UNAVAILABLE:return k.UNAVAILABLE;case Ae.UNAUTHENTICATED:return k.UNAUTHENTICATED;case Ae.INVALID_ARGUMENT:return k.INVALID_ARGUMENT;case Ae.NOT_FOUND:return k.NOT_FOUND;case Ae.ALREADY_EXISTS:return k.ALREADY_EXISTS;case Ae.PERMISSION_DENIED:return k.PERMISSION_DENIED;case Ae.FAILED_PRECONDITION:return k.FAILED_PRECONDITION;case Ae.ABORTED:return k.ABORTED;case Ae.OUT_OF_RANGE:return k.OUT_OF_RANGE;case Ae.UNIMPLEMENTED:return k.UNIMPLEMENTED;case Ae.DATA_LOSS:return k.DATA_LOSS;default:return G()}}(ie=Ae||(Ae={}))[ie.OK=0]="OK",ie[ie.CANCELLED=1]="CANCELLED",ie[ie.UNKNOWN=2]="UNKNOWN",ie[ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ie[ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ie[ie.NOT_FOUND=5]="NOT_FOUND",ie[ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",ie[ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",ie[ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",ie[ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ie[ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ie[ie.ABORTED=10]="ABORTED",ie[ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",ie[ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",ie[ie.INTERNAL=13]="INTERNAL",ie[ie.UNAVAILABLE=14]="UNAVAILABLE",ie[ie.DATA_LOSS=15]="DATA_LOSS";var yp=null;function qg(){return new TextEncoder}var iv=new on([4294967295,4294967295],0);function _p(r){let e=qg().encode(r),t=new du;return t.update(e),new Uint8Array(t.digest())}function vp(r){let e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new on([t,n],0),new on([i,s],0)]}var Xu=class r{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Kn(`Invalid padding: ${t}`);if(n<0)throw new Kn(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Kn(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Kn(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=on.fromNumber(this.Ie)}Ee(e,t,n){let i=e.add(t.multiply(on.fromNumber(n)));return i.compare(iv)===1&&(i=new on([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=_p(e),[n,i]=vp(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(n,i,s);if(!this.de(a))return!1}return!0}static create(e,t,n){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new r(s,i,t);return n.forEach(l=>a.insert(l)),a}insert(e){if(this.Ie===0)return;let t=_p(e),[n,i]=vp(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(n,i,s);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}},Kn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var os=class r{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){let i=new Map;return i.set(e,as.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new r(K.min(),i,new fe(H),et(),Z())}},as=class r{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new r(n,t,Z(),Z(),Z())}};var qr=class{constructor(e,t,n,i){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=i}},aa=class{constructor(e,t){this.targetId=e,this.me=t}},la=class{constructor(e,t,n=be.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}},ua=class{constructor(){this.fe=0,this.ge=Ep(),this.pe=be.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Z(),t=Z(),n=Z();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:G()}}),new as(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=Ep()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,z(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Zu=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=et(),this.qe=wp(),this.Qe=new fe(H)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:G()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((n,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,n=e.me.count,i=this.Je(t);if(i){let s=i.target;if(ia(s))if(n===0){let a=new j(s.path);this.Ue(t,a,Re.newNoDocument(a,K.min()))}else z(n===1);else{let a=this.Ye(t);if(a!==n){let l=this.Ze(e),u=l?this.Xe(l,e,a):1;if(u!==0){this.je(t);let d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}yp?.et(function(m,p,v,x,F){var L,N,$,W,B,Q;let J={localCacheCount:m,existenceFilterCount:p.count,databaseId:v.database,projectId:v.projectId},Y=p.unchangedNames;return Y&&(J.bloomFilter={applied:F===0,hashCount:(L=Y?.hashCount)!==null&&L!==void 0?L:0,bitmapLength:(W=($=(N=Y?.bits)===null||N===void 0?void 0:N.bitmap)===null||$===void 0?void 0:$.length)!==null&&W!==void 0?W:0,padding:(Q=(B=Y?.bits)===null||B===void 0?void 0:B.padding)!==null&&Q!==void 0?Q:0,mightContain:T=>{var _;return(_=x?.mightContain(T))!==null&&_!==void 0&&_}}),J}(a,e.me,this.Le.tt(),l,u))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t,a,l;try{a=pn(n).toUint8Array()}catch(u){if(u instanceof ta)return dt("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Xu(a,i,s)}catch(u){return dt(u instanceof Kn?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){let n=this.Le.getRemoteKeysForTarget(t),i=0;return n.forEach(s=>{let a=this.Le.tt(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,a)=>{let l=this.Je(a);if(l){if(s.current&&ia(l.target)){let u=new j(l.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,Re.newNoDocument(u,e))}s.be&&(t.set(a,s.ve()),s.Ce())}});let n=Z();this.qe.forEach((s,a)=>{let l=!0;a.forEachWhile(u=>{let d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));let i=new os(e,t,this.Qe,this.ke,n);return this.ke=et(),this.qe=wp(),this.Qe=new fe(H),i}$e(e,t){if(!this.ze(e))return;let n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new ua,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new ce(H),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||O("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ua),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function wp(){return new fe(j.comparator)}function Ep(){return new fe(j.comparator)}var sv={asc:"ASCENDING",desc:"DESCENDING"},ov={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},av={and:"AND",or:"OR"},ec=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function tc(r,e){return r.useProto3Json||_s(e)?e:{value:e}}function $r(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Bg(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function lv(r,e){return $r(r,e.toTimestamp())}function Ie(r){return z(!!r),K.fromTimestamp(function(t){let n=Bt(t);return new ye(n.seconds,n.nanos)}(r))}function kh(r,e){return nc(r,e).canonicalString()}function nc(r,e){let t=function(i){return new se(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function Ug(r){let e=se.fromString(r);return z(Yg(e)),e}function ls(r,e){return kh(r.databaseId,e.path)}function At(r,e){let t=Ug(e);if(t.get(1)!==r.databaseId.projectId)throw new M(k.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new M(k.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new j(zg(t))}function jg(r,e){return kh(r.databaseId,e)}function Gg(r){let e=Ug(r);return e.length===4?se.emptyPath():zg(e)}function rc(r){return new se(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function zg(r){return z(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function Tp(r,e,t){return{name:ls(r,e),fields:t.value.mapValue.fields}}function Kg(r,e,t){let n=At(r,e.name),i=Ie(e.updateTime),s=e.createTime?Ie(e.createTime):K.min(),a=new $e({mapValue:{fields:e.fields}}),l=Re.newFoundDocument(n,i,s,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function uv(r,e){return"found"in e?function(n,i){z(!!i.found),i.found.name,i.found.updateTime;let s=At(n,i.found.name),a=Ie(i.found.updateTime),l=i.found.createTime?Ie(i.found.createTime):K.min(),u=new $e({mapValue:{fields:i.found.fields}});return Re.newFoundDocument(s,a,l,u)}(r,e):"missing"in e?function(n,i){z(!!i.missing),z(!!i.readTime);let s=At(n,i.missing),a=Ie(i.readTime);return Re.newNoDocument(s,a)}(r,e):G()}function cv(r,e){let t;if("targetChange"in e){e.targetChange;let n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:G()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,m){return d.useProto3Json?(z(m===void 0||typeof m=="string"),be.fromBase64String(m||"")):(z(m===void 0||m instanceof Buffer||m instanceof Uint8Array),be.fromUint8Array(m||new Uint8Array))}(r,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&function(d){let m=d.code===void 0?k.UNKNOWN:Lg(d.code);return new M(m,d.message||"")}(a);t=new la(n,i,s,l||null)}else if("documentChange"in e){e.documentChange;let n=e.documentChange;n.document,n.document.name,n.document.updateTime;let i=At(r,n.document.name),s=Ie(n.document.updateTime),a=n.document.createTime?Ie(n.document.createTime):K.min(),l=new $e({mapValue:{fields:n.document.fields}}),u=Re.newFoundDocument(i,s,a,l),d=n.targetIds||[],m=n.removedTargetIds||[];t=new qr(d,m,u.key,u)}else if("documentDelete"in e){e.documentDelete;let n=e.documentDelete;n.document;let i=At(r,n.document),s=n.readTime?Ie(n.readTime):K.min(),a=Re.newNoDocument(i,s),l=n.removedTargetIds||[];t=new qr([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;let n=e.documentRemove;n.document;let i=At(r,n.document),s=n.removedTargetIds||[];t=new qr([],s,i,null)}else{if(!("filter"in e))return G();{e.filter;let n=e.filter;n.targetId;let{count:i=0,unchangedNames:s}=n,a=new Yu(i,s),l=n.targetId;t=new aa(l,a)}}return t}function us(r,e){let t;if(e instanceof wn)t={update:Tp(r,e.key,e.value)};else if(e instanceof En)t={delete:ls(r,e.key)};else if(e instanceof ft)t={update:Tp(r,e.key,e.data),updateMask:gv(e.fieldMask)};else{if(!(e instanceof rs))return G();t={verify:ls(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,a){let l=a.transform;if(l instanceof _n)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Ut)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof jt)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof vn)return{fieldPath:a.field.canonicalString(),increment:l.Pe};throw G()}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:lv(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:G()}(r,e.precondition)),t}function ic(r,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?we.updateTime(Ie(s.updateTime)):s.exists!==void 0?we.exists(s.exists):we.none()}(e.currentDocument):we.none(),n=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let u=null;if("setToServerValue"in l)z(l.setToServerValue==="REQUEST_TIME"),u=new _n;else if("appendMissingElements"in l){let m=l.appendMissingElements.values||[];u=new Ut(m)}else if("removeAllFromArray"in l){let m=l.removeAllFromArray.values||[];u=new jt(m)}else"increment"in l?u=new vn(a,l.increment):G();let d=Te.fromServerFormat(l.fieldPath);return new Yn(d,u)}(r,i)):[];if(e.update){e.update.name;let i=At(r,e.update.name),s=new $e({mapValue:{fields:e.update.fields}});if(e.updateMask){let a=function(u){let d=u.fieldPaths||[];return new it(d.map(m=>Te.fromServerFormat(m)))}(e.updateMask);return new ft(i,s,a,t,n)}return new wn(i,s,t,n)}if(e.delete){let i=At(r,e.delete);return new En(i,t)}if(e.verify){let i=At(r,e.verify);return new rs(i,t)}return G()}function hv(r,e){return r&&r.length>0?(z(e!==void 0),r.map(t=>function(i,s){let a=i.updateTime?Ie(i.updateTime):Ie(s);return a.isEqual(K.min())&&(a=Ie(s)),new Hu(a,i.transformResults||[])}(t,e))):[]}function $g(r,e){return{documents:[jg(r,e.path)]}}function Wg(r,e){let t={structuredQuery:{}},n=e.path,i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=jg(r,i);let s=function(d){if(d.length!==0)return Jg(le.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(d){if(d.length!==0)return d.map(m=>function(v){return{field:Vr(v.field),direction:mv(v.dir)}}(m))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let l=tc(r,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function Qg(r){let e=Gg(r.parent),t=r.structuredQuery,n=t.from?t.from.length:0,i=null;if(n>0){z(n===1);let m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let s=[];t.where&&(s=function(p){let v=Hg(p);return v instanceof le&&xh(v)?v.getFilters():[v]}(t.where));let a=[];t.orderBy&&(a=function(p){return p.map(v=>function(F){return new Hn(Nr(F.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(F.direction))}(v))}(t.orderBy));let l=null;t.limit&&(l=function(p){let v;return v=typeof p=="object"?p.value:p,_s(v)?null:v}(t.limit));let u=null;t.startAt&&(u=function(p){let v=!!p.before,x=p.values||[];return new Rt(x,v)}(t.startAt));let d=null;return t.endAt&&(d=function(p){let v=!p.before,x=p.values||[];return new Rt(x,v)}(t.endAt)),Tg(e,i,a,s,l,"F",u,d)}function dv(r,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return G()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Hg(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let n=Nr(t.unaryFilter.field);return ne.create(n,"==",{doubleValue:NaN});case"IS_NULL":let i=Nr(t.unaryFilter.field);return ne.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Nr(t.unaryFilter.field);return ne.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Nr(t.unaryFilter.field);return ne.create(a,"!=",{nullValue:"NULL_VALUE"});default:return G()}}(r):r.fieldFilter!==void 0?function(t){return ne.create(Nr(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return G()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return le.create(t.compositeFilter.filters.map(n=>Hg(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return G()}}(t.compositeFilter.op))}(r):G()}function mv(r){return sv[r]}function fv(r){return ov[r]}function pv(r){return av[r]}function Vr(r){return{fieldPath:r.canonicalString()}}function Nr(r){return Te.fromServerFormat(r.fieldPath)}function Jg(r){return r instanceof ne?function(t){if(t.op==="=="){if(sp(t.value))return{unaryFilter:{field:Vr(t.field),op:"IS_NAN"}};if(ip(t.value))return{unaryFilter:{field:Vr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(sp(t.value))return{unaryFilter:{field:Vr(t.field),op:"IS_NOT_NAN"}};if(ip(t.value))return{unaryFilter:{field:Vr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vr(t.field),op:fv(t.op),value:t.value}}}(r):r instanceof le?function(t){let n=t.getFilters().map(i=>Jg(i));return n.length===1?n[0]:{compositeFilter:{op:pv(t.op),filters:n}}}(r):G()}function gv(r){let e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Yg(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}var Wr=class r{constructor(e,t,n,i,s=K.min(),a=K.min(),l=be.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new r(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new r(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var ca=class{constructor(e){this.ct=e}};function yv(r,e){let t;if(e.document)t=Kg(r.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let n=j.fromSegments(e.noDocument.path),i=Zn(e.noDocument.readTime);t=Re.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return G();{let n=j.fromSegments(e.unknownDocument.path),i=Zn(e.unknownDocument.version);t=Re.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime(function(i){let s=new ye(i[0],i[1]);return K.fromTimestamp(s)}(e.readTime)),t}function Ip(r,e){let t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:ha(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,a){return{name:ls(s,a.key),fields:a.data.value.mapValue.fields,updateTime:$r(s,a.version.toTimestamp()),createTime:$r(s,a.createTime.toTimestamp())}}(r.ct,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:Xn(e.version)};else{if(!e.isUnknownDocument())return G();n.unknownDocument={path:t.path.toArray(),version:Xn(e.version)}}return n}function ha(r){let e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function Xn(r){let e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Zn(r){let e=new ye(r.seconds,r.nanoseconds);return K.fromTimestamp(e)}function jn(r,e){let t=(e.baseMutations||[]).map(s=>ic(r.ct,s));for(let s=0;s<e.mutations.length-1;++s){let a=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let l=e.mutations[s+1];a.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let n=e.mutations.map(s=>ic(r.ct,s)),i=ye.fromMillis(e.localWriteTimeMs);return new is(e.batchId,i,t,n)}function Ki(r){let e=Zn(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?Zn(r.lastLimboFreeSnapshotVersion):K.min(),n;return n=function(s){return s.documents!==void 0}(r.query)?function(s){return z(s.documents.length===1),Ye(ii(Gg(s.documents[0])))}(r.query):function(s){return Ye(Qg(s))}(r.query),new Wr(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,be.fromBase64String(r.resumeToken))}function Xg(r,e){let t=Xn(e.snapshotVersion),n=Xn(e.lastLimboFreeSnapshotVersion),i;i=ia(e.target)?$g(r.ct,e.target):Wg(r.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Jn(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function Dh(r){let e=Qg({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?oa(e,e.limit,"L"):e}function _u(r,e){return new ss(e.largestBatchId,ic(r.ct,e.overlayMutation))}function bp(r,e){let t=e.path.lastSegment();return[r,Je(e.path.popLast()),t]}function Sp(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:Xn(n.readTime),documentKey:Je(n.documentKey.path),largestBatchId:n.largestBatchId}}var sc=class{getBundleMetadata(e,t){return Ap(e).get(t).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:Zn(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,t){return Ap(e).put(function(i){return{bundleId:i.id,createTime:Xn(Ie(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return xp(e).get(t).next(n=>{if(n)return function(s){return{name:s.name,query:Dh(s.bundledQuery),readTime:Zn(s.readTime)}}(n)})}saveNamedQuery(e,t){return xp(e).put(function(i){return{name:i.name,readTime:Xn(Ie(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function Ap(r){return De(r,"bundles")}function xp(r){return De(r,"namedQueries")}var da=class r{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let n=t.uid||"";return new r(e,n)}getOverlay(e,t){return Bi(e).get(bp(this.userId,t)).next(n=>n?_u(this.serializer,n):null)}getOverlays(e,t){let n=bt();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){let i=[];return n.forEach((s,a)=>{let l=new ss(t,a);i.push(this.ht(e,l))}),R.waitFor(i)}removeOverlaysForBatchId(e,t,n){let i=new Set;t.forEach(a=>i.add(Je(a.getCollectionPath())));let s=[];return i.forEach(a=>{let l=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,n+1],!1,!0);s.push(Bi(e).j("collectionPathOverlayIndex",l))}),R.waitFor(s)}getOverlaysForCollection(e,t,n){let i=bt(),s=Je(t),a=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Bi(e).U("collectionPathOverlayIndex",a).next(l=>{for(let u of l){let d=_u(this.serializer,u);i.set(d.getKey(),d)}return i})}getOverlaysForCollectionGroup(e,t,n,i){let s=bt(),a,l=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Bi(e).J({index:"collectionGroupOverlayIndex",range:l},(u,d,m)=>{let p=_u(this.serializer,d);s.size()<i||p.largestBatchId===a?(s.set(p.getKey(),p),a=p.largestBatchId):m.done()}).next(()=>s)}ht(e,t){return Bi(e).put(function(i,s,a){let[l,u,d]=bp(s,a.mutation.key);return{userId:s,collectionPath:u,documentId:d,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:us(i.ct,a.mutation)}}(this.serializer,this.userId,t))}};function Bi(r){return De(r,"documentOverlays")}var oc=class{Pt(e){return De(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let n=t?.value;return n?be.fromUint8Array(n):be.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var Lt=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(pe(e.integerValue));else if("doubleValue"in e){let n=pe(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),Xi(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),typeof n=="string"&&(n=Bt(n)),t.Rt(`${n.seconds||""}`),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(pn(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?fg(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Wa(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):G()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let n=e.fields||{};this.dt(t,55);for(let i of Object.keys(n))this.Vt(i,t),this.Tt(n[i],t)}wt(e,t){var n,i;let s=e.fields||{};this.dt(t,53);let a="value",l=((i=(n=s[a].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(pe(l)),this.Vt(a,t),this.Tt(s[a],t)}bt(e,t){let n=e.values||[];this.dt(t,50);for(let i of n)this.Tt(i,t)}yt(e,t){this.dt(t,37),j.fromName(e).path.forEach(n=>{this.dt(t,60),this.Dt(n,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Lt.vt=new Lt;function _v(r){if(r===0)return 8;let e=0;return!(r>>4)&&(e+=4,r<<=4),!(r>>6)&&(e+=2,r<<=2),!(r>>7)&&(e+=1),e}function Cp(r){let e=64-function(n){let i=0;for(let s=0;s<8;++s){let a=_v(255&n[s]);if(i+=a,a!==8)break}return i}(r);return Math.ceil(e/8)}var ac=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.Ft(n.value),n=t.next();this.Mt()}xt(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.Ot(n.value),n=t.next();this.Nt()}Lt(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.Ft(n);else if(n<2048)this.Ft(960|n>>>6),this.Ft(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|n>>>12),this.Ft(128|63&n>>>6),this.Ft(128|63&n);else{let i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(let t of e){let n=t.charCodeAt(0);if(n<128)this.Ot(n);else if(n<2048)this.Ot(960|n>>>6),this.Ot(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|n>>>12),this.Ot(128|63&n>>>6),this.Ot(128|63&n);else{let i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){let t=this.qt(e),n=Cp(t);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){let t=this.qt(e),n=Cp(t);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){let t=function(s){let a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,s,!1),new Uint8Array(a.buffer)}(e),n=(128&t[0])!=0;t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Ft(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);let i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}},lc=class{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}},uc=class{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}},Gn=class{constructor(){this.jt=new ac,this.Ht=new lc(this.jt),this.Jt=new uc(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var zn=class r{constructor(e,t,n,i){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=i}Zt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new r(this.indexId,this.documentKey,this.arrayValue,n)}};function an(r,e){let t=r.indexId-e.indexId;return t!==0?t:(t=Rp(r.arrayValue,e.arrayValue),t!==0?t:(t=Rp(r.directionalValue,e.directionalValue),t!==0?t:j.comparator(r.documentKey,e.documentKey)))}function Rp(r,e){for(let t=0;t<r.length&&t<e.length;++t){let n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}var ma=class{constructor(e){this.Xt=new ce((t,n)=>Te.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(let t of e.filters){let n=t;n.isInequality()?this.Xt=this.Xt.add(n):this.tn.push(n)}}get nn(){return this.Xt.size>1}rn(e){if(z(e.collectionGroup===this.collectionId),this.nn)return!1;let t=Pu(e);if(t!==void 0&&!this.sn(t))return!1;let n=Bn(e),i=new Set,s=0,a=0;for(;s<n.length&&this.sn(n[s]);++s)i=i.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Xt.size>0){let l=this.Xt.getIterator().getNext();if(!i.has(l.field.canonicalString())){let u=n[s];if(!this.on(l,u)||!this._n(this.en[a++],u))return!1}++s}for(;s<n.length;++s){let l=n[s];if(a>=this.en.length||!this._n(this.en[a++],l))return!1}return!0}an(){if(this.nn)return null;let e=new ce(Te.comparator),t=[];for(let n of this.tn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new Or(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new Or(n.field,0))}for(let n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new Or(n.field,n.dir==="asc"?0:1)));return new Ur(Ur.UNKNOWN_ID,this.collectionId,t,Yi.empty())}sn(e){for(let t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function Zg(r){var e,t;if(z(r instanceof ne||r instanceof le),r instanceof ne){if(r instanceof ra){let i=((t=(e=r.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>ne.create(r.field,"==",s)))||[];return le.create(i,"or")}return r}let n=r.filters.map(i=>Zg(i));return le.create(n,r.op)}function vv(r){if(r.getFilters().length===0)return[];let e=dc(Zg(r));return z(e0(e)),cc(e)||hc(e)?[e]:e.getFilters()}function cc(r){return r instanceof ne}function hc(r){return r instanceof le&&xh(r)}function e0(r){return cc(r)||hc(r)||function(t){if(t instanceof le&&Lu(t)){for(let n of t.getFilters())if(!cc(n)&&!hc(n))return!1;return!0}return!1}(r)}function dc(r){if(z(r instanceof ne||r instanceof le),r instanceof ne)return r;if(r.filters.length===1)return dc(r.filters[0]);let e=r.filters.map(n=>dc(n)),t=le.create(e,r.op);return t=fa(t),e0(t)?t:(z(t instanceof le),z(Gr(t)),z(t.filters.length>1),t.filters.reduce((n,i)=>Vh(n,i)))}function Vh(r,e){let t;return z(r instanceof ne||r instanceof le),z(e instanceof ne||e instanceof le),t=r instanceof ne?e instanceof ne?function(i,s){return le.create([i,s],"and")}(r,e):Pp(r,e):e instanceof ne?Pp(e,r):function(i,s){if(z(i.filters.length>0&&s.filters.length>0),Gr(i)&&Gr(s))return vg(i,s.getFilters());let a=Lu(i)?i:s,l=Lu(i)?s:i,u=a.filters.map(d=>Vh(d,l));return le.create(u,"or")}(r,e),fa(t)}function Pp(r,e){if(Gr(e))return vg(e,r.getFilters());{let t=e.filters.map(n=>Vh(r,n));return le.create(t,"or")}}function fa(r){if(z(r instanceof ne||r instanceof le),r instanceof ne)return r;let e=r.getFilters();if(e.length===1)return fa(e[0]);if(yg(r))return r;let t=e.map(i=>fa(i)),n=[];return t.forEach(i=>{i instanceof ne?n.push(i):i instanceof le&&(i.op===r.op?n.push(...i.filters):n.push(i))}),n.length===1?n[0]:le.create(n,r.op)}var mc=class{constructor(){this.un=new cs}addToCollectionParentIndex(e,t){return this.un.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(lt.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(lt.min())}updateCollectionGroup(e,t,n){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}},cs=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new ce(se.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){let t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new ce(se.comparator)).toArray()}};var Bo=new Uint8Array(0),fc=class{constructor(e,t){this.databaseId=t,this.cn=new cs,this.ln=new Pt(n=>Jn(n),(n,i)=>vs(n,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){let n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});let s={collectionId:n,parent:Je(i)};return kp(e).put(s)}return R.resolve()}getCollectionParents(e,t){let n=[],i=IDBKeyRange.bound([t,""],[ng(t),""],!1,!0);return kp(e).U(i).next(s=>{for(let a of s){if(a.collectionId!==t)break;n.push(It(a.parent))}return n})}addFieldIndex(e,t){let n=Ui(e),i=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete i.indexId;let s=n.add(i);if(t.indexState){let a=Rr(e);return s.next(l=>{a.put(Sp(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let n=Ui(e),i=Rr(e),s=Cr(e);return n.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Ui(e),n=Cr(e),i=Rr(e);return t.j().next(()=>n.j()).next(()=>i.j())}createTargetIndexes(e,t){return R.forEach(this.hn(t),n=>this.getIndexType(e,n).next(i=>{if(i===0||i===1){let s=new ma(n).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let n=Cr(e),i=!0,s=new Map;return R.forEach(this.hn(t),a=>this.Pn(e,a).next(l=>{i&&(i=!!l),s.set(a,l)})).next(()=>{if(i){let a=Z(),l=[];return R.forEach(s,(u,d)=>{O("IndexedDbIndexManager",`Using index ${function(B){return`id=${B.indexId}|cg=${B.collectionGroup}|f=${B.fields.map(Q=>`${Q.fieldPath}:${Q.kind}`).join(",")}`}(u)} to execute ${Jn(t)}`);let m=function(B,Q){let J=Pu(Q);if(J===void 0)return null;for(let Y of sa(B,J.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null}(d,u),p=function(B,Q){let J=new Map;for(let Y of Bn(Q))for(let T of sa(B,Y.fieldPath))switch(T.op){case"==":case"in":J.set(Y.fieldPath.canonicalString(),T.value);break;case"not-in":case"!=":return J.set(Y.fieldPath.canonicalString(),T.value),Array.from(J.values())}return null}(d,u),v=function(B,Q){let J=[],Y=!0;for(let T of Bn(Q)){let _=T.kind===0?cp(B,T.fieldPath,B.startAt):hp(B,T.fieldPath,B.startAt);J.push(_.value),Y&&(Y=_.inclusive)}return new Rt(J,Y)}(d,u),x=function(B,Q){let J=[],Y=!0;for(let T of Bn(Q)){let _=T.kind===0?hp(B,T.fieldPath,B.endAt):cp(B,T.fieldPath,B.endAt);J.push(_.value),Y&&(Y=_.inclusive)}return new Rt(J,Y)}(d,u),F=this.In(u,d,v),L=this.In(u,d,x),N=this.Tn(u,d,p),$=this.En(u.indexId,m,F,v.inclusive,L,x.inclusive,N);return R.forEach($,W=>n.G(W,t.limit).next(B=>{B.forEach(Q=>{let J=j.fromSegments(Q.documentKey);a.has(J)||(a=a.add(J),l.push(J))})}))}).next(()=>l)}return R.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=vv(le.create(e.filters,"and")).map(n=>Wu(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,n,i,s,a,l){let u=(t!=null?t.length:1)*Math.max(n.length,s.length),d=u/(t!=null?t.length:1),m=[];for(let p=0;p<u;++p){let v=t?this.dn(t[p/d]):Bo,x=this.An(e,v,n[p%d],i),F=this.Rn(e,v,s[p%d],a),L=l.map(N=>this.An(e,v,N,!0));m.push(...this.createRange(x,F,L))}return m}An(e,t,n,i){let s=new zn(e,j.empty(),t,n);return i?s:s.Zt()}Rn(e,t,n,i){let s=new zn(e,j.empty(),t,n);return i?s.Zt():s}Pn(e,t){let n=new ma(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let a=null;for(let l of s)n.rn(l)&&(!a||l.fields.length>a.fields.length)&&(a=l);return a})}getIndexType(e,t){let n=2,i=this.hn(t);return R.forEach(i,s=>this.Pn(e,s).next(a=>{a?n!==0&&a.fields.length<function(u){let d=new ce(Te.comparator),m=!1;for(let p of u.filters)for(let v of p.getFlattenedFilters())v.field.isKeyField()||(v.op==="array-contains"||v.op==="array-contains-any"?m=!0:d=d.add(v.field));for(let p of u.orderBy)p.field.isKeyField()||(d=d.add(p.field));return d.size+(m?1:0)}(s)&&(n=1):n=0})).next(()=>function(a){return a.limit!==null}(t)&&i.length>1&&n===2?1:n)}Vn(e,t){let n=new Gn;for(let i of Bn(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let a=n.Yt(i.kind);Lt.vt.It(s,a)}return n.zt()}dn(e){let t=new Gn;return Lt.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){let n=new Gn;return Lt.vt.It(Qn(this.databaseId,t),n.Yt(function(s){let a=Bn(s);return a.length===0?0:a[a.length-1].kind}(e))),n.zt()}Tn(e,t,n){if(n===null)return[];let i=[];i.push(new Gn);let s=0;for(let a of Bn(e)){let l=n[s++];for(let u of i)if(this.fn(t,a.fieldPath)&&ns(l))i=this.gn(i,a,l);else{let d=u.Yt(a.kind);Lt.vt.It(l,d)}}return this.pn(i)}In(e,t,n){return this.Tn(e,t,n.position)}pn(e){let t=[];for(let n=0;n<e.length;++n)t[n]=e[n].zt();return t}gn(e,t,n){let i=[...e],s=[];for(let a of n.arrayValue.values||[])for(let l of i){let u=new Gn;u.seed(l.zt()),Lt.vt.It(a,u.Yt(t.kind)),s.push(u)}return s}fn(e,t){return!!e.filters.find(n=>n instanceof ne&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){let n=Ui(e),i=Rr(e);return(t?n.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.U()).next(s=>{let a=[];return R.forEach(s,l=>i.get([l.indexId,this.uid]).next(u=>{a.push(function(m,p){let v=p?new Yi(p.sequenceNumber,new lt(Zn(p.readTime),new j(It(p.documentKey)),p.largestBatchId)):Yi.empty(),x=m.fields.map(([F,L])=>new Or(Te.fromServerFormat(F),L));return new Ur(m.indexId,m.collectionGroup,x,v)}(l,u))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,i)=>{let s=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:H(n.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){let i=Ui(e),s=Rr(e);return this.yn(e).next(a=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(l=>R.forEach(l,u=>s.put(Sp(u.indexId,this.uid,a,n)))))}updateIndexEntries(e,t){let n=new Map;return R.forEach(t,(i,s)=>{let a=n.get(i.collectionGroup);return(a?R.resolve(a):this.getFieldIndexes(e,i.collectionGroup)).next(l=>(n.set(i.collectionGroup,l),R.forEach(l,u=>this.wn(e,i,u).next(d=>{let m=this.Sn(s,u);return d.isEqual(m)?R.resolve():this.bn(e,s,u,d,m)}))))})}Dn(e,t,n,i){return Cr(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(n,t.key),documentKey:t.key.path.toArray()})}vn(e,t,n,i){return Cr(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(n,t.key),t.key.path.toArray()])}wn(e,t,n){let i=Cr(e),s=new ce(an);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,t)])},(a,l)=>{s=s.add(new zn(n.indexId,t,l.arrayValue,l.directionalValue))}).next(()=>s)}Sn(e,t){let n=new ce(an),i=this.Vn(t,e);if(i==null)return n;let s=Pu(t);if(s!=null){let a=e.data.field(s.fieldPath);if(ns(a))for(let l of a.arrayValue.values||[])n=n.add(new zn(t.indexId,e.key,this.dn(l),i))}else n=n.add(new zn(t.indexId,e.key,Bo,i));return n}bn(e,t,n,i,s){O("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let a=[];return function(u,d,m,p,v){let x=u.getIterator(),F=d.getIterator(),L=xr(x),N=xr(F);for(;L||N;){let $=!1,W=!1;if(L&&N){let B=m(L,N);B<0?W=!0:B>0&&($=!0)}else L!=null?W=!0:$=!0;$?(p(N),N=xr(F)):W?(v(L),L=xr(x)):(L=xr(x),N=xr(F))}}(i,s,an,l=>{a.push(this.Dn(e,t,n,l))},l=>{a.push(this.vn(e,t,n,l))}),R.waitFor(a)}yn(e){let t=1;return Rr(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((a,l)=>an(a,l)).filter((a,l,u)=>!l||an(a,u[l-1])!==0);let i=[];i.push(e);for(let a of n){let l=an(a,e),u=an(a,t);if(l===0)i[0]=e.Zt();else if(l>0&&u<0)i.push(a),i.push(a.Zt());else if(u>0)break}i.push(t);let s=[];for(let a=0;a<i.length;a+=2){if(this.Cn(i[a],i[a+1]))return[];let l=[i[a].indexId,this.uid,i[a].arrayValue,i[a].directionalValue,Bo,[]],u=[i[a+1].indexId,this.uid,i[a+1].arrayValue,i[a+1].directionalValue,Bo,[]];s.push(IDBKeyRange.bound(l,u))}return s}Cn(e,t){return an(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Dp)}getMinOffset(e,t){return R.mapArray(this.hn(t),n=>this.Pn(e,n).next(i=>i||G())).next(Dp)}};function kp(r){return De(r,"collectionParents")}function Cr(r){return De(r,"indexEntries")}function Ui(r){return De(r,"indexConfiguration")}function Rr(r){return De(r,"indexState")}function Dp(r){z(r.length!==0);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){let i=r[n].indexState.offset;Ih(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new lt(e.readTime,e.documentKey,t)}var Vp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},at=class r{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new r(e,r.DEFAULT_COLLECTION_PERCENTILE,r.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function t0(r,e,t){let n=r.store("mutations"),i=r.store("documentMutations"),s=[],a=IDBKeyRange.only(t.batchId),l=0,u=n.J({range:a},(m,p,v)=>(l++,v.delete()));s.push(u.next(()=>{z(l===1)}));let d=[];for(let m of t.mutations){let p=lg(e,m.key.path,t.batchId);s.push(i.delete(p)),d.push(m.key)}return R.waitFor(s).next(()=>d)}function pa(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw G();e=r.noDocument}return JSON.stringify(e).length}at.DEFAULT_COLLECTION_PERCENTILE=10,at.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,at.DEFAULT=new at(41943040,at.DEFAULT_COLLECTION_PERCENTILE,at.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),at.DISABLED=new at(-1,0,0);var ga=class r{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Fn={}}static lt(e,t,n,i){z(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new r(s,t,n,i)}checkEmpty(e){let t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ln(e).J({index:"userMutationsIndex",range:n},(i,s,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,n,i){let s=Mr(e),a=ln(e);return a.add({}).next(l=>{z(typeof l=="number");let u=new is(l,t,n,i),d=function(x,F,L){let N=L.baseMutations.map(W=>us(x.ct,W)),$=L.mutations.map(W=>us(x.ct,W));return{userId:F,batchId:L.batchId,localWriteTimeMs:L.localWriteTime.toMillis(),baseMutations:N,mutations:$}}(this.serializer,this.userId,u),m=[],p=new ce((v,x)=>H(v.canonicalString(),x.canonicalString()));for(let v of i){let x=lg(this.userId,v.key.path,l);p=p.add(v.key.path.popLast()),m.push(a.put(d)),m.push(s.put(x,S_))}return p.forEach(v=>{m.push(this.indexManager.addToCollectionParentIndex(e,v))}),e.addOnCommittedListener(()=>{this.Fn[l]=u.keys()}),R.waitFor(m).next(()=>u)})}lookupMutationBatch(e,t){return ln(e).get(t).next(n=>n?(z(n.userId===this.userId),jn(this.serializer,n)):null)}Mn(e,t){return this.Fn[t]?R.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){let i=n.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]),s=null;return ln(e).J({index:"userMutationsIndex",range:i},(a,l,u)=>{l.userId===this.userId&&(z(l.batchId>=n),s=jn(this.serializer,l)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return ln(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,a)=>{n=s.batchId,a.done()}).next(()=>n)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ln(e).U("userMutationsIndex",t).next(n=>n.map(i=>jn(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let n=zo(this.userId,t.path),i=IDBKeyRange.lowerBound(n),s=[];return Mr(e).J({range:i},(a,l,u)=>{let[d,m,p]=a,v=It(m);if(d===this.userId&&t.path.isEqual(v))return ln(e).get(p).next(x=>{if(!x)throw G();z(x.userId===this.userId),s.push(jn(this.serializer,x))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ce(H),i=[];return t.forEach(s=>{let a=zo(this.userId,s.path),l=IDBKeyRange.lowerBound(a),u=Mr(e).J({range:l},(d,m,p)=>{let[v,x,F]=d,L=It(x);v===this.userId&&s.path.isEqual(L)?n=n.add(F):p.done()});i.push(u)}),R.waitFor(i).next(()=>this.xn(e,n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,i=n.length+1,s=zo(this.userId,n),a=IDBKeyRange.lowerBound(s),l=new ce(H);return Mr(e).J({range:a},(u,d,m)=>{let[p,v,x]=u,F=It(v);p===this.userId&&n.isPrefixOf(F)?F.length===i&&(l=l.add(x)):m.done()}).next(()=>this.xn(e,l))}xn(e,t){let n=[],i=[];return t.forEach(s=>{i.push(ln(e).get(s).next(a=>{if(a===null)throw G();z(a.userId===this.userId),n.push(jn(this.serializer,a))}))}),R.waitFor(i).next(()=>n)}removeMutationBatch(e,t){return t0(e._e,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),R.forEach(n,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return R.resolve();let n=IDBKeyRange.lowerBound(function(a){return[a]}(this.userId)),i=[];return Mr(e).J({range:n},(s,a,l)=>{if(s[0]===this.userId){let u=It(s[1]);i.push(u)}else l.done()}).next(()=>{z(i.length===0)})})}containsKey(e,t){return n0(e,this.userId,t)}Nn(e){return r0(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function n0(r,e,t){let n=zo(e,t.path),i=n[1],s=IDBKeyRange.lowerBound(n),a=!1;return Mr(r).J({range:s,H:!0},(l,u,d)=>{let[m,p,v]=l;m===e&&p===i&&(a=!0),d.done()}).next(()=>a)}function ln(r){return De(r,"mutations")}function Mr(r){return De(r,"documentMutations")}function r0(r){return De(r,"mutationQueues")}var Qr=class r{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new r(0)}static kn(){return new r(-1)}};var pc=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{let n=new Qr(t.highestTargetId);return t.highestTargetId=n.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>K.fromTimestamp(new ye(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(n=>(n.targetCount+=1,this.$n(t,n),this.Qn(e,n))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Pr(e).delete(t.targetId)).next(()=>this.qn(e)).next(n=>(z(n.targetCount>0),n.targetCount-=1,this.Qn(e,n)))}removeTargets(e,t,n){let i=0,s=[];return Pr(e).J((a,l)=>{let u=Ki(l);u.sequenceNumber<=t&&n.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>R.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Pr(e).J((n,i)=>{let s=Ki(i);t(s)})}qn(e){return Np(e).get("targetGlobalKey").next(t=>(z(t!==null),t))}Qn(e,t){return Np(e).put("targetGlobalKey",t)}Kn(e,t){return Pr(e).put(Xg(this.serializer,t))}$n(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){let n=Jn(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),s=null;return Pr(e).J({range:i,index:"queryTargetsIndex"},(a,l,u)=>{let d=Ki(l);vs(t,d.target)&&(s=d,u.done())}).next(()=>s)}addMatchingKeys(e,t,n){let i=[],s=un(e);return t.forEach(a=>{let l=Je(a.path);i.push(s.put({targetId:n,path:l})),i.push(this.referenceDelegate.addReference(e,n,a))}),R.waitFor(i)}removeMatchingKeys(e,t,n){let i=un(e);return R.forEach(t,s=>{let a=Je(s.path);return R.waitFor([i.delete([n,a]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){let n=un(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){let n=IDBKeyRange.bound([t],[t+1],!1,!0),i=un(e),s=Z();return i.J({range:n,H:!0},(a,l,u)=>{let d=It(a[1]),m=new j(d);s=s.add(m)}).next(()=>s)}containsKey(e,t){let n=Je(t.path),i=IDBKeyRange.bound([n],[ng(n)],!1,!0),s=0;return un(e).J({index:"documentTargetsIndex",H:!0,range:i},([a,l],u,d)=>{a!==0&&(s++,d.done())}).next(()=>s>0)}ot(e,t){return Pr(e).get(t).next(n=>n?Ki(n):null)}};function Pr(r){return De(r,"targets")}function Np(r){return De(r,"targetGlobal")}function un(r){return De(r,"targetDocuments")}function Mp([r,e],[t,n]){let i=H(r,t);return i===0?H(e,n):i}var gc=class{constructor(e){this.Un=e,this.buffer=new ce(Mp),this.Wn=0}Gn(){return++this.Wn}zn(e){let t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{let n=this.buffer.last();Mp(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}},yc=class{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){O("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>D(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){bn(t)?O("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield In(t)}yield this.Hn(3e5)}))}},_c=class{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return R.resolve(rt.oe);let n=new gc(t);return this.Jn.forEachTarget(e,i=>n.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>n.zn(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(Vp)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Vp):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let n,i,s,a,l,u,d,m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,a=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(n=p,l=Date.now(),this.removeTargets(e,n,t))).next(p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(p=>(d=Date.now(),kr()<=Tt.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-m}ms
	Determined least recently used ${i} in `+(l-a)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-m}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}};function wv(r,e){return new _c(r,e)}var vc=class{constructor(e,t){this.db=e,this.garbageCollector=wv(this,t)}Yn(e){let t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}er(e){let t=0;return this.Zn(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(n,i)=>t(i))}addReference(e,t,n){return Uo(e,n)}removeReference(e,t,n){return Uo(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Uo(e,t)}nr(e,t){return function(i,s){let a=!1;return r0(i).Y(l=>n0(i,l,s).next(u=>(u&&(a=!0),R.resolve(!u)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){let n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.tr(e,(a,l)=>{if(l<=t){let u=this.nr(e,a).next(d=>{if(!d)return s++,n.getEntry(e,a).next(()=>(n.removeEntry(a,K.min()),un(e).delete(function(p){return[0,Je(p.path)]}(a))))});i.push(u)}}).next(()=>R.waitFor(i)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Uo(e,t)}tr(e,t){let n=un(e),i,s=rt.oe;return n.J({index:"documentTargetsIndex"},([a,l],{path:u,sequenceNumber:d})=>{a===0?(s!==rt.oe&&t(new j(It(i)),s),s=d,i=u):s=rt.oe}).next(()=>{s!==rt.oe&&t(new j(It(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Uo(r,e){return un(r).put(function(n,i){return{targetId:0,path:Je(n.path),sequenceNumber:i}}(e,r.currentSequenceNumber))}var ya=class{constructor(){this.changes=new Pt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Re.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return n!==void 0?R.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var wc=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return qn(e).put(n)}removeEntry(e,t,n){return qn(e).delete(function(s,a){let l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],ha(a),l[l.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.rr(e,n)))}getEntry(e,t){let n=Re.newInvalidDocument(t);return qn(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ji(t))},(i,s)=>{n=this.ir(t,s)}).next(()=>n)}sr(e,t){let n={size:0,document:Re.newInvalidDocument(t)};return qn(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ji(t))},(i,s)=>{n={document:this.ir(t,s),size:pa(s)}}).next(()=>n)}getEntries(e,t){let n=et();return this._r(e,t,(i,s)=>{let a=this.ir(i,s);n=n.insert(i,a)}).next(()=>n)}ar(e,t){let n=et(),i=new fe(j.comparator);return this._r(e,t,(s,a)=>{let l=this.ir(s,a);n=n.insert(s,l),i=i.insert(s,pa(a))}).next(()=>({documents:n,ur:i}))}_r(e,t,n){if(t.isEmpty())return R.resolve();let i=new ce(Lp);t.forEach(u=>i=i.add(u));let s=IDBKeyRange.bound(ji(i.first()),ji(i.last())),a=i.getIterator(),l=a.getNext();return qn(e).J({index:"documentKeyIndex",range:s},(u,d,m)=>{let p=j.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;l&&Lp(l,p)<0;)n(l,null),l=a.getNext();l&&l.isEqual(p)&&(n(l,d),l=a.hasNext()?a.getNext():null),l?m.$(ji(l)):m.done()}).next(()=>{for(;l;)n(l,null),l=a.hasNext()?a.getNext():null})}getDocumentsMatchingQuery(e,t,n,i,s){let a=t.path,l=[a.popLast().toArray(),a.lastSegment(),ha(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],u=[a.popLast().toArray(),a.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return qn(e).U(IDBKeyRange.bound(l,u,!0)).next(d=>{s?.incrementDocumentReadCount(d.length);let m=et();for(let p of d){let v=this.ir(j.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);v.isFoundDocument()&&(Es(t,v)||i.has(v.key))&&(m=m.insert(v.key,v))}return m})}getAllFromCollectionGroup(e,t,n,i){let s=et(),a=Op(t,n),l=Op(t,lt.max());return qn(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,l,!0)},(u,d,m)=>{let p=this.ir(j.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);s=s.insert(p.key,p),s.size===i&&m.done()}).next(()=>s)}newChangeBuffer(e){return new Ec(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Fp(e).get("remoteDocumentGlobalKey").next(t=>(z(!!t),t))}rr(e,t){return Fp(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){let n=yv(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(K.min())))return n}return Re.newInvalidDocument(e)}};function i0(r){return new wc(r)}var Ec=class extends ya{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Pt(n=>n.toString(),(n,i)=>n.isEqual(i))}applyChanges(e){let t=[],n=0,i=new ce((s,a)=>H(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{let l=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,l.readTime)),a.isValidDocument()){let u=Ip(this.cr.serializer,a);i=i.add(s.path.popLast());let d=pa(u);n+=d-l.size,t.push(this.cr.addEntry(e,s,u))}else if(n-=l.size,this.trackRemovals){let u=Ip(this.cr.serializer,a.convertToNoDocument(K.min()));t.push(this.cr.addEntry(e,s,u))}}),i.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,n)),R.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(n=>(this.lr.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:n,ur:i})=>(i.forEach((s,a)=>{this.lr.set(s,{size:a,readTime:n.get(s).readTime})}),n))}};function Fp(r){return De(r,"remoteDocumentGlobal")}function qn(r){return De(r,"remoteDocumentsV14")}function ji(r){let e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Op(r,e){let t=e.documentKey.path.toArray();return[r,ha(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Lp(r,e){let t=r.path.toArray(),n=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(i=H(t[s],n[s]),i)return i;return i=H(t.length,n.length),i||(i=H(t[t.length-2],n[n.length-2]),i||H(t[t.length-1],n[n.length-1]))}var Tc=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var _a=class{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&Qi(n.mutation,i,it.empty(),ye.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Z()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Z()){let i=bt();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let a=zi();return s.forEach((l,u)=>{a=a.insert(l,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let n=bt();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Z()))}populateOverlays(e,t,n){let i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,l)=>{t.set(a,l)})})}computeViews(e,t,n,i){let s=et(),a=Wi(),l=function(){return Wi()}();return t.forEach((u,d)=>{let m=n.get(d.key);i.has(d.key)&&(m===void 0||m.mutation instanceof ft)?s=s.insert(d.key,d):m!==void 0?(a.set(d.key,m.mutation.getFieldMask()),Qi(m.mutation,d,m.mutation.getFieldMask(),ye.now())):a.set(d.key,it.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((d,m)=>a.set(d,m)),t.forEach((d,m)=>{var p;return l.set(d,new Tc(m,(p=a.get(d))!==null&&p!==void 0?p:null))}),l))}recalculateAndSaveOverlays(e,t){let n=Wi(),i=new fe((a,l)=>a-l),s=Z();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let l of a)l.keys().forEach(u=>{let d=t.get(u);if(d===null)return;let m=n.get(u)||it.empty();m=l.applyToLocalView(d,m),n.set(u,m);let p=(i.get(l.batchId)||Z()).add(u);i=i.insert(l.batchId,p)})}).next(()=>{let a=[],l=i.getReverseIterator();for(;l.hasNext();){let u=l.getNext(),d=u.key,m=u.value,p=Cg();m.forEach(v=>{if(!s.has(v)){let x=Mg(t.get(v),n.get(v));x!==null&&p.set(v,x),s=s.add(v)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,p))}return R.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(a){return j.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ch(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):R.resolve(bt()),l=-1,u=s;return a.next(d=>R.forEach(d,(m,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(m)?R.resolve():this.remoteDocumentCache.getEntry(e,m).next(v=>{u=u.insert(m,v)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,u,d,Z())).next(m=>({batchId:l,changes:xg(m)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new j(t)).next(n=>{let i=zi();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){let s=t.collectionGroup,a=zi();return this.indexManager.getCollectionParents(e,s).next(l=>R.forEach(l,u=>{let d=function(p,v){return new mt(v,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,n,i).next(m=>{m.forEach((p,v)=>{a=a.insert(p,v)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(a=>{s.forEach((u,d)=>{let m=d.getKey();a.get(m)===null&&(a=a.insert(m,Re.newInvalidDocument(m)))});let l=zi();return a.forEach((u,d)=>{let m=s.get(u);m!==void 0&&Qi(m.mutation,d,it.empty(),ye.now()),Es(t,d)&&(l=l.insert(u,d))}),l})}};var Ic=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return R.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Ie(i.createTime)}}(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:Dh(i.bundledQuery),readTime:Ie(i.readTime)}}(t)),R.resolve()}};var bc=class{constructor(){this.overlays=new fe(j.comparator),this.Ir=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){let n=bt();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.ht(e,t,s)}),R.resolve()}removeOverlaysForBatchId(e,t,n){let i=this.Ir.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(n)),R.resolve()}getOverlaysForCollection(e,t,n){let i=bt(),s=t.length+1,a=new j(t.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){let u=l.getNext().value,d=u.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&u.largestBatchId>n&&i.set(u.getKey(),u)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new fe((d,m)=>d-m),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>n){let m=s.get(d.largestBatchId);m===null&&(m=bt(),s=s.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}let l=bt(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,m)=>l.set(d,m)),!(l.size()>=i)););return R.resolve(l)}ht(e,t,n){let i=this.overlays.get(n.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(n.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new ss(t,n));let s=this.Ir.get(t);s===void 0&&(s=Z(),this.Ir.set(t,s)),this.Ir.set(t,s.add(n.key))}};var Sc=class{constructor(){this.sessionToken=be.EMPTY_BYTE_STRING}getSessionToken(e){return R.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,R.resolve()}};var hs=class{constructor(){this.Tr=new ce(xe.Er),this.dr=new ce(xe.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let n=new xe(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Vr(new xe(e,t))}mr(e,t){e.forEach(n=>this.removeReference(n,t))}gr(e){let t=new j(new se([])),n=new xe(t,e),i=new xe(t,e+1),s=[];return this.dr.forEachInRange([n,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new j(new se([])),n=new xe(t,e),i=new xe(t,e+1),s=Z();return this.dr.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new xe(e,0),n=this.Tr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}},xe=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return j.comparator(e.key,t.key)||H(e.wr,t.wr)}static Ar(e,t){return H(e.wr,t.wr)||j.comparator(e.key,t.key)}};var Ac=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new ce(xe.Er)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new is(s,t,n,i);this.mutationQueue.push(a);for(let l of i)this.br=this.br.add(new xe(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return R.resolve(a)}lookupMutationBatch(e,t){return R.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let n=t+1,i=this.vr(n),s=i<0?0:i;return R.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new xe(t,0),i=new xe(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([n,i],a=>{let l=this.Dr(a.wr);s.push(l)}),R.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ce(H);return t.forEach(i=>{let s=new xe(i,0),a=new xe(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],l=>{n=n.add(l.wr)})}),R.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,i=n.length+1,s=n;j.isDocumentKey(s)||(s=s.child(""));let a=new xe(new j(s),0),l=new ce(H);return this.br.forEachWhile(u=>{let d=u.key.path;return!!n.isPrefixOf(d)&&(d.length===i&&(l=l.add(u.wr)),!0)},a),R.resolve(this.Cr(l))}Cr(e){let t=[];return e.forEach(n=>{let i=this.Dr(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){z(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return R.forEach(t.mutations,i=>{let s=new xe(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,t){let n=new xe(t,0),i=this.br.firstAfterOrEqual(n);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var xc=class{constructor(e){this.Mr=e,this.docs=function(){return new fe(j.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,i=this.docs.get(n),s=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return R.resolve(n?n.document.mutableCopy():Re.newInvalidDocument(t))}getEntries(e,t){let n=et();return t.forEach(i=>{let s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Re.newInvalidDocument(i))}),R.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=et(),a=t.path,l=new j(a.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){let{key:d,value:{document:m}}=u.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||Ih(ig(m),n)<=0||(i.has(m.key)||Es(t,m))&&(s=s.insert(m.key,m.mutableCopy()))}return R.resolve(s)}getAllFromCollectionGroup(e,t,n,i){G()}Or(e,t){return R.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new Cc(this)}getSize(e){return R.resolve(this.size)}},Cc=class extends ya{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(n)}),R.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Rc=class{constructor(e){this.persistence=e,this.Nr=new Pt(t=>Jn(t),vs),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.Lr=0,this.Br=new hs,this.targetCount=0,this.kr=Qr.Bn()}forEachTarget(e,t){return this.Nr.forEach((n,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),R.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Qr(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.Kn(t),R.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,n){let i=0,s=[];return this.Nr.forEach((a,l)=>{l.sequenceNumber<=t&&n.get(l.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),R.waitFor(s).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){let n=this.Nr.get(t)||null;return R.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),R.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),R.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),R.resolve()}getMatchingKeysForTargetId(e,t){let n=this.Br.yr(t);return R.resolve(n)}containsKey(e,t){return R.resolve(this.Br.containsKey(t))}};var va=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new rt(0),this.Kr=!1,this.Kr=!0,this.$r=new Sc,this.referenceDelegate=e(this),this.Ur=new Rc(this),this.indexManager=new mc,this.remoteDocumentCache=function(i){return new xc(i)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new ca(t),this.Gr=new Ic(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new bc,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new Ac(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){O("MemoryPersistence","Starting transaction:",e);let i=new Pc(this.Qr.next());return this.referenceDelegate.zr(),n(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return R.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,t)))}},Pc=class extends Xo{constructor(e){super(),this.currentSequenceNumber=e}},wa=class r{constructor(e){this.persistence=e,this.Jr=new hs,this.Yr=null}static Zr(e){return new r(e)}get Xr(){if(this.Yr)return this.Yr;throw G()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),R.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),R.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Xr,n=>{let i=j.fromPath(n);return this.ei(e,i).next(s=>{s||t.removeEntry(i,K.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(n=>{n?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return R.or([()=>R.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var kc=class{constructor(e){this.serializer=e}O(e,t,n,i){let s=new Zo("createOrUpgrade",t);n<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ep,{unique:!0}),u.createObjectStore("documentMutations")}(e),qp(e),function(u){u.createObjectStore("remoteDocuments")}(e));let a=R.resolve();return n<3&&i>=3&&(n!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),qp(e)),a=a.next(()=>function(u){let d=u.store("targetGlobal"),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:K.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",m)}(s))),n<4&&i>=4&&(n!==0&&(a=a.next(()=>function(u,d){return d.store("mutations").U().next(m=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ep,{unique:!0});let p=d.store("mutations"),v=m.map(x=>p.put(x));return R.waitFor(v)})}(e,s))),a=a.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),n<5&&i>=5&&(a=a.next(()=>this.ni(s))),n<6&&i>=6&&(a=a.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),n<7&&i>=7&&(a=a.next(()=>this.ii(s))),n<8&&i>=8&&(a=a.next(()=>this.si(e,s))),n<9&&i>=9&&(a=a.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&i>=10&&(a=a.next(()=>this.oi(s))),n<11&&i>=11&&(a=a.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&i>=12&&(a=a.next(()=>{(function(u){let d=u.createObjectStore("documentOverlays",{keyPath:O_});d.createIndex("collectionPathOverlayIndex",L_,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",q_,{unique:!1})})(e)})),n<13&&i>=13&&(a=a.next(()=>function(u){let d=u.createObjectStore("remoteDocumentsV14",{keyPath:A_});d.createIndex("documentKeyIndex",x_),d.createIndex("collectionGroupIndex",C_)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&i>=14&&(a=a.next(()=>this.ai(e,s))),n<15&&i>=15&&(a=a.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:V_}).createIndex("sequenceNumberIndex",N_,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:M_}).createIndex("documentKeyIndex",F_,{unique:!1})}(e))),n<16&&i>=16&&(a=a.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),n<17&&i>=17&&(a=a.next(()=>{(function(u){u.createObjectStore("globals",{keyPath:"name"})})(e)})),a}ri(e){let t=0;return e.store("remoteDocuments").J((n,i)=>{t+=pa(i)}).next(()=>{let n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}ni(e){let t=e.store("mutationQueues"),n=e.store("mutations");return t.U().next(i=>R.forEach(i,s=>{let a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",a).next(l=>R.forEach(l,u=>{z(u.userId===s.userId);let d=jn(this.serializer,u);return t0(e,s.userId,d).next(()=>{})}))}))}ii(e){let t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return n.J((a,l)=>{let u=new se(a),d=function(p){return[0,Je(p)]}(u);s.push(t.get(d).next(m=>m?R.resolve():(p=>t.put({targetId:0,path:Je(p),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>R.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:D_});let n=t.store("collectionParents"),i=new cs,s=a=>{if(i.add(a)){let l=a.lastSegment(),u=a.popLast();return n.put({collectionId:l,parent:Je(u)})}};return t.store("remoteDocuments").J({H:!0},(a,l)=>{let u=new se(a);return s(u.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([a,l,u],d)=>{let m=It(l);return s(m.popLast())}))}oi(e){let t=e.store("targets");return t.J((n,i)=>{let s=Ki(i),a=Xg(this.serializer,s);return t.put(a)})}_i(e,t){let n=t.store("remoteDocuments"),i=[];return n.J((s,a)=>{let l=t.store("remoteDocumentsV14"),u=function(p){return p.document?new j(se.fromString(p.document.name).popFirst(5)):p.noDocument?j.fromSegments(p.noDocument.path):p.unknownDocument?j.fromSegments(p.unknownDocument.path):G()}(a).path.toArray(),d={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};i.push(l.put(d))}).next(()=>R.waitFor(i))}ai(e,t){let n=t.store("mutations"),i=i0(this.serializer),s=new va(wa.Zr,this.serializer.ct);return n.U().next(a=>{let l=new Map;return a.forEach(u=>{var d;let m=(d=l.get(u.userId))!==null&&d!==void 0?d:Z();jn(this.serializer,u).keys().forEach(p=>m=m.add(p)),l.set(u.userId,m)}),R.forEach(l,(u,d)=>{let m=new Ce(d),p=da.lt(this.serializer,m),v=s.getIndexManager(m),x=ga.lt(m,this.serializer,v,s.referenceDelegate);return new _a(i,x,p,v).recalculateAndSaveOverlaysForDocumentKeys(new Zi(t,rt.oe),u).next()})})}};function qp(r){r.createObjectStore("targetDocuments",{keyPath:P_}).createIndex("documentTargetsIndex",k_,{unique:!0}),r.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",R_,{unique:!0}),r.createObjectStore("targetGlobal")}var vu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Dc=class r{constructor(e,t,n,i,s,a,l,u,d,m,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.ui=s,this.window=a,this.document=l,this.ci=d,this.li=m,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=v=>Promise.resolve(),!r.D())throw new M(k.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new vc(this,i),this.Ai=t+"main",this.serializer=new ca(u),this.Ri=new fn(this.Ai,this.hi,new kc(this.serializer)),this.$r=new oc,this.Ur=new pc(this.referenceDelegate,this.serializer),this.remoteDocumentCache=i0(this.serializer),this.Gr=new sc,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,m===!1&&Ee("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new M(k.FAILED_PRECONDITION,vu);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new rt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=t=>D(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(t=>D(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(()=>D(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>jo(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(bn(e))return O("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return O("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Gi(e).get("owner").next(t=>R.resolve(this.vi(t)))}Ci(e){return jo(e).delete(this.clientId)}Fi(){return D(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let n=De(t,"clientMetadata");return n.U().next(i=>{let s=this.xi(i,18e5),a=i.filter(l=>s.indexOf(l)===-1);return R.forEach(a,l=>n.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Vi)for(let t of e)this.Vi.removeItem(this.Oi(t.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?R.resolve(!0):Gi(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new M(k.FAILED_PRECONDITION,vu);return!1}}return!(!this.networkEnabled||!this.inForeground)||jo(e).U().next(n=>this.xi(n,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,a=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(s||a&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&O("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return D(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Zi(e,rt.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()})}xi(e,t){return e.filter(n=>this.Mi(n.updateTimeMs,t)&&!this.Ni(n.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>jo(e).U().next(t=>this.xi(t,18e5).map(n=>n.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return ga.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new fc(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return da.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,n){O("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(u){return u===17?j_:u===16?U_:u===15?Sh:u===14?hg:u===13?cg:u===12?B_:u===11?ug:void G()}(this.hi),a;return this.Ri.runTransaction(e,i,s,l=>(a=new Zi(l,this.Qr?this.Qr.next():rt.oe),t==="readwrite-primary"?this.wi(a).next(u=>!!u||this.Si(a)).next(u=>{if(!u)throw Ee(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new M(k.FAILED_PRECONDITION,sg);return n(a)}).next(u=>this.Di(a).next(()=>u)):this.Ki(a).next(()=>n(a)))).then(l=>(a.raiseOnCommittedEvent(),l))}Ki(e){return Gi(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new M(k.FAILED_PRECONDITION,vu)})}Di(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Gi(e).put("owner",t)}static D(){return fn.D()}bi(e){let t=Gi(e);return t.get("owner").next(n=>this.vi(n)?(O("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):R.resolve())}Mi(e,t){let n=Date.now();return!(e<n-t)&&(!(e>n)||(Ee(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let t=/(?:Version|Mobile)\/1[456]/;Wl()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{let n=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return O("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Ee("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Ee("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Gi(r){return De(r,"owner")}function jo(r){return De(r,"clientMetadata")}function Nh(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}var Vc=class r{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=i}static Wi(e,t){let n=Z(),i=Z();for(let s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new r(e,t.fromCache,n,i)}};var Nc=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Ea=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Wl()?8:og(Di())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,i){let s={result:null};return this.Yi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,t,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new Nc;return this.Xi(e,t,a).next(l=>{if(s.result=l,this.zi)return this.es(e,t,a,l.size)})}).next(()=>s.result)}es(e,t,n,i){return n.documentReadCount<this.ji?(kr()<=Tt.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",Dr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),R.resolve()):(kr()<=Tt.DEBUG&&O("QueryEngine","Query:",Dr(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.Hi*i?(kr()<=Tt.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",Dr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ye(t))):R.resolve())}Yi(e,t){if(dp(t))return R.resolve(null);let n=Ye(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=oa(t,null,"F"),n=Ye(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{let a=Z(...s);return this.Ji.getDocuments(e,a).next(l=>this.indexManager.getMinOffset(e,n).next(u=>{let d=this.ts(t,l);return this.ns(t,d,a,u.readTime)?this.Yi(e,oa(t,null,"F")):this.rs(e,d,t,u)}))})))}Zi(e,t,n,i){return dp(t)||i.isEqual(K.min())?R.resolve(null):this.Ji.getDocuments(e,n).next(s=>{let a=this.ts(t,s);return this.ns(t,a,n,i)?R.resolve(null):(kr()<=Tt.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Dr(t)),this.rs(e,a,t,rg(i,-1)).next(l=>l))})}ts(e,t){let n=new ce(Sg(e));return t.forEach((i,s)=>{Es(e,s)&&(n=n.add(s))}),n}ns(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,n){return kr()<=Tt.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",Dr(t)),this.Ji.getDocumentsMatchingQuery(e,t,lt.min(),n)}rs(e,t,n,i){return this.Ji.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var Mc=class{constructor(e,t,n,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new fe(H),this._s=new Pt(s=>Jn(s),vs),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _a(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function s0(r,e,t,n){return new Mc(r,e,t,n)}function o0(r,e){return D(this,null,function*(){let t=U(r);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{let a=[],l=[],u=Z();for(let d of i){a.push(d.batchId);for(let m of d.mutations)u=u.add(m.key)}for(let d of s){l.push(d.batchId);for(let m of d.mutations)u=u.add(m.key)}return t.localDocuments.getDocuments(n,u).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:l}))})})})}function Ev(r,e){let t=U(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,d,m){let p=d.batch,v=p.keys(),x=R.resolve();return v.forEach(F=>{x=x.next(()=>m.getEntry(u,F)).next(L=>{let N=d.docVersions.get(F);z(N!==null),L.version.compareTo(N)<0&&(p.applyToRemoteDocument(L,d),L.isValidDocument()&&(L.setReadTime(d.commitVersion),m.addEntry(L)))})}),x.next(()=>l.mutationQueue.removeMutationBatch(u,p))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let u=Z();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function a0(r){let e=U(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function Tv(r,e){let t=U(r),n=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let l=[];e.targetChanges.forEach((m,p)=>{let v=i.get(p);if(!v)return;l.push(t.Ur.removeMatchingKeys(s,m.removedDocuments,p).next(()=>t.Ur.addMatchingKeys(s,m.addedDocuments,p)));let x=v.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?x=x.withResumeToken(be.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):m.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(m.resumeToken,n)),i=i.insert(p,x),function(L,N,$){return L.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-L.snapshotVersion.toMicroseconds()>=3e8?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0}(v,x,m)&&l.push(t.Ur.updateTargetData(s,x))});let u=et(),d=Z();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,m))}),l.push(l0(s,a,e.documentUpdates).next(m=>{u=m.Ps,d=m.Is})),!n.isEqual(K.min())){let m=t.Ur.getLastRemoteSnapshotVersion(s).next(p=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(m)}return R.waitFor(l).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,d)).next(()=>u)}).then(s=>(t.os=i,s))}function l0(r,e,t){let n=Z(),i=Z();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let a=et();return t.forEach((l,u)=>{let d=s.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(K.min())?(e.removeEntry(l,u.readTime),a=a.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),a=a.insert(l,u)):O("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{Ps:a,Is:i}})}function Iv(r,e){let t=U(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Hr(r,e){let t=U(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Ur.getTargetData(n,e).next(s=>s?(i=s,R.resolve(i)):t.Ur.allocateTargetId(n).next(a=>(i=new Wr(e,a,"TargetPurposeListen",n.currentSequenceNumber),t.Ur.addTargetData(n,i).next(()=>i))))}).then(n=>{let i=t.os.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(n.targetId,n),t._s.set(e,n.targetId)),n})}function Jr(r,e,t){return D(this,null,function*(){let n=U(r),i=n.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!bn(a))throw a;O("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(i.target)})}function Ta(r,e,t){let n=U(r),i=K.min(),s=Z();return n.persistence.runTransaction("Execute query","readwrite",a=>function(u,d,m){let p=U(u),v=p._s.get(m);return v!==void 0?R.resolve(p.os.get(v)):p.Ur.getTargetData(d,m)}(n,a,Ye(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,l.targetId).next(u=>{s=u})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,t?i:K.min(),t?s:Z())).next(l=>(h0(n,bg(e),l),{documents:l,Ts:s})))}function u0(r,e){let t=U(r),n=U(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>n.ot(s,e).next(a=>a?a.target:null))}function c0(r,e){let t=U(r),n=t.us.get(e)||K.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,rg(n,-1),Number.MAX_SAFE_INTEGER)).then(i=>(h0(t,e,i),i))}function h0(r,e,t){let n=r.us.get(e)||K.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.us.set(e,n)}function bv(r,e,t,n){return D(this,null,function*(){let i=U(r),s=Z(),a=et();for(let d of t){let m=e.Es(d.metadata.name);d.document&&(s=s.add(m));let p=e.ds(d);p.setReadTime(e.As(d.metadata.readTime)),a=a.insert(m,p)}let l=i.cs.newChangeBuffer({trackRemovals:!0}),u=yield Hr(i,function(m){return Ye(ii(se.fromString(`__bundle__/docs/${m}`)))}(n));return i.persistence.runTransaction("Apply bundle documents","readwrite",d=>l0(d,l,a).next(m=>(l.apply(d),m)).next(m=>i.Ur.removeMatchingKeysForTargetId(d,u.targetId).next(()=>i.Ur.addMatchingKeys(d,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(d,m.Ps,m.Is)).next(()=>m.Ps)))})}function Sv(n,i){return D(this,arguments,function*(r,e,t=Z()){let s=yield Hr(r,Ye(Dh(e.bundledQuery))),a=U(r);return a.persistence.runTransaction("Save named query","readwrite",l=>{let u=Ie(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return a.Gr.saveNamedQuery(l,e);let d=s.withResumeToken(be.EMPTY_BYTE_STRING,u);return a.os=a.os.insert(d.targetId,d),a.Ur.updateTargetData(l,d).next(()=>a.Ur.removeMatchingKeysForTargetId(l,s.targetId)).next(()=>a.Ur.addMatchingKeys(l,t,s.targetId)).next(()=>a.Gr.saveNamedQuery(l,e))})})}function Bp(r,e){return`firestore_clients_${r}_${e}`}function Up(r,e,t){let n=`firestore_mutations_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}function wu(r,e){return`firestore_targets_${r}_${e}`}var Ia=class r{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static Rs(e,t,n){let i=JSON.parse(n),s,a=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(s=new M(i.error.code,i.error.message))),a?new r(e,t,i.state,s):(Ee("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Hi=class r{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Rs(e,t){let n=JSON.parse(t),i,s=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return s&&n.error&&(s=typeof n.error.message=="string"&&typeof n.error.code=="string",s&&(i=new M(n.error.code,n.error.message))),s?new r(e,n.state,i):(Ee("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},ba=class r{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){let n=JSON.parse(t),i=typeof n=="object"&&n.activeTargetIds instanceof Array,s=Rh();for(let a=0;i&&a<n.activeTargetIds.length;++a)i=ag(n.activeTargetIds[a]),s=s.add(n.activeTargetIds[a]);return i?new r(e,s):(Ee("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},Fc=class r{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new r(t.clientId,t.onlineState):(Ee("SharedClientState",`Failed to parse online state: ${e}`),null)}},ds=class{constructor(){this.activeTargetIds=Rh()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Ji=class{constructor(e,t,n,i,s){this.window=e,this.ui=t,this.persistenceKey=n,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new fe(H),this.started=!1,this.bs=[];let a=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=Bp(this.persistenceKey,this.ps),this.vs=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new ds),this.Cs=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.xs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Os=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){return D(this,null,function*(){let e=yield this.syncEngine.Qi();for(let n of e){if(n===this.ps)continue;let i=this.getItem(Bp(this.persistenceKey,n));if(i){let s=ba.Rs(n,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();let t=this.storage.getItem(this.xs);if(t){let n=this.Ls(t);n&&this.Bs(n)}for(let n of this.bs)this.ws(n);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,n){this.qs(e,t,n),this.Qs(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){let i=this.storage.getItem(wu(this.persistenceKey,e));if(i){let s=Hi.Rs(e,i);s&&(n=s.state)}}return t&&this.Ks.fs(e),this.Ns(),n}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(wu(this.persistenceKey,e))}updateQueryState(e,t,n){this.$s(e,t,n)}handleUserChange(e,t,n){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,n.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return O("SharedClientState","READ",e,t),t}setItem(e,t){O("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){O("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){let t=e;if(t.storageArea===this.storage){if(O("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void Ee("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>D(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let n=this.Gs(t.key);return this.zs(n,null)}{let n=this.js(t.key,t.newValue);if(n)return this.zs(n.clientId,n)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let n=this.Hs(t.key,t.newValue);if(n)return this.Js(n)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){let n=this.Ys(t.key,t.newValue);if(n)return this.Zs(n)}}else if(t.key===this.xs){if(t.newValue!==null){let n=this.Ls(t.newValue);if(n)return this.Bs(n)}}else if(t.key===this.vs){let n=function(s){let a=rt.oe;if(s!=null)try{let l=JSON.parse(s);z(typeof l=="number"),a=l}catch(l){Ee("SharedClientState","Failed to read sequence number from WebStorage",l)}return a}(t.newValue);n!==rt.oe&&this.sequenceNumberHandler(n)}else if(t.key===this.Os){let n=this.Xs(t.newValue);yield Promise.all(n.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,n){let i=new Ia(this.currentUser,e,t,n),s=Up(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){let t=Up(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){let t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,n){let i=wu(this.persistenceKey,e),s=new Hi(e,t,n);this.setItem(i,s.Vs())}Ws(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){let t=this.Cs.exec(e);return t?t[1]:null}js(e,t){let n=this.Gs(e);return ba.Rs(n,t)}Hs(e,t){let n=this.Fs.exec(e),i=Number(n[1]),s=n[2]!==void 0?n[2]:null;return Ia.Rs(new Ce(s),i,t)}Ys(e,t){let n=this.Ms.exec(e),i=Number(n[1]);return Hi.Rs(i,t)}Ls(e){return Fc.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){return D(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);O("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){let n=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(n),a=[],l=[];return s.forEach(u=>{i.has(u)||a.push(u)}),i.forEach(u=>{s.has(u)||l.push(u)}),this.syncEngine.io(a,l).then(()=>{this.Ss=n})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Rh();return e.forEach((n,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},Sa=class{constructor(){this.so=new ds,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new ds,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Oc=class{_o(e){}shutdown(){}};var Aa=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){O("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){O("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Go=null;function Eu(){return Go===null?Go=function(){return 268435456+Math.round(2147483648*Math.random())}():Go++,"0x"+Go.toString(16)}var Av={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Lc=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Ke="WebChannelConnection",qc=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let n=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,n,i,s,a){let l=Eu(),u=this.xo(t,n.toUriEncodedString());O("RestConnection",`Sending RPC '${t}' ${l}:`,u,i);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,s,a),this.No(t,u,d,i).then(m=>(O("RestConnection",`Received RPC '${t}' ${l}: `,m),m),m=>{throw dt("RestConnection",`RPC '${t}' ${l} failed with error: `,m,"url: ",u,"request:",i),m})}Lo(t,n,i,s,a,l){return this.Mo(t,n,i,s,a)}Oo(t,n,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ri}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}xo(t,n){let i=Av[t];return`${this.Do}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,i){let s=Eu();return new Promise((a,l)=>{let u=new mu;u.setWithCredentials(!0),u.listenOnce(fu.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case qi.NO_ERROR:let m=u.getResponseJson();O(Ke,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(m)),a(m);break;case qi.TIMEOUT:O(Ke,`RPC '${e}' ${s} timed out`),l(new M(k.DEADLINE_EXCEEDED,"Request time out"));break;case qi.HTTP_ERROR:let p=u.getStatus();if(O(Ke,`RPC '${e}' ${s} failed with status:`,p,"response text:",u.getResponseText()),p>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);let x=v?.error;if(x&&x.status&&x.message){let F=function(N){let $=N.toLowerCase().replace(/_/g,"-");return Object.values(k).indexOf($)>=0?$:k.UNKNOWN}(x.status);l(new M(F,x.message))}else l(new M(k.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new M(k.UNAVAILABLE,"Connection failed."));break;default:G()}}finally{O(Ke,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(i);O(Ke,`RPC '${e}' ${s} sending request:`,i),u.send(t,"POST",d,n,15)})}Bo(e,t,n){let i=Eu(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=yu(),l=gu(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;let m=s.join("");O(Ke,`Creating RPC '${e}' stream ${i}: ${m}`,u);let p=a.createWebChannel(m,u),v=!1,x=!1,F=new Lc({Io:N=>{x?O(Ke,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(v||(O(Ke,`Opening RPC '${e}' stream ${i} transport.`),p.open(),v=!0),O(Ke,`RPC '${e}' stream ${i} sending:`,N),p.send(N))},To:()=>p.close()}),L=(N,$,W)=>{N.listen($,B=>{try{W(B)}catch(Q){setTimeout(()=>{throw Q},0)}})};return L(p,Ar.EventType.OPEN,()=>{x||(O(Ke,`RPC '${e}' stream ${i} transport opened.`),F.yo())}),L(p,Ar.EventType.CLOSE,()=>{x||(x=!0,O(Ke,`RPC '${e}' stream ${i} transport closed`),F.So())}),L(p,Ar.EventType.ERROR,N=>{x||(x=!0,dt(Ke,`RPC '${e}' stream ${i} transport errored:`,N),F.So(new M(k.UNAVAILABLE,"The operation could not be completed")))}),L(p,Ar.EventType.MESSAGE,N=>{var $;if(!x){let W=N.data[0];z(!!W);let B=W,Q=B.error||(($=B[0])===null||$===void 0?void 0:$.error);if(Q){O(Ke,`RPC '${e}' stream ${i} received error:`,Q);let J=Q.status,Y=function(E){let I=Ae[E];if(I!==void 0)return Lg(I)}(J),T=Q.message;Y===void 0&&(Y=k.INTERNAL,T="Unknown error status: "+J+" with message "+Q.message),x=!0,F.So(new M(Y,T)),p.close()}else O(Ke,`RPC '${e}' stream ${i} received:`,W),F.bo(W)}}),L(l,pu.STAT_EVENT,N=>{N.stat===qo.PROXY?O(Ke,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===qo.NOPROXY&&O(Ke,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{F.wo()},0),F}};function d0(){return typeof window<"u"?window:null}function Qo(){return typeof document<"u"?document:null}function Ts(r){return new ec(r,!0)}var ms=class{constructor(e,t,n=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=n,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-n);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var xa=class{constructor(e,t,n,i,s,a,l,u){this.ui=e,this.Ho=n,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new ms(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return D(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return D(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return D(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===k.RESOURCE_EXHAUSTED?(Ee(t.toString()),Ee("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===k.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Yo===t&&this.P_(n,i)},n=>{e(()=>{let i=new M(k.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(i)})})}P_(e,t){let n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{n(()=>this.I_(i))}),this.stream.onMessage(i=>{n(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>D(this,null,function*(){this.state=0,this.start()}))}I_(e){return O("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(O("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Bc=class extends xa{constructor(e,t,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,a),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=cv(this.serializer,e),n=function(s){if(!("targetChange"in s))return K.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?K.min():a.readTime?Ie(a.readTime):K.min()}(e);return this.listener.d_(t,n)}A_(e){let t={};t.database=rc(this.serializer),t.addTarget=function(s,a){let l,u=a.target;if(l=ia(u)?{documents:$g(s,u)}:{query:Wg(s,u)._t},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=Bg(s,a.resumeToken);let d=tc(s,a.expectedCount);d!==null&&(l.expectedCount=d)}else if(a.snapshotVersion.compareTo(K.min())>0){l.readTime=$r(s,a.snapshotVersion.toTimestamp());let d=tc(s,a.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);let n=dv(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){let t={};t.database=rc(this.serializer),t.removeTarget=e,this.a_(t)}},Uc=class extends xa{constructor(e,t,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return z(!!e.streamToken),this.lastStreamToken=e.streamToken,z(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=hv(e.writeResults,e.commitTime),n=Ie(e.commitTime);return this.listener.g_(n,t)}p_(){let e={};e.database=rc(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(n=>us(this.serializer,n))};this.a_(t)}};var jc=class extends class{}{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new M(k.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,nc(t,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new M(k.UNKNOWN,s.toString())})}Lo(e,t,n,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection.Lo(e,nc(t,n),i,a,l,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new M(k.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Gc=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ee(t),this.D_=!1):O("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var zc=class{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{n.enqueueAndForget(()=>D(this,null,function*(){Sn(this)&&(O("RemoteStore","Restarting streams for network reachability change."),yield function(u){return D(this,null,function*(){let d=U(u);d.L_.add(4),yield si(d),d.q_.set("Unknown"),d.L_.delete(4),yield Is(d)})}(this))}))}),this.q_=new Gc(n,i)}};function Is(r){return D(this,null,function*(){if(Sn(r))for(let e of r.B_)yield e(!0)})}function si(r){return D(this,null,function*(){for(let e of r.B_)yield e(!1)})}function Qa(r,e){let t=U(r);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Oh(t)?Fh(t):ai(t).r_()&&Mh(t,e))}function Yr(r,e){let t=U(r),n=ai(t);t.N_.delete(e),n.r_()&&m0(t,e),t.N_.size===0&&(n.r_()?n.o_():Sn(t)&&t.q_.set("Unknown"))}function Mh(r,e){if(r.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(K.min())>0){let t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ai(r).A_(e)}function m0(r,e){r.Q_.xe(e),ai(r).R_(e)}function Fh(r){r.Q_=new Zu({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>r.N_.get(e)||null,tt:()=>r.datastore.serializer.databaseId}),ai(r).start(),r.q_.v_()}function Oh(r){return Sn(r)&&!ai(r).n_()&&r.N_.size>0}function Sn(r){return U(r).L_.size===0}function f0(r){r.Q_=void 0}function xv(r){return D(this,null,function*(){r.q_.set("Online")})}function Cv(r){return D(this,null,function*(){r.N_.forEach((e,t)=>{Mh(r,e)})})}function Rv(r,e){return D(this,null,function*(){f0(r),Oh(r)?(r.q_.M_(e),Fh(r)):r.q_.set("Unknown")})}function Pv(r,e,t){return D(this,null,function*(){if(r.q_.set("Online"),e instanceof la&&e.state===2&&e.cause)try{yield function(i,s){return D(this,null,function*(){let a=s.cause;for(let l of s.targetIds)i.N_.has(l)&&(yield i.remoteSyncer.rejectListen(l,a),i.N_.delete(l),i.Q_.removeTarget(l))})}(r,e)}catch(n){O("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield Ca(r,n)}else if(e instanceof qr?r.Q_.Ke(e):e instanceof aa?r.Q_.He(e):r.Q_.We(e),!t.isEqual(K.min()))try{let n=yield a0(r.localStore);t.compareTo(n)>=0&&(yield function(s,a){let l=s.Q_.rt(a);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){let m=s.N_.get(d);m&&s.N_.set(d,m.withResumeToken(u.resumeToken,a))}}),l.targetMismatches.forEach((u,d)=>{let m=s.N_.get(u);if(!m)return;s.N_.set(u,m.withResumeToken(be.EMPTY_BYTE_STRING,m.snapshotVersion)),m0(s,u);let p=new Wr(m.target,u,d,m.sequenceNumber);Mh(s,p)}),s.remoteSyncer.applyRemoteEvent(l)}(r,t))}catch(n){O("RemoteStore","Failed to raise snapshot:",n),yield Ca(r,n)}})}function Ca(r,e,t){return D(this,null,function*(){if(!bn(e))throw e;r.L_.add(1),yield si(r),r.q_.set("Offline"),t||(t=()=>a0(r.localStore)),r.asyncQueue.enqueueRetryable(()=>D(this,null,function*(){O("RemoteStore","Retrying IndexedDB access"),yield t(),r.L_.delete(1),yield Is(r)}))})}function p0(r,e){return e().catch(t=>Ca(r,t,e))}function oi(r){return D(this,null,function*(){let e=U(r),t=Tn(e),n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;kv(e);)try{let i=yield Iv(e.localStore,n);if(i===null){e.O_.length===0&&t.o_();break}n=i.batchId,Dv(e,i)}catch(i){yield Ca(e,i)}g0(e)&&y0(e)})}function kv(r){return Sn(r)&&r.O_.length<10}function Dv(r,e){r.O_.push(e);let t=Tn(r);t.r_()&&t.V_&&t.m_(e.mutations)}function g0(r){return Sn(r)&&!Tn(r).n_()&&r.O_.length>0}function y0(r){Tn(r).start()}function Vv(r){return D(this,null,function*(){Tn(r).p_()})}function Nv(r){return D(this,null,function*(){let e=Tn(r);for(let t of r.O_)e.m_(t.mutations)})}function Mv(r,e,t){return D(this,null,function*(){let n=r.O_.shift(),i=Ju.from(n,e,t);yield p0(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),yield oi(r)})}function Fv(r,e){return D(this,null,function*(){e&&Tn(r).V_&&(yield function(n,i){return D(this,null,function*(){if(function(a){return Og(a)&&a!==k.ABORTED}(i.code)){let s=n.O_.shift();Tn(n).s_(),yield p0(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield oi(n)}})}(r,e)),g0(r)&&y0(r)})}function jp(r,e){return D(this,null,function*(){let t=U(r);t.asyncQueue.verifyOperationInProgress(),O("RemoteStore","RemoteStore received new credentials");let n=Sn(t);t.L_.add(3),yield si(t),n&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Is(t)})}function Kc(r,e){return D(this,null,function*(){let t=U(r);e?(t.L_.delete(2),yield Is(t)):e||(t.L_.add(2),yield si(t),t.q_.set("Unknown"))})}function ai(r){return r.K_||(r.K_=function(t,n,i){let s=U(t);return s.w_(),new Bc(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Eo:xv.bind(null,r),Ro:Cv.bind(null,r),mo:Rv.bind(null,r),d_:Pv.bind(null,r)}),r.B_.push(e=>D(this,null,function*(){e?(r.K_.s_(),Oh(r)?Fh(r):r.q_.set("Unknown")):(yield r.K_.stop(),f0(r))}))),r.K_}function Tn(r){return r.U_||(r.U_=function(t,n,i){let s=U(t);return s.w_(),new Uc(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Vv.bind(null,r),mo:Fv.bind(null,r),f_:Nv.bind(null,r),g_:Mv.bind(null,r)}),r.B_.push(e=>D(this,null,function*(){e?(r.U_.s_(),yield oi(r)):(yield r.U_.stop(),r.O_.length>0&&(O("RemoteStore",`Stopping write stream with ${r.O_.length} pending writes`),r.O_=[]))}))),r.U_}var $c=class r{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new ke,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){let a=Date.now()+n,l=new r(e,t,a,i,s);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(k.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function li(r,e){if(Ee("AsyncQueue",`${e}: ${r}`),bn(r))return new M(k.UNAVAILABLE,`${e}: ${r}`);throw r}var Ra=class r{constructor(e){this.comparator=e?(t,n)=>e(t,n)||j.comparator(t.key,n.key):(t,n)=>j.comparator(t.key,n.key),this.keyedMap=zi(),this.sortedSet=new fe(this.comparator)}static emptySet(e){return new r(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof r)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let n=new r;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}};var Pa=class{constructor(){this.W_=new fe(j.comparator)}track(e){let t=e.doc.key,n=this.W_.get(t);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(t,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(t):e.type===1&&n.type===2?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):G():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,n)=>{e.push(n)}),e}},Xr=class r{constructor(e,t,n,i,s,a,l,u,d){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,t,n,i,s){let a=[];return t.forEach(l=>{a.push({type:0,doc:l})}),new r(e,t,Ra.emptySet(t),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ws(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}};var Wc=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},Qc=class{constructor(){this.queries=Gp(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,n){let i=U(t),s=i.queries;i.queries=Gp(),s.forEach((a,l)=>{for(let u of l.j_)u.onError(n)})})(this,new M(k.ABORTED,"Firestore shutting down"))}};function Gp(){return new Pt(r=>Ig(r),ws)}function Lh(r,e){return D(this,null,function*(){let t=U(r),n=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(n=2):(s=new Wc,n=e.J_()?0:1);try{switch(n){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let l=li(a,`Initialization of query '${Dr(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Bh(t)})}function qh(r,e){return D(this,null,function*(){let t=U(r),n=e.query,i=3,s=t.queries.get(n);if(s){let a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}})}function Ov(r,e){let t=U(r),n=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let l of a.j_)l.X_(i)&&(n=!0);a.z_=i}}n&&Bh(t)}function Lv(r,e,t){let n=U(r),i=n.queries.get(e);if(i)for(let s of i.j_)s.onError(t);n.queries.delete(e)}function Bh(r){r.Y_.forEach(e=>{e.next()})}var Hc,zp;(zp=Hc||(Hc={})).ea="default",zp.Cache="cache";var fs=class{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){let n=[];for(let i of e.docChanges)i.type!==3&&n.push(i);e=new Xr(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let n=t!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Xr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Hc.Cache}};var Jc=class{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}};var ka=class{constructor(e){this.serializer=e}Es(e){return At(this.serializer,e)}ds(e){return e.metadata.exists?Kg(this.serializer,e.document,!1):Re.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Ie(e)}},Yc=class{constructor(e,t,n){this.ca=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=_0(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;let n=se.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){let t=new Map,n=new ka(this.serializer);for(let i of e)if(i.metadata.queries){let s=n.Es(i.metadata.name);for(let a of i.metadata.queries){let l=(t.get(a)||Z()).add(s);t.set(a,l)}}return t}complete(){return D(this,null,function*(){let e=yield bv(this.localStore,new ka(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(let n of this.queries)yield Sv(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}})}};function _0(r){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:r.totalDocuments,totalBytes:r.totalBytes}}var Da=class{constructor(e){this.key=e}},Va=class{constructor(e){this.key=e}},Na=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Z(),this.mutatedKeys=Z(),this.Aa=Sg(e),this.Ra=new Ra(this.Aa)}get Va(){return this.Ta}ma(e,t){let n=t?t.fa:new Pa,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,a=i,l=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,p)=>{let v=i.get(m),x=Es(this.query,p)?p:null,F=!!v&&this.mutatedKeys.has(v.key),L=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations),N=!1;v&&x?v.data.isEqual(x.data)?F!==L&&(n.track({type:3,doc:x}),N=!0):this.ga(v,x)||(n.track({type:2,doc:x}),N=!0,(u&&this.Aa(x,u)>0||d&&this.Aa(x,d)<0)&&(l=!0)):!v&&x?(n.track({type:0,doc:x}),N=!0):v&&!x&&(n.track({type:1,doc:v}),N=!0,(u||d)&&(l=!0)),N&&(x?(a=a.add(x),s=L?s.add(m):s.delete(m)):(a=a.delete(m),s=s.delete(m)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let m=this.query.limitType==="F"?a.last():a.first();a=a.delete(m.key),s=s.delete(m.key),n.track({type:1,doc:m})}return{Ra:a,fa:n,ns:l,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((m,p)=>function(x,F){let L=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return G()}};return L(x)-L(F)}(m.type,p.type)||this.Aa(m.doc,p.doc)),this.pa(n),i=i!=null&&i;let l=t&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,d=u!==this.Ea;return this.Ea=u,a.length!==0||d?{snapshot:new Xr(this.query,e.Ra,s,a,e.mutatedKeys,u===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Pa,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=Z(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});let t=[];return e.forEach(n=>{this.da.has(n)||t.push(new Va(n))}),this.da.forEach(n=>{e.has(n)||t.push(new Da(n))}),t}ba(e){this.Ta=e.Ts,this.da=Z();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Xr.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Xc=class{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}},Zc=class{constructor(e){this.key=e,this.va=!1}},eh=class{constructor(e,t,n,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Pt(l=>Ig(l),ws),this.Ma=new Map,this.xa=new Set,this.Oa=new fe(j.comparator),this.Na=new Map,this.La=new hs,this.Ba={},this.ka=new Map,this.qa=Qr.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function qv(r,e,t=!0){return D(this,null,function*(){let n=Ha(r),i,s=n.Fa.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield v0(n,e,t,!0),i})}function Bv(r,e){return D(this,null,function*(){let t=Ha(r);yield v0(t,e,!0,!1)})}function v0(r,e,t,n){return D(this,null,function*(){let i=yield Hr(r.localStore,Ye(e)),s=i.targetId,a=r.sharedClientState.addLocalQueryTarget(s,t),l;return n&&(l=yield Uh(r,e,s,a==="current",i.resumeToken)),r.isPrimaryClient&&t&&Qa(r.remoteStore,i),l})}function Uh(r,e,t,n,i){return D(this,null,function*(){r.Ka=(p,v,x)=>function(L,N,$,W){return D(this,null,function*(){let B=N.view.ma($);B.ns&&(B=yield Ta(L.localStore,N.query,!1).then(({documents:T})=>N.view.ma(T,B)));let Q=W&&W.targetChanges.get(N.targetId),J=W&&W.targetMismatches.get(N.targetId)!=null,Y=N.view.applyChanges(B,L.isPrimaryClient,Q,J);return th(L,N.targetId,Y.wa),Y.snapshot})}(r,p,v,x);let s=yield Ta(r.localStore,e,!0),a=new Na(e,s.Ts),l=a.ma(s.documents),u=as.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),d=a.applyChanges(l,r.isPrimaryClient,u);th(r,t,d.wa);let m=new Xc(e,t,a);return r.Fa.set(e,m),r.Ma.has(t)?r.Ma.get(t).push(e):r.Ma.set(t,[e]),d.snapshot})}function Uv(r,e,t){return D(this,null,function*(){let n=U(r),i=n.Fa.get(e),s=n.Ma.get(i.targetId);if(s.length>1)return n.Ma.set(i.targetId,s.filter(a=>!ws(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Jr(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&Yr(n.remoteStore,i.targetId),Zr(n,i.targetId)}).catch(In))):(Zr(n,i.targetId),yield Jr(n.localStore,i.targetId,!0))})}function jv(r,e){return D(this,null,function*(){let t=U(r),n=t.Fa.get(e),i=t.Ma.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Yr(t.remoteStore,n.targetId))})}function Gv(r,e,t){return D(this,null,function*(){let n=Kh(r);try{let i=yield function(a,l){let u=U(a),d=ye.now(),m=l.reduce((x,F)=>x.add(F.key),Z()),p,v;return u.persistence.runTransaction("Locally write mutations","readwrite",x=>{let F=et(),L=Z();return u.cs.getEntries(x,m).next(N=>{F=N,F.forEach(($,W)=>{W.isValidDocument()||(L=L.add($))})}).next(()=>u.localDocuments.getOverlayedDocuments(x,F)).next(N=>{p=N;let $=[];for(let W of l){let B=rv(W,p.get(W.key).overlayedDocument);B!=null&&$.push(new ft(W.key,B,gg(B.value.mapValue),we.exists(!0)))}return u.mutationQueue.addMutationBatch(x,d,$,l)}).next(N=>{v=N;let $=N.applyToLocalDocumentSet(p,L);return u.documentOverlayCache.saveOverlays(x,N.batchId,$)})}).then(()=>({batchId:v.batchId,changes:xg(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,l,u){let d=a.Ba[a.currentUser.toKey()];d||(d=new fe(H)),d=d.insert(l,u),a.Ba[a.currentUser.toKey()]=d}(n,i.batchId,t),yield Kt(n,i.changes),yield oi(n.remoteStore)}catch(i){let s=li(i,"Failed to persist write");t.reject(s)}})}function w0(r,e){return D(this,null,function*(){let t=U(r);try{let n=yield Tv(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t.Na.get(s);a&&(z(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?z(a.va):i.removedDocuments.size>0&&(z(a.va),a.va=!1))}),yield Kt(t,n,e)}catch(n){yield In(n)}})}function Kp(r,e,t){let n=U(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){let i=[];n.Fa.forEach((s,a)=>{let l=a.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(a,l){let u=U(a);u.onlineState=l;let d=!1;u.queries.forEach((m,p)=>{for(let v of p.j_)v.Z_(l)&&(d=!0)}),d&&Bh(u)}(n.eventManager,e),i.length&&n.Ca.d_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function zv(r,e,t){return D(this,null,function*(){let n=U(r);n.sharedClientState.updateQueryState(e,"rejected",t);let i=n.Na.get(e),s=i&&i.key;if(s){let a=new fe(j.comparator);a=a.insert(s,Re.newNoDocument(s,K.min()));let l=Z().add(s),u=new os(K.min(),new Map,new fe(H),a,l);yield w0(n,u),n.Oa=n.Oa.remove(s),n.Na.delete(e),zh(n)}else yield Jr(n.localStore,e,!1).then(()=>Zr(n,e,t)).catch(In)})}function Kv(r,e){return D(this,null,function*(){let t=U(r),n=e.batch.batchId;try{let i=yield Ev(t.localStore,e);Gh(t,n,null),jh(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield Kt(t,i)}catch(i){yield In(i)}})}function $v(r,e,t){return D(this,null,function*(){let n=U(r);try{let i=yield function(a,l){let u=U(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let m;return u.mutationQueue.lookupMutationBatch(d,l).next(p=>(z(p!==null),m=p.keys(),u.mutationQueue.removeMutationBatch(d,p))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,m,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m)).next(()=>u.localDocuments.getDocuments(d,m))})}(n.localStore,e);Gh(n,e,t),jh(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield Kt(n,i)}catch(i){yield In(i)}})}function Wv(r,e){return D(this,null,function*(){let t=U(r);Sn(t.remoteStore)||O("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let n=yield function(a){let l=U(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>l.mutationQueue.getHighestUnacknowledgedBatchId(u))}(t.localStore);if(n===-1)return void e.resolve();let i=t.ka.get(n)||[];i.push(e),t.ka.set(n,i)}catch(n){let i=li(n,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function jh(r,e){(r.ka.get(e)||[]).forEach(t=>{t.resolve()}),r.ka.delete(e)}function Gh(r,e,t){let n=U(r),i=n.Ba[n.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Ba[n.currentUser.toKey()]=i}}function Zr(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(let n of r.Ma.get(e))r.Fa.delete(n),t&&r.Ca.$a(n,t);r.Ma.delete(e),r.isPrimaryClient&&r.La.gr(e).forEach(n=>{r.La.containsKey(n)||E0(r,n)})}function E0(r,e){r.xa.delete(e.path.canonicalString());let t=r.Oa.get(e);t!==null&&(Yr(r.remoteStore,t),r.Oa=r.Oa.remove(e),r.Na.delete(t),zh(r))}function th(r,e,t){for(let n of t)n instanceof Da?(r.La.addReference(n.key,e),Qv(r,n)):n instanceof Va?(O("SyncEngine","Document no longer in limbo: "+n.key),r.La.removeReference(n.key,e),r.La.containsKey(n.key)||E0(r,n.key)):G()}function Qv(r,e){let t=e.key,n=t.path.canonicalString();r.Oa.get(t)||r.xa.has(n)||(O("SyncEngine","New document in limbo: "+t),r.xa.add(n),zh(r))}function zh(r){for(;r.xa.size>0&&r.Oa.size<r.maxConcurrentLimboResolutions;){let e=r.xa.values().next().value;r.xa.delete(e);let t=new j(se.fromString(e)),n=r.qa.next();r.Na.set(n,new Zc(t)),r.Oa=r.Oa.insert(t,n),Qa(r.remoteStore,new Wr(Ye(ii(t.path)),n,"TargetPurposeLimboResolution",rt.oe))}}function Kt(r,e,t){return D(this,null,function*(){let n=U(r),i=[],s=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((l,u)=>{a.push(n.Ka(u,e,t).then(d=>{var m;if((d||t)&&n.isPrimaryClient){let p=d?!d.fromCache:(m=t?.targetChanges.get(u.targetId))===null||m===void 0?void 0:m.current;n.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(d){i.push(d);let p=Vc.Wi(u.targetId,d);s.push(p)}}))}),yield Promise.all(a),n.Ca.d_(i),yield function(u,d){return D(this,null,function*(){let m=U(u);try{yield m.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>R.forEach(d,v=>R.forEach(v.$i,x=>m.persistence.referenceDelegate.addReference(p,v.targetId,x)).next(()=>R.forEach(v.Ui,x=>m.persistence.referenceDelegate.removeReference(p,v.targetId,x)))))}catch(p){if(!bn(p))throw p;O("LocalStore","Failed to update sequence numbers: "+p)}for(let p of d){let v=p.targetId;if(!p.fromCache){let x=m.os.get(v),F=x.snapshotVersion,L=x.withLastLimboFreeSnapshotVersion(F);m.os=m.os.insert(v,L)}}})}(n.localStore,s))})}function Hv(r,e){return D(this,null,function*(){let t=U(r);if(!t.currentUser.isEqual(e)){O("SyncEngine","User change. New user:",e.toKey());let n=yield o0(t.localStore,e);t.currentUser=e,function(s,a){s.ka.forEach(l=>{l.forEach(u=>{u.reject(new M(k.CANCELLED,a))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield Kt(t,n.hs)}})}function Jv(r,e){let t=U(r),n=t.Na.get(e);if(n&&n.va)return Z().add(n.key);{let i=Z(),s=t.Ma.get(e);if(!s)return i;for(let a of s){let l=t.Fa.get(a);i=i.unionWith(l.view.Va)}return i}}function Yv(r,e){return D(this,null,function*(){let t=U(r),n=yield Ta(t.localStore,e.query,!0),i=e.view.ba(n);return t.isPrimaryClient&&th(t,e.targetId,i.wa),i})}function Xv(r,e){return D(this,null,function*(){let t=U(r);return c0(t.localStore,e).then(n=>Kt(t,n))})}function Zv(r,e,t,n){return D(this,null,function*(){let i=U(r),s=yield function(l,u){let d=U(l),m=U(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",p=>m.Mn(p,u).next(v=>v?d.localDocuments.getDocuments(p,v):R.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield oi(i.remoteStore):t==="acknowledged"||t==="rejected"?(Gh(i,e,n||null),jh(i,e),function(l,u){U(U(l).mutationQueue).On(u)}(i.localStore,e)):G(),yield Kt(i,s)):O("SyncEngine","Cannot apply mutation batch with id: "+e)})}function e2(r,e){return D(this,null,function*(){let t=U(r);if(Ha(t),Kh(t),e===!0&&t.Qa!==!0){let n=t.sharedClientState.getAllActiveQueryTargets(),i=yield $p(t,n.toArray());t.Qa=!0,yield Kc(t.remoteStore,!0);for(let s of i)Qa(t.remoteStore,s)}else if(e===!1&&t.Qa!==!1){let n=[],i=Promise.resolve();t.Ma.forEach((s,a)=>{t.sharedClientState.isLocalQueryTarget(a)?n.push(a):i=i.then(()=>(Zr(t,a),Jr(t.localStore,a,!0))),Yr(t.remoteStore,a)}),yield i,yield $p(t,n),function(a){let l=U(a);l.Na.forEach((u,d)=>{Yr(l.remoteStore,d)}),l.La.pr(),l.Na=new Map,l.Oa=new fe(j.comparator)}(t),t.Qa=!1,yield Kc(t.remoteStore,!1)}})}function $p(r,e,t){return D(this,null,function*(){let n=U(r),i=[],s=[];for(let a of e){let l,u=n.Ma.get(a);if(u&&u.length!==0){l=yield Hr(n.localStore,Ye(u[0]));for(let d of u){let m=n.Fa.get(d),p=yield Yv(n,m);p.snapshot&&s.push(p.snapshot)}}else{let d=yield u0(n.localStore,a);l=yield Hr(n.localStore,d),yield Uh(n,T0(d),a,!1,l.resumeToken)}i.push(l)}return n.Ca.d_(s),i})}function T0(r){return Tg(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function t2(r){return function(t){return U(U(t).persistence).Qi()}(U(r).localStore)}function n2(r,e,t,n){return D(this,null,function*(){let i=U(r);if(i.Qa)return void O("SyncEngine","Ignoring unexpected query state notification.");let s=i.Ma.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let a=yield c0(i.localStore,bg(s[0])),l=os.createSynthesizedRemoteEventForCurrentChange(e,t==="current",be.EMPTY_BYTE_STRING);yield Kt(i,a,l);break}case"rejected":yield Jr(i.localStore,e,!0),Zr(i,e,n);break;default:G()}})}function r2(r,e,t){return D(this,null,function*(){let n=Ha(r);if(n.Qa){for(let i of e){if(n.Ma.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){O("SyncEngine","Adding an already active target "+i);continue}let s=yield u0(n.localStore,i),a=yield Hr(n.localStore,s);yield Uh(n,T0(s),a.targetId,!1,a.resumeToken),Qa(n.remoteStore,a)}for(let i of t)n.Ma.has(i)&&(yield Jr(n.localStore,i,!1).then(()=>{Yr(n.remoteStore,i),Zr(n,i)}).catch(In))}})}function Ha(r){let e=U(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=w0.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Jv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=zv.bind(null,e),e.Ca.d_=Ov.bind(null,e.eventManager),e.Ca.$a=Lv.bind(null,e.eventManager),e}function Kh(r){let e=U(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Kv.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=$v.bind(null,e),e}function i2(r,e,t){let n=U(r);(function(s,a,l){return D(this,null,function*(){try{let u=yield a.getMetadata();if(yield function(x,F){let L=U(x),N=Ie(F.createTime);return L.persistence.runTransaction("hasNewerBundle","readonly",$=>L.Gr.getBundleMetadata($,F.id)).then($=>!!$&&$.createTime.compareTo(N)>=0)}(s.localStore,u))return yield a.close(),l._completeWith(function(x){return{taskState:"Success",documentsLoaded:x.totalDocuments,bytesLoaded:x.totalBytes,totalDocuments:x.totalDocuments,totalBytes:x.totalBytes}}(u)),Promise.resolve(new Set);l._updateProgress(_0(u));let d=new Yc(u,s.localStore,a.serializer),m=yield a.Ua();for(;m;){let v=yield d.la(m);v&&l._updateProgress(v),m=yield a.Ua()}let p=yield d.complete();return yield Kt(s,p.Ia,void 0),yield function(x,F){let L=U(x);return L.persistence.runTransaction("Save bundle","readwrite",N=>L.Gr.saveBundleMetadata(N,F))}(s.localStore,u),l._completeWith(p.progress),Promise.resolve(p.Pa)}catch(u){return dt("SyncEngine",`Loading bundle failed with ${u}`),l._failWith(u),Promise.resolve(new Set)}})})(n,e,t).then(i=>{n.sharedClientState.notifyBundleLoaded(i)})}var nh=(()=>{class r{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return D(this,null,function*(){this.serializer=Ts(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,n){return null}Ha(t,n){return null}za(t){return s0(this.persistence,new Ea,t.initialUser,this.serializer)}Ga(t){return new va(wa.Zr,this.serializer)}Wa(t){return new Sa}terminate(){return D(this,null,function*(){var t,n;(t=this.gcScheduler)===null||t===void 0||t.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return r.provider={build:()=>new r},r})();var Ma=class r extends nh{constructor(e,t,n){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){return D(this,null,function*(){yield Nl(r.prototype,this,"initialize").call(this,e),yield this.Ja.initialize(this,e),yield Kh(this.Ja.syncEngine),yield oi(this.Ja.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}za(e){return s0(this.persistence,new Ea,e.initialUser,this.serializer)}ja(e,t){let n=this.persistence.referenceDelegate.garbageCollector;return new yc(n,e.asyncQueue,t)}Ha(e,t){let n=new Nu(t,this.persistence);return new Vu(e.asyncQueue,n)}Ga(e){let t=Nh(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?at.withCacheSize(this.cacheSizeBytes):at.DEFAULT;return new Dc(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,d0(),Qo(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new Sa}},rh=class r extends Ma{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return D(this,null,function*(){yield Nl(r.prototype,this,"initialize").call(this,e);let t=this.Ja.syncEngine;this.sharedClientState instanceof Ji&&(this.sharedClientState.syncEngine={no:Zv.bind(null,t),ro:n2.bind(null,t),io:r2.bind(null,t),Qi:t2.bind(null,t),eo:Xv.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.yi(n=>D(this,null,function*(){yield e2(this.Ja.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())}))})}Wa(e){let t=d0();if(!Ji.D(t))throw new M(k.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let n=Nh(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ji(t,e.asyncQueue,n,e.clientId,e.initialUser)}},$h=(()=>{class r{initialize(t,n){return D(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Kp(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=Hv.bind(null,this.syncEngine),yield Kc(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Qc}()}createDatastore(t){let n=Ts(t.databaseInfo.databaseId),i=function(a){return new qc(a)}(t.databaseInfo);return function(a,l,u,d){return new jc(a,l,u,d)}(t.authCredentials,t.appCheckCredentials,i,n)}createRemoteStore(t){return function(i,s,a,l,u){return new zc(i,s,a,l,u)}(this.localStore,this.datastore,t.asyncQueue,n=>Kp(this.syncEngine,n,0),function(){return Aa.D()?new Aa:new Oc}())}createSyncEngine(t,n){return function(s,a,l,u,d,m,p){let v=new eh(s,a,l,u,d,m);return p&&(v.Qa=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,n)}terminate(){return D(this,null,function*(){var t,n;yield function(s){return D(this,null,function*(){let a=U(s);O("RemoteStore","RemoteStore shutting down."),a.L_.add(5),yield si(a),a.k_.shutdown(),a.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()})}}return r.provider={build:()=>new r},r})();function Wp(r,e=10240){let t=0;return{read(){return D(this,null,function*(){if(t<r.byteLength){let i={value:r.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return D(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var ei=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ee("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var ih=class{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new ke,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(n=>{n&&n.ua()?this.metadata.resolve(n.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(n?.aa)}`))},n=>this.metadata.reject(n))}close(){return this.Xa.cancel()}getMetadata(){return D(this,null,function*(){return this.metadata.promise})}Ua(){return D(this,null,function*(){return yield this.getMetadata(),this.tu()})}tu(){return D(this,null,function*(){let e=yield this.nu();if(e===null)return null;let t=this.eu.decode(e),n=Number(t);isNaN(n)&&this.ru(`length string (${t}) is not valid number`);let i=yield this.iu(n);return new Jc(JSON.parse(i),e.length+n)})}su(){return this.buffer.findIndex(e=>e===123)}nu(){return D(this,null,function*(){for(;this.su()<0&&!(yield this.ou()););if(this.buffer.length===0)return null;let e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}iu(e){return D(this,null,function*(){for(;this.buffer.length<e;)(yield this.ou())&&this.ru("Reached the end of bundle when more is expected.");let t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}ou(){return D(this,null,function*(){let e=yield this.Xa.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var sh=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return D(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new M(k.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return D(this,null,function*(){let a=U(i),l={documents:s.map(p=>ls(a.serializer,p))},u=yield a.Lo("BatchGetDocuments",a.serializer.databaseId,se.emptyPath(),l,s.length),d=new Map;u.forEach(p=>{let v=uv(a.serializer,p);d.set(v.key.toString(),v)});let m=[];return s.forEach(p=>{let v=d.get(p.toString());z(!!v),m.push(v)}),m})}(this.datastore,e);return t.forEach(n=>this.recordVersion(n)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new En(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return D(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,n)=>{let i=j.fromPath(n);this.mutations.push(new rs(i,this.precondition(i)))}),yield function(n,i){return D(this,null,function*(){let s=U(n),a={writes:i.map(l=>us(s.serializer,l))};yield s.Mo("Commit",s.serializer.databaseId,se.emptyPath(),a)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw G();t=K.min()}let n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new M(k.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(K.min())?we.exists(!1):we.updateTime(t):we.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(K.min()))throw new M(k.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return we.updateTime(t)}return we.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var oh=class{constructor(e,t,n,i,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=i,this.deferred=s,this._u=n.maxAttempts,this.t_=new ms(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(()=>D(this,null,function*(){let e=new sh(this.datastore),t=this.cu(e);t&&t.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(i=>{this.lu(i)}))}).catch(n=>{this.lu(n)})}))}cu(e){try{let t=this.updateFunction(e);return!_s(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Og(t)}return!1}};var ah=class{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Ce.UNAUTHENTICATED,this.clientId=Jo.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,a=>D(this,null,function*(){O("FirestoreClient","Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(n,a=>(O("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ke;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>D(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let n=li(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}};function Tu(r,e){return D(this,null,function*(){r.asyncQueue.verifyOperationInProgress(),O("FirestoreClient","Initializing OfflineComponentProvider");let t=r.configuration;yield e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(i=>D(this,null,function*(){n.isEqual(i)||(yield o0(e.localStore,i),n=i)})),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e})}function Qp(r,e){return D(this,null,function*(){r.asyncQueue.verifyOperationInProgress();let t=yield Wh(r);O("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>jp(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>jp(e.remoteStore,i)),r._onlineComponents=e})}function Wh(r){return D(this,null,function*(){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){O("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Tu(r,r._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===k.FAILED_PRECONDITION||i.code===k.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;dt("Error using user provided cache. Falling back to memory cache: "+t),yield Tu(r,new nh)}}else O("FirestoreClient","Using default OfflineComponentProvider"),yield Tu(r,new nh);return r._offlineComponents})}function Ja(r){return D(this,null,function*(){return r._onlineComponents||(r._uninitializedComponentsProvider?(O("FirestoreClient","Using user provided OnlineComponentProvider"),yield Qp(r,r._uninitializedComponentsProvider._online)):(O("FirestoreClient","Using default OnlineComponentProvider"),yield Qp(r,new $h))),r._onlineComponents})}function I0(r){return Wh(r).then(e=>e.persistence)}function Qh(r){return Wh(r).then(e=>e.localStore)}function b0(r){return Ja(r).then(e=>e.remoteStore)}function Hh(r){return Ja(r).then(e=>e.syncEngine)}function s2(r){return Ja(r).then(e=>e.datastore)}function ti(r){return D(this,null,function*(){let e=yield Ja(r),t=e.eventManager;return t.onListen=qv.bind(null,e.syncEngine),t.onUnlisten=Uv.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Bv.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=jv.bind(null,e.syncEngine),t})}function o2(r){return r.asyncQueue.enqueue(()=>D(this,null,function*(){let e=yield I0(r),t=yield b0(r);return e.setNetworkEnabled(!0),function(i){let s=U(i);return s.L_.delete(0),Is(s)}(t)}))}function a2(r){return r.asyncQueue.enqueue(()=>D(this,null,function*(){let e=yield I0(r),t=yield b0(r);return e.setNetworkEnabled(!1),function(i){return D(this,null,function*(){let s=U(i);s.L_.add(0),yield si(s),s.q_.set("Offline")})}(t)}))}function l2(r,e){let t=new ke;return r.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){return function(i,s,a){return D(this,null,function*(){try{let l=yield function(d,m){let p=U(d);return p.persistence.runTransaction("read document","readonly",v=>p.localDocuments.getDocument(v,m))}(i,s);l.isFoundDocument()?a.resolve(l):l.isNoDocument()?a.resolve(null):a.reject(new M(k.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){let u=li(l,`Failed to get document '${s} from cache`);a.reject(u)}})}(yield Qh(r),e,t)})),t.promise}function S0(r,e,t={}){let n=new ke;return r.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){return function(s,a,l,u,d){let m=new ei({next:v=>{m.Za(),a.enqueueAndForget(()=>qh(s,p));let x=v.docs.has(l);!x&&v.fromCache?d.reject(new M(k.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&v.fromCache&&u&&u.source==="server"?d.reject(new M(k.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(v)},error:v=>d.reject(v)}),p=new fs(ii(l.path),m,{includeMetadataChanges:!0,_a:!0});return Lh(s,p)}(yield ti(r),r.asyncQueue,e,t,n)})),n.promise}function u2(r,e){let t=new ke;return r.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){return function(i,s,a){return D(this,null,function*(){try{let l=yield Ta(i,s,!0),u=new Na(s,l.Ts),d=u.ma(l.documents),m=u.applyChanges(d,!1);a.resolve(m.snapshot)}catch(l){let u=li(l,`Failed to execute query '${s} against cache`);a.reject(u)}})}(yield Qh(r),e,t)})),t.promise}function A0(r,e,t={}){let n=new ke;return r.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){return function(s,a,l,u,d){let m=new ei({next:v=>{m.Za(),a.enqueueAndForget(()=>qh(s,p)),v.fromCache&&u.source==="server"?d.reject(new M(k.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(v)},error:v=>d.reject(v)}),p=new fs(l,m,{includeMetadataChanges:!0,_a:!0});return Lh(s,p)}(yield ti(r),r.asyncQueue,e,t,n)})),n.promise}function c2(r,e){let t=new ei(e);return r.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){return function(i,s){U(i).Y_.add(s),s.next()}(yield ti(r),t)})),()=>{t.Za(),r.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){return function(i,s){U(i).Y_.delete(s)}(yield ti(r),t)}))}}function h2(r,e,t,n){let i=function(a,l){let u;return u=typeof a=="string"?qg().encode(a):a,function(m,p){return new ih(m,p)}(function(m,p){if(m instanceof Uint8Array)return Wp(m,p);if(m instanceof ArrayBuffer)return Wp(new Uint8Array(m),p);if(m instanceof ReadableStream)return m.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),l)}(t,Ts(e));r.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){i2(yield Hh(r),i,n)}))}function d2(r,e){return r.asyncQueue.enqueue(()=>D(this,null,function*(){return function(n,i){let s=U(n);return s.persistence.runTransaction("Get named query","readonly",a=>s.Gr.getNamedQuery(a,i))}(yield Qh(r),e)}))}function x0(r){let e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}var Hp=new Map;function Jh(r,e,t){if(!t)throw new M(k.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function Yh(r,e,t,n){if(e===!0&&n===!0)throw new M(k.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function Jp(r){if(!j.isDocumentKey(r))throw new M(k.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function Yp(r){if(j.isDocumentKey(r))throw new M(k.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function Ya(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{let e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":G()}function oe(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new M(k.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Ya(r);throw new M(k.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function C0(r,e){if(e<=0)throw new M(k.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}var Fa=class{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new M(k.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new M(k.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Yh("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=x0((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new M(k.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new M(k.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new M(k.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},er=class{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Fa({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new M(k.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new M(k.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Fa(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Iu;switch(n.type){case"firstParty":return new xu(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new M(k.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return D(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let n=Hp.get(t);n&&(O("ComponentProvider","Removing Datastore"),Hp.delete(t),n.terminate())}(this),Promise.resolve()}};function R0(r,e,t,n={}){var i;let s=(r=oe(r,er))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&dt("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),r._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let l,u;if(typeof n.mockUserToken=="string")l=n.mockUserToken,u=Ce.MOCK_USER;else{l=Sf(n.mockUserToken,(i=r._app)===null||i===void 0?void 0:i.options.projectId);let d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new M(k.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Ce(d)}r._authCredentials=new bu(new Ho(l,u))}}var Oe=class r{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new r(this.firestore,e,this._query)}},he=class r{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new r(this.firestore,e,this._key)}},xt=class r extends Oe{constructor(e,t,n){super(e,t,ii(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new he(this.firestore,null,new j(e))}withConverter(e){return new r(this.firestore,e,this._path)}};function Xh(r,e,...t){if(r=ge(r),Jh("collection","path",e),r instanceof er){let n=se.fromString(e,...t);return Yp(n),new xt(r,null,n)}{if(!(r instanceof he||r instanceof xt))throw new M(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=r._path.child(se.fromString(e,...t));return Yp(n),new xt(r.firestore,null,n)}}function P0(r,e){if(r=oe(r,er),Jh("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new M(k.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Oe(r,null,function(n){return new mt(se.emptyPath(),n)}(e))}function bs(r,e,...t){if(r=ge(r),arguments.length===1&&(e=Jo.newId()),Jh("doc","path",e),r instanceof er){let n=se.fromString(e,...t);return Jp(n),new he(r,null,new j(n))}{if(!(r instanceof he||r instanceof xt))throw new M(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=r._path.child(se.fromString(e,...t));return Jp(n),new he(r.firestore,r instanceof xt?r.converter:null,new j(n))}}function Zh(r,e){return r=ge(r),e=ge(e),(r instanceof he||r instanceof xt)&&(e instanceof he||e instanceof xt)&&r.firestore===e.firestore&&r.path===e.path&&r.converter===e.converter}function ed(r,e){return r=ge(r),e=ge(e),r instanceof Oe&&e instanceof Oe&&r.firestore===e.firestore&&ws(r._query,e._query)&&r.converter===e.converter}var Oa=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new ms(this,"async_queue_retry"),this.Vu=()=>{let n=Qo();n&&O("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;let t=Qo();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=Qo();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new ke;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return D(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!bn(e))throw e;O("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;let i=function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),l}(n);throw Ee("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.du=!1,n))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=$c.createAndSchedule(this,e,t,n,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&G()}verifyOperationInProgress(){}wu(){return D(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function lh(r){return function(t,n){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(r,["next","error","complete"])}var uh=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new ke,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var k0=-1,_e=class extends er{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new Oa,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return D(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Oa(e),this._firestoreClient=void 0,yield e}})}};function Le(r){if(r._terminated)throw new M(k.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||D0(r),r._firestoreClient}function D0(r){var e,t,n;let i=r._freezeSettings(),s=function(l,u,d,m){return new Mu(l,u,d,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,x0(m.experimentalLongPollingOptions),m.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new ah(r._authCredentials,r._appCheckCredentials,r._queue,s,r._componentsProvider&&function(l){let u=l?._online.build();return{_offline:l?._offline.build(u),_online:u}}(r._componentsProvider))}function V0(r,e){dt("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=r._freezeSettings();return M0(r,$h.provider,{build:n=>new Ma(n,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function N0(r){return D(this,null,function*(){dt("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=r._freezeSettings();M0(r,$h.provider,{build:t=>new rh(t,e.cacheSizeBytes)})})}function M0(r,e,t){if((r=oe(r,_e))._firestoreClient||r._terminated)throw new M(k.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(r._componentsProvider||r._getSettings().localCache)throw new M(k.FAILED_PRECONDITION,"SDK cache is already specified.");r._componentsProvider={_online:e,_offline:t},D0(r)}function F0(r){if(r._initialized&&!r._terminated)throw new M(k.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new ke;return r._queue.enqueueAndForgetEvenWhileRestricted(()=>D(this,null,function*(){try{yield function(n){return D(this,null,function*(){if(!fn.D())return Promise.resolve();let i=n+"main";yield fn.delete(i)})}(Nh(r._databaseId,r._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function O0(r){return function(t){let n=new ke;return t.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){return Wv(yield Hh(t),n)})),n.promise}(Le(r=oe(r,_e)))}function L0(r){return o2(Le(r=oe(r,_e)))}function q0(r){return a2(Le(r=oe(r,_e)))}function B0(r,e){let t=Le(r=oe(r,_e)),n=new uh;return h2(t,r._databaseId,e,n),n}function U0(r,e){return d2(Le(r=oe(r,_e)),e).then(t=>t?new Oe(r,null,t.query):null)}var kt=class r{constructor(e){this._byteString=e}static fromBase64String(e){try{return new r(be.fromBase64String(e))}catch(t){throw new M(k.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new r(be.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var pt=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new M(k.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Te(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Gt=class{constructor(e){this._methodName=e}};var tr=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new M(k.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new M(k.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return H(this._lat,e._lat)||H(this._long,e._long)}};var ps=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}};var m2=/^__.*__$/,ch=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new ft(e,this.data,this.fieldMask,t,this.fieldTransforms):new wn(e,this.data,t,this.fieldTransforms)}},La=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ft(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function j0(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw G()}}var qa=class r{constructor(e,t,n,i,s,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new r(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.Ou(e),i}Nu(e){var t;let n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:n,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ba(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(j0(this.Cu)&&m2.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},hh=class{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Ts(e)}Qu(e,t,n,i=!1){return new qa({Cu:e,methodName:t,qu:n,path:Te.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function sr(r){let e=r._freezeSettings(),t=Ts(r._databaseId);return new hh(r._databaseId,!!e.ignoreUndefinedProperties,t)}function Xa(r,e,t,n,i,s={}){let a=r.Qu(s.merge||s.mergeFields?2:0,e,t,i);rd("Data must be an object, but it was:",a,n);let l=K0(n,a),u,d;if(s.merge)u=new it(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){let m=[];for(let p of s.mergeFields){let v=gh(e,p,t);if(!a.contains(v))throw new M(k.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);W0(m,v)||m.push(v)}u=new it(m),d=a.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,d=a.fieldTransforms;return new ch(new $e(l),u,d)}var gs=class r extends Gt{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof r}};function G0(r,e,t){return new qa({Cu:3,qu:e.settings.qu,methodName:r._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var dh=class r extends Gt{_toFieldTransform(e){return new Yn(e.path,new _n)}isEqual(e){return e instanceof r}},mh=class r extends Gt{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=G0(this,e,!0),n=this.Ku.map(s=>or(s,t)),i=new Ut(n);return new Yn(e.path,i)}isEqual(e){return e instanceof r&&Ql(this.Ku,e.Ku)}},fh=class r extends Gt{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){let t=G0(this,e,!0),n=this.Ku.map(s=>or(s,t)),i=new jt(n);return new Yn(e.path,i)}isEqual(e){return e instanceof r&&Ql(this.Ku,e.Ku)}},ph=class r extends Gt{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){let t=new vn(e.serializer,Pg(e.serializer,this.$u));return new Yn(e.path,t)}isEqual(e){return e instanceof r&&this.$u===e.$u}};function td(r,e,t,n){let i=r.Qu(1,e,t);rd("Data must be an object, but it was:",i,n);let s=[],a=$e.empty();ir(n,(u,d)=>{let m=id(e,u,t);d=ge(d);let p=i.Nu(m);if(d instanceof gs)s.push(m);else{let v=or(d,p);v!=null&&(s.push(m),a.set(m,v))}});let l=new it(s);return new La(a,l,i.fieldTransforms)}function nd(r,e,t,n,i,s){let a=r.Qu(1,e,t),l=[gh(e,n,t)],u=[i];if(s.length%2!=0)throw new M(k.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<s.length;v+=2)l.push(gh(e,s[v])),u.push(s[v+1]);let d=[],m=$e.empty();for(let v=l.length-1;v>=0;--v)if(!W0(d,l[v])){let x=l[v],F=u[v];F=ge(F);let L=a.Nu(x);if(F instanceof gs)d.push(x);else{let N=or(F,L);N!=null&&(d.push(x),m.set(x,N))}}let p=new it(d);return new La(m,p,a.fieldTransforms)}function z0(r,e,t,n=!1){return or(t,r.Qu(n?4:3,e))}function or(r,e){if($0(r=ge(r)))return rd("Unsupported field value:",e,r),K0(r,e);if(r instanceof Gt)return function(n,i){if(!j0(i.Cu))throw i.Bu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${n._methodName}() is not currently supported inside arrays`);let s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,i){let s=[],a=0;for(let l of n){let u=or(l,i.Lu(a));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),a++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=ge(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Pg(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let s=ye.fromDate(n);return{timestampValue:$r(i.serializer,s)}}if(n instanceof ye){let s=new ye(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:$r(i.serializer,s)}}if(n instanceof tr)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof kt)return{bytesValue:Bg(i.serializer,n._byteString)};if(n instanceof he){let s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:kh(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof ps)return function(a,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return Ph(l.serializer,u)})}}}}}}(n,i);throw i.Bu(`Unsupported field value: ${Ya(n)}`)}(r,e)}function K0(r,e){let t={};return dg(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ir(r,(n,i)=>{let s=or(i,e.Mu(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function $0(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof ye||r instanceof tr||r instanceof kt||r instanceof he||r instanceof Gt||r instanceof ps)}function rd(r,e,t){if(!$0(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let n=Ya(t);throw n==="an object"?e.Bu(r+" a custom object"):e.Bu(r+" "+n)}}function gh(r,e,t){if((e=ge(e))instanceof pt)return e._internalPath;if(typeof e=="string")return id(r,e);throw Ba("Field path arguments must be of type string or ",r,!1,void 0,t)}var f2=new RegExp("[~\\*/\\[\\]]");function id(r,e,t){if(e.search(f2)>=0)throw Ba(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new pt(...e.split("."))._internalPath}catch{throw Ba(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function Ba(r,e,t,n,i){let s=n&&!n.isEmpty(),a=i!==void 0,l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||a)&&(u+=" (found",s&&(u+=` in field ${n}`),a&&(u+=` in document ${i}`),u+=")"),new M(k.INVALID_ARGUMENT,l+r+u)}function W0(r,e){return r.some(t=>t.isEqual(e))}var nr=class{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new he(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new yh(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Za("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},yh=class extends nr{data(){return super.data()}};function Za(r,e){return typeof e=="string"?id(r,e):e instanceof pt?e._internalPath:e._delegate._internalPath}function Q0(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new M(k.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ys=class{},rr=class extends ys{};function $t(r,e,...t){let n=[];e instanceof ys&&n.push(e),n=n.concat(t),function(s){let a=s.filter(u=>u instanceof _h).length,l=s.filter(u=>u instanceof Ua).length;if(a>1||a>0&&l>0)throw new M(k.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(let i of n)r=i._apply(r);return r}var Ua=class r extends rr{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new r(e,t,n)}_apply(e){let t=this._parse(e);return i1(e._query,t),new Oe(e.firestore,e.converter,Qu(e._query,t))}_parse(e){let t=sr(e.firestore);return function(s,a,l,u,d,m,p){let v;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new M(k.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){Zp(p,m);let x=[];for(let F of p)x.push(Xp(u,s,F));v={arrayValue:{values:x}}}else v=Xp(u,s,p)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||Zp(p,m),v=z0(l,a,p,m==="in"||m==="not-in");return ne.create(d,m,v)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function H0(r,e,t){let n=e,i=Za("where",r);return Ua._create(i,n,t)}var _h=class r extends ys{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new r(e,t)}_parse(e){let t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:le.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i,l=s.getFlattenedFilters();for(let u of l)i1(a,u),a=Qu(a,u)}(e._query,t),new Oe(e.firestore,e.converter,Qu(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var vh=class r extends rr{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new r(e,t)}_apply(e){let t=function(i,s,a){if(i.startAt!==null)throw new M(k.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new M(k.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Hn(s,a)}(e._query,this._field,this._direction);return new Oe(e.firestore,e.converter,function(i,s){let a=i.explicitOrderBy.concat([s]);return new mt(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function J0(r,e="asc"){let t=e,n=Za("orderBy",r);return vh._create(n,t)}var ja=class r extends rr{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new r(e,t,n)}_apply(e){return new Oe(e.firestore,e.converter,oa(e._query,this._limit,this._limitType))}};function Y0(r){return C0("limit",r),ja._create("limit",r,"F")}function X0(r){return C0("limitToLast",r),ja._create("limitToLast",r,"L")}var Ga=class r extends rr{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new r(e,t,n)}_apply(e){let t=r1(e,this.type,this._docOrFields,this._inclusive);return new Oe(e.firestore,e.converter,function(i,s){return new mt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function Z0(...r){return Ga._create("startAt",r,!0)}function e1(...r){return Ga._create("startAfter",r,!1)}var za=class r extends rr{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new r(e,t,n)}_apply(e){let t=r1(e,this.type,this._docOrFields,this._inclusive);return new Oe(e.firestore,e.converter,function(i,s){return new mt(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function t1(...r){return za._create("endBefore",r,!1)}function n1(...r){return za._create("endAt",r,!0)}function r1(r,e,t,n){if(t[0]=ge(t[0]),t[0]instanceof nr)return function(s,a,l,u,d){if(!u)throw new M(k.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);let m=[];for(let p of Lr(s))if(p.field.isKeyField())m.push(Qn(a,u.key));else{let v=u.data.field(p.field);if($a(v))throw new M(k.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(v===null){let x=p.field.canonicalString();throw new M(k.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${x}' (used as the orderBy) does not exist.`)}m.push(v)}return new Rt(m,d)}(r._query,r.firestore._databaseId,e,t[0]._document,n);{let i=sr(r.firestore);return function(a,l,u,d,m,p){let v=a.explicitOrderBy;if(m.length>v.length)throw new M(k.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let x=[];for(let F=0;F<m.length;F++){let L=m[F];if(v[F].field.isKeyField()){if(typeof L!="string")throw new M(k.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof L}`);if(!Ch(a)&&L.indexOf("/")!==-1)throw new M(k.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${L}' contains a slash.`);let N=a.path.child(se.fromString(L));if(!j.isDocumentKey(N))throw new M(k.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);let $=new j(N);x.push(Qn(l,$))}else{let N=z0(u,d,L);x.push(N)}}return new Rt(x,p)}(r._query,r.firestore._databaseId,i,e,t,n)}}function Xp(r,e,t){if(typeof(t=ge(t))=="string"){if(t==="")throw new M(k.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ch(e)&&t.indexOf("/")!==-1)throw new M(k.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let n=e.path.child(se.fromString(t));if(!j.isDocumentKey(n))throw new M(k.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Qn(r,new j(n))}if(t instanceof he)return Qn(r,t._key);throw new M(k.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ya(t)}.`)}function Zp(r,e){if(!Array.isArray(r)||r.length===0)throw new M(k.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function i1(r,e){let t=function(i,s){for(let a of i)for(let l of a.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new M(k.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new M(k.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var ni=class{convertValue(e,t="none"){switch(Wn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return pe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(pn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw G()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let n={};return ir(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,i;let s=(i=(n=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>pe(a.doubleValue));return new ps(s)}convertGeoPoint(e){return new tr(pe(e.latitude),pe(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":let n=Ah(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(es(e));default:return null}}convertTimestamp(e){let t=Bt(e);return new ye(t.seconds,t.nanos)}convertDocumentKey(e,t){let n=se.fromString(e);z(Yg(n));let i=new gn(n.get(1),n.get(3)),s=new j(n.popFirst(5));return i.isEqual(t)||Ee(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function el(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}var wh=class extends ni{constructor(e){super(),this.firestore=e}convertBytes(e){return new kt(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new he(this.firestore,null,t)}};var qt=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},ut=class extends nr{constructor(e,t,n,i,s,a){super(e,t,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new dn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let n=this._document.data.field(Za("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}},dn=class extends ut{data(e={}){return super.data(e)}},gt=class{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new qt(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new dn(this._firestore,this._userDataWriter,n.key,n,new qt(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new M(k.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(l=>{let u=new dn(i._firestore,i._userDataWriter,l.doc.key,l.doc,new qt(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{let u=new dn(i._firestore,i._userDataWriter,l.doc.key,l.doc,new qt(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,m=-1;return l.type!==0&&(d=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),m=a.indexOf(l.doc.key)),{type:p2(l.type),doc:u,oldIndex:d,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function p2(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return G()}}function sd(r,e){return r instanceof ut&&e instanceof ut?r._firestore===e._firestore&&r._key.isEqual(e._key)&&(r._document===null?e._document===null:r._document.isEqual(e._document))&&r._converter===e._converter:r instanceof gt&&e instanceof gt&&r._firestore===e._firestore&&ed(r.query,e.query)&&r.metadata.isEqual(e.metadata)&&r._snapshot.isEqual(e._snapshot)}function s1(r){r=oe(r,he);let e=oe(r.firestore,_e);return S0(Le(e),r._key).then(t=>ud(e,r,t))}var zt=class extends ni{constructor(e){super(),this.firestore=e}convertBytes(e){return new kt(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new he(this.firestore,null,t)}};function o1(r){r=oe(r,he);let e=oe(r.firestore,_e),t=Le(e),n=new zt(e);return l2(t,r._key).then(i=>new ut(e,n,r._key,i,new qt(i!==null&&i.hasLocalMutations,!0),r.converter))}function a1(r){r=oe(r,he);let e=oe(r.firestore,_e);return S0(Le(e),r._key,{source:"server"}).then(t=>ud(e,r,t))}function l1(r){r=oe(r,Oe);let e=oe(r.firestore,_e),t=Le(e),n=new zt(e);return Q0(r._query),A0(t,r._query).then(i=>new gt(e,n,r,i))}function u1(r){r=oe(r,Oe);let e=oe(r.firestore,_e),t=Le(e),n=new zt(e);return u2(t,r._query).then(i=>new gt(e,n,r,i))}function c1(r){r=oe(r,Oe);let e=oe(r.firestore,_e),t=Le(e),n=new zt(e);return A0(t,r._query,{source:"server"}).then(i=>new gt(e,n,r,i))}function od(r,e,t){r=oe(r,he);let n=oe(r.firestore,_e),i=el(r.converter,e,t);return ui(n,[Xa(sr(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,we.none())])}function ad(r,e,t,...n){r=oe(r,he);let i=oe(r.firestore,_e),s=sr(i),a;return a=typeof(e=ge(e))=="string"||e instanceof pt?nd(s,"updateDoc",r._key,e,t,n):td(s,"updateDoc",r._key,e),ui(i,[a.toMutation(r._key,we.exists(!0))])}function h1(r){return ui(oe(r.firestore,_e),[new En(r._key,we.none())])}function d1(r,e){let t=oe(r.firestore,_e),n=bs(r),i=el(r.converter,e);return ui(t,[Xa(sr(r.firestore),"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,we.exists(!1))]).then(()=>n)}function ld(r,...e){var t,n,i;r=ge(r);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||lh(e[a])||(s=e[a],a++);let l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(lh(e[a])){let p=e[a];e[a]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[a+1]=(n=p.error)===null||n===void 0?void 0:n.bind(p),e[a+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let u,d,m;if(r instanceof he)d=oe(r.firestore,_e),m=ii(r._key.path),u={next:p=>{e[a]&&e[a](ud(d,r,p))},error:e[a+1],complete:e[a+2]};else{let p=oe(r,Oe);d=oe(p.firestore,_e),m=p._query;let v=new zt(d);u={next:x=>{e[a]&&e[a](new gt(d,v,p,x))},error:e[a+1],complete:e[a+2]},Q0(r._query)}return function(v,x,F,L){let N=new ei(L),$=new fs(x,N,F);return v.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){return Lh(yield ti(v),$)})),()=>{N.Za(),v.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){return qh(yield ti(v),$)}))}}(Le(d),m,l,u)}function m1(r,e){return c2(Le(r=oe(r,_e)),lh(e)?e:{next:e})}function ui(r,e){return function(n,i){let s=new ke;return n.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){return Gv(yield Hh(n),i,s)})),s.promise}(Le(r),e)}function ud(r,e,t){let n=t.docs.get(e._key),i=new zt(r);return new ut(r,i,e._key,n,new qt(t.hasPendingWrites,t.fromCache),e.converter)}var g2={maxAttempts:5};var Ka=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=sr(e)}set(e,t,n){this._verifyNotCommitted();let i=cn(e,this._firestore),s=el(i.converter,t,n),a=Xa(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(a.toMutation(i._key,we.none())),this}update(e,t,n,...i){this._verifyNotCommitted();let s=cn(e,this._firestore),a;return a=typeof(t=ge(t))=="string"||t instanceof pt?nd(this._dataReader,"WriteBatch.update",s._key,t,n,i):td(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,we.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=cn(e,this._firestore);return this._mutations=this._mutations.concat(new En(t._key,we.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new M(k.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function cn(r,e){if((r=ge(r)).firestore!==e)throw new M(k.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}var Eh=class extends class{constructor(t,n){this._firestore=t,this._transaction=n,this._dataReader=sr(t)}get(t){let n=cn(t,this._firestore),i=new wh(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return G();let a=s[0];if(a.isFoundDocument())return new nr(this._firestore,i,a.key,a,n.converter);if(a.isNoDocument())return new nr(this._firestore,i,n._key,null,n.converter);throw G()})}set(t,n,i){let s=cn(t,this._firestore),a=el(s.converter,n,i),l=Xa(this._dataReader,"Transaction.set",s._key,a,s.converter!==null,i);return this._transaction.set(s._key,l),this}update(t,n,i,...s){let a=cn(t,this._firestore),l;return l=typeof(n=ge(n))=="string"||n instanceof pt?nd(this._dataReader,"Transaction.update",a._key,n,i,s):td(this._dataReader,"Transaction.update",a._key,n),this._transaction.update(a._key,l),this}delete(t){let n=cn(t,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=cn(e,this._firestore),n=new zt(this._firestore);return super.get(e).then(i=>new ut(this._firestore,n,t._key,i._document,new qt(!1,!1),t.converter))}};function f1(r,e,t){r=oe(r,_e);let n=Object.assign(Object.assign({},g2),t);return function(s){if(s.maxAttempts<1)throw new M(k.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,a,l){let u=new ke;return s.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){let d=yield s2(s);new oh(s.asyncQueue,d,l,a,u).au()})),u.promise}(Le(r),i=>e(new Eh(r,i)),n)}function p1(){return new gs("deleteField")}function g1(){return new dh("serverTimestamp")}function y1(...r){return new mh("arrayUnion",r)}function _1(...r){return new fh("arrayRemove",r)}function v1(r){return new ph("increment",r)}(function(e,t=!0){(function(i){ri=i})(Cf),Vi(new On("firestore",(n,{instanceIdentifier:i,options:s})=>{let a=n.getProvider("app").getImmediate(),l=new _e(new Su(n.getProvider("auth-internal")),new Ru(n.getProvider("app-check-internal")),function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new M(k.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gn(d.options.projectId,m)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),rn(Yf,"4.7.3",e),rn(Yf,"4.7.3","esm2017")})();var y2="@firebase/firestore-compat",_2="0.3.38";function pd(r,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new M("invalid-argument",`Invalid options passed to function ${r}(): You cannot specify both "merge" and "mergeFields".`);return e}function w1(){if(typeof Uint8Array>"u")throw new M("unimplemented","Uint8Arrays are not available in this environment.")}function E1(){if(!mg())throw new M("unimplemented","Blobs are unavailable in Firestore in this environment.")}var tl=class r{constructor(e){this._delegate=e}static fromBase64String(e){return E1(),new r(kt.fromBase64String(e))}static fromUint8Array(e){return w1(),new r(kt.fromUint8Array(e))}toBase64(){return E1(),this._delegate.toBase64()}toUint8Array(){return w1(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function cd(r){return v2(r,["next","error","complete"])}function v2(r,e){if(typeof r!="object"||r===null)return!1;let t=r;for(let n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}var hd=class{enableIndexedDbPersistence(e,t){return V0(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return N0(e._delegate)}clearIndexedDbPersistence(e){return F0(e._delegate)}},nl=class{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof gn||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&dt("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,n={}){R0(this._delegate,e,t,n)}enableNetwork(){return L0(this._delegate)}disableNetwork(){return q0(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,Yh("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return O0(this._delegate)}onSnapshotsInSync(e){return m1(this._delegate,e)}get app(){if(!this._appCompat)throw new M("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new di(this,Xh(this._delegate,e))}catch(t){throw Xe(t,"collection()","Firestore.collection()")}}doc(e){try{return new Dt(this,bs(this._delegate,e))}catch(t){throw Xe(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new cr(this,P0(this._delegate,e))}catch(t){throw Xe(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return f1(this._delegate,t=>e(new rl(this,t)))}batch(){return Le(this._delegate),new il(new Ka(this._delegate,e=>ui(this._delegate,e)))}loadBundle(e){return B0(this._delegate,e)}namedQuery(e){return U0(this._delegate,e).then(t=>t?new cr(this,t):null)}},ci=class extends ni{constructor(e){super(),this.firestore=e}convertBytes(e){return new tl(new kt(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Dt.forKey(t,this.firestore,null)}};function w2(r){eg(r)}var rl=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new ci(e)}get(e){let t=ar(e);return this._delegate.get(t).then(n=>new lr(this._firestore,new ut(this._firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,t.converter)))}set(e,t,n){let i=ar(e);return n?(pd("Transaction.set",n),this._delegate.set(i,t,n)):this._delegate.set(i,t),this}update(e,t,n,...i){let s=ar(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,n,...i),this}delete(e){let t=ar(e);return this._delegate.delete(t),this}},il=class{constructor(e){this._delegate=e}set(e,t,n){let i=ar(e);return n?(pd("WriteBatch.set",n),this._delegate.set(i,t,n)):this._delegate.set(i,t),this}update(e,t,n,...i){let s=ar(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,n,...i),this}delete(e){let t=ar(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},hi=class r{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){let n=new dn(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new ur(this._firestore,n),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let n=r.INSTANCES,i=n.get(e);i||(i=new WeakMap,n.set(e,i));let s=i.get(t);return s||(s=new r(e,new ci(e),t),i.set(t,s)),s}};hi.INSTANCES=new WeakMap;var Dt=class r{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ci(e)}static forPath(e,t,n){if(e.length%2!==0)throw new M("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new r(t,new he(t._delegate,n,new j(e)))}static forKey(e,t,n){return new r(t,new he(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new di(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new di(this.firestore,Xh(this._delegate,e))}catch(t){throw Xe(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ge(e),e instanceof he?Zh(this._delegate,e):!1}set(e,t){t=pd("DocumentReference.set",t);try{return t?od(this._delegate,e,t):od(this._delegate,e)}catch(n){throw Xe(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return arguments.length===1?ad(this._delegate,e):ad(this._delegate,e,t,...n)}catch(i){throw Xe(i,"updateDoc()","DocumentReference.update()")}}delete(){return h1(this._delegate)}onSnapshot(...e){let t=T1(e),n=I1(e,i=>new lr(this.firestore,new ut(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return ld(this._delegate,t,n)}get(e){let t;return e?.source==="cache"?t=o1(this._delegate):e?.source==="server"?t=a1(this._delegate):t=s1(this._delegate),t.then(n=>new lr(this.firestore,new ut(this.firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,this._delegate.converter)))}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(hi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Xe(r,e,t){return r.message=r.message.replace(e,t),r}function T1(r){for(let e of r)if(typeof e=="object"&&!cd(e))return e;return{}}function I1(r,e){var t,n;let i;return cd(r[0])?i=r[0]:cd(r[1])?i=r[1]:typeof r[0]=="function"?i={next:r[0],error:r[1],complete:r[2]}:i={next:r[1],error:r[2],complete:r[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(n=i.complete)===null||n===void 0?void 0:n.bind(i)}}var lr=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Dt(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return sd(this._delegate,e._delegate)}},ur=class extends lr{data(e){let t=this._delegate.data(e);return this._delegate._converter||tg(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},cr=class r{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ci(e)}where(e,t,n){try{return new r(this.firestore,$t(this._delegate,H0(e,t,n)))}catch(i){throw Xe(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new r(this.firestore,$t(this._delegate,J0(e,t)))}catch(n){throw Xe(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new r(this.firestore,$t(this._delegate,Y0(e)))}catch(t){throw Xe(t,"limit()","Query.limit()")}}limitToLast(e){try{return new r(this.firestore,$t(this._delegate,X0(e)))}catch(t){throw Xe(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new r(this.firestore,$t(this._delegate,Z0(...e)))}catch(t){throw Xe(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new r(this.firestore,$t(this._delegate,e1(...e)))}catch(t){throw Xe(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new r(this.firestore,$t(this._delegate,t1(...e)))}catch(t){throw Xe(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new r(this.firestore,$t(this._delegate,n1(...e)))}catch(t){throw Xe(t,"endAt()","Query.endAt()")}}isEqual(e){return ed(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=u1(this._delegate):e?.source==="server"?t=c1(this._delegate):t=l1(this._delegate),t.then(n=>new Ss(this.firestore,new gt(this.firestore._delegate,this._userDataWriter,this._delegate,n._snapshot)))}onSnapshot(...e){let t=T1(e),n=I1(e,i=>new Ss(this.firestore,new gt(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return ld(this._delegate,t,n)}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(hi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},dd=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new ur(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Ss=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new cr(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new ur(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new dd(this._firestore,t))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new ur(this._firestore,n))})}isEqual(e){return sd(this._delegate,e._delegate)}},di=class r extends cr{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Dt(this.firestore,e):null}doc(e){try{return e===void 0?new Dt(this.firestore,bs(this._delegate)):new Dt(this.firestore,bs(this._delegate,e))}catch(t){throw Xe(t,"doc()","CollectionReference.doc()")}}add(e){return d1(this._delegate,e).then(t=>new Dt(this.firestore,t))}isEqual(e){return Zh(this._delegate,e._delegate)}withConverter(e){return new r(this.firestore,e?this._delegate.withConverter(hi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function ar(r){return oe(r,he)}var md=class r{constructor(...e){this._delegate=new pt(...e)}static documentId(){return new r(Te.keyField().canonicalString())}isEqual(e){return e=ge(e),e instanceof pt?this._delegate._internalPath.isEqual(e._internalPath):!1}};var fd=class r{constructor(e){this._delegate=e}static serverTimestamp(){let e=g1();return e._methodName="FieldValue.serverTimestamp",new r(e)}static delete(){let e=p1();return e._methodName="FieldValue.delete",new r(e)}static arrayUnion(...e){let t=y1(...e);return t._methodName="FieldValue.arrayUnion",new r(t)}static arrayRemove(...e){let t=_1(...e);return t._methodName="FieldValue.arrayRemove",new r(t)}static increment(e){let t=v1(e);return t._methodName="FieldValue.increment",new r(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var E2={Firestore:nl,GeoPoint:tr,Timestamp:ye,Blob:tl,Transaction:rl,WriteBatch:il,DocumentReference:Dt,DocumentSnapshot:lr,Query:cr,QueryDocumentSnapshot:ur,QuerySnapshot:Ss,CollectionReference:di,FieldPath:md,FieldValue:fd,setLogLevel:w2,CACHE_SIZE_UNLIMITED:k0};function T2(r,e){r.INTERNAL.registerComponent(new On("firestore-compat",t=>{let n=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(n,i)},"PUBLIC").setServiceProps(Object.assign({},E2)))}function I2(r){T2(r,(e,t)=>new nl(e,t,new hd)),r.registerVersion(y2,_2)}I2(nt);function b2(r,e=Gs){return new pr(t=>{let n;return e!=null?e.schedule(()=>{n=r.onSnapshot({includeMetadataChanges:!0},t)}):n=r.onSnapshot({includeMetadataChanges:!0},t),()=>{n?.()}})}function b1(r,e){return b2(r,e)}function S2(r,e){return b1(r,e).pipe($s(void 0),zs(),He(t=>{let[n,i]=t;return i.exists?n?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function _d(r,e){return b1(r,e).pipe(He(t=>({payload:t,type:"query"})))}var sl=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let n=this.ref.collection(e),{ref:i,query:s}=x1(n,t);return new al(i,s,this.afs)}snapshotChanges(){return S2(this.ref,this.afs.schedulers.outsideAngular).pipe(Ze)}valueChanges(e={}){return this.snapshotChanges().pipe(He(({payload:t})=>e.idField?Pn(Yt({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return Xt(this.ref.get(e)).pipe(Ze)}};function ol(r,e){return _d(r,e).pipe($s(void 0),zs(),He(t=>{let[n,i]=t,s=i.payload.docChanges(),a=s.map(l=>({type:l.type,payload:l}));return n&&JSON.stringify(n.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((l,u)=>{let d=s.find(p=>p.doc.ref.isEqual(l.ref)),m=n?.payload.docs.find(p=>p.ref.isEqual(l.ref));d&&JSON.stringify(d.doc.metadata)===JSON.stringify(l.metadata)||!d&&m&&JSON.stringify(m.metadata)===JSON.stringify(l.metadata)||a.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:l}})}),a}))}function S1(r,e,t){return ol(r,t).pipe(Ks((n,i)=>A2(n,i.map(s=>s.payload),e),[]),bm(),He(n=>n.map(i=>({type:i.type,payload:i}))))}function A2(r,e,t){return e.forEach(n=>{t.indexOf(n.type)>-1&&(r=x2(r,n))}),r}function gd(r,e,t,...n){let i=r.slice();return i.splice(e,t,...n),i}function x2(r,e){switch(e.type){case"added":if(!(r[e.newIndex]&&r[e.newIndex].doc.ref.isEqual(e.doc.ref)))return gd(r,e.newIndex,0,e);break;case"modified":if(r[e.oldIndex]==null||r[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=r.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return gd(r,e.newIndex,1,e);break;case"removed":if(r[e.oldIndex]&&r[e.oldIndex].doc.ref.isEqual(e.doc.ref))return gd(r,e.oldIndex,1);break}return r}function A1(r){return(!r||r.length===0)&&(r=["added","removed","modified"]),r}var al=class{ref;query;afs;constructor(e,t,n){this.ref=e,this.query=t,this.afs=n}stateChanges(e){let t=ol(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(He(n=>n.filter(i=>e.indexOf(i.type)>-1)))),t.pipe($s(void 0),zs(),Ft(([n,i])=>i.length>0||!n),He(([,n])=>n),Ze)}auditTrail(e){return this.stateChanges(e).pipe(Ks((t,n)=>[...t,...n],[]))}snapshotChanges(e){let t=A1(e);return S1(this.query,t,this.afs.schedulers.outsideAngular).pipe(Ze)}valueChanges(e={}){return _d(this.query,this.afs.schedulers.outsideAngular).pipe(He(t=>t.payload.docs.map(n=>e.idField?Pn(Yt({},n.data()),{[e.idField]:n.id}):n.data())),Ze)}get(e){return Xt(this.query.get(e)).pipe(Ze)}add(e){return this.ref.add(e)}doc(e){return new sl(this.ref.doc(e),this.afs)}},yd=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?ol(this.query,this.afs.schedulers.outsideAngular).pipe(Ze):ol(this.query,this.afs.schedulers.outsideAngular).pipe(He(t=>t.filter(n=>e.indexOf(n.type)>-1)),Ft(t=>t.length>0),Ze)}auditTrail(e){return this.stateChanges(e).pipe(Ks((t,n)=>[...t,...n],[]))}snapshotChanges(e){let t=A1(e);return S1(this.query,t,this.afs.schedulers.outsideAngular).pipe(Ze)}valueChanges(e={}){return _d(this.query,this.afs.schedulers.outsideAngular).pipe(He(n=>n.payload.docs.map(i=>e.idField?Yt({[e.idField]:i.id},i.data()):i.data())),Ze)}get(e){return Xt(this.query.get(e)).pipe(Ze)}},C2=new Me("angularfire2.enableFirestorePersistence"),R2=new Me("angularfire2.firestore.persistenceSettings"),P2=new Me("angularfire2.firestore.settings"),k2=new Me("angularfire2.firestore.use-emulator");function x1(r,e=t=>t){return{query:e(r),ref:r}}var C1=(()=>{class r{schedulers;firestore;persistenceEnabled$;constructor(t,n,i,s,a,l,u,d,m,p,v,x,F,L,N,$,W){this.schedulers=u;let B=Oi(t,l,n),Q=m;p&&hu(B,l,v,F,L,N,x,$),[this.firestore,this.persistenceEnabled$]=Fo(`${B.name}.firestore`,"AngularFirestore",B.name,()=>{let J=l.runOutsideAngular(()=>B.firestore());if(s&&J.settings(s),Q&&J.useEmulator(...Q),i&&!no(a)){let Y=()=>{try{return Xt(J.enablePersistence(d||void 0).then(()=>!0,()=>!1))}catch(T){return typeof console<"u"&&console.warn(T),Zt(!1)}};return[J,l.runOutsideAngular(Y)]}else return[J,Zt(!1)]},[s,Q,i])}collection(t,n){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:s,query:a}=x1(i,n),l=this.schedulers.ngZone.run(()=>s);return new al(l,a,this)}collectionGroup(t,n){let i=n||(a=>a),s=this.firestore.collectionGroup(t);return new yd(i(s),this)}doc(t){let n;typeof t=="string"?n=this.firestore.doc(t):n=t;let i=this.schedulers.ngZone.run(()=>n);return new sl(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(n){return new(n||r)(re(br),re(Sr,8),re(C2,8),re(P2,8),re(vr),re(yt),re(No),re(R2,8),re(k2,8),re(Qf,8),re(su,8),re(ou,8),re(au,8),re(lu,8),re(uu,8),re(cu,8),re(Ln,8))};static \u0275prov=en({token:r,factory:r.\u0275fac,providedIn:"any"})}return r})();var R1={apiKey:"AIzaSyAXiCpMxT_-NDsDnPdZJXwk6FReK0NrpV8",authDomain:"pncwebgt.firebaseapp.com",projectId:"pncwebgt",storageBucket:"pncwebgt.firebasestorage.app",messagingSenderId:"922076116267",appId:"1:922076116267:web:1c82d1b5adb546e58c416e"};Tf(R1);var P1={providers:[of(kf,af({anchorScrolling:"enabled",scrollPositionRestoration:"enabled"}),lf()),Ym(Xm()),Pf(),cf({theme:{preset:uf,options:{darkModeSelector:".app-dark"}}}),Pm(Jm,Mf.initializeApp(R1),C1)]};var ll=class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=X({type:r,selectors:[["app-root"]],decls:1,vars:0,template:function(t,n){t&1&&V(0,"router-outlet")},dependencies:[Ve,io],encapsulation:2})};ef(ll,P1).catch(r=>console.error(r));
